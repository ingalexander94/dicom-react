import{g as Et,r as Fe,j as $e}from"./index-CcCkGZL0.js";import{c as Mt,a as we,d as At}from"./cornerstoneWADOImageLoader.bundle.min-C_BQW7S1.js";var Rt={exports:{}};/*! cornerstone-tools - 6.0.10 - 2023-07-21 | (c) 2017 Chris Hafey | https://github.com/cornerstonejs/cornerstoneTools */(function(Ne,ye){(function(n,e){Ne.exports=e()})(window,function(){return function(H){function n(y){delete installedChunks[y]}var e=window.webpackHotUpdate;window.webpackHotUpdate=function(x,j){L(x,j),e&&e(x,j)};function r(y){var x=document.createElement("script");x.charset="utf-8",x.src=b.p+""+y+"."+v+".hot-update.js",document.head.appendChild(x)}function u(y){return y=y||1e4,new Promise(function(x,j){if(typeof XMLHttpRequest>"u")return j(new Error("No browser support"));try{var p=new XMLHttpRequest,R=b.p+""+v+".hot-update.json";p.open("GET",R,!0),p.timeout=y,p.send(null)}catch(W){return j(W)}p.onreadystatechange=function(){if(p.readyState===4)if(p.status===0)j(new Error("Manifest request to "+R+" timed out."));else if(p.status===404)x();else if(p.status!==200&&p.status!==304)j(new Error("Manifest request to "+R+" failed."));else{try{var W=JSON.parse(p.responseText)}catch(K){j(K);return}x(W)}}})}var f=!0,v="286e7d820af3fc74f409",d=1e4,t={},o,s=[],l=[];function a(y){var x=B[y];if(!x)return b;var j=function(W){return x.hot.active?(B[W]?B[W].parents.indexOf(y)===-1&&B[W].parents.push(y):(s=[y],o=W),x.children.indexOf(W)===-1&&x.children.push(W)):(console.warn("[HMR] unexpected require("+W+") from disposed module "+y),s=[]),b(W)},p=function(K){return{configurable:!0,enumerable:!0,get:function(){return b[K]},set:function(N){b[K]=N}}};for(var R in b)Object.prototype.hasOwnProperty.call(b,R)&&R!=="e"&&R!=="t"&&Object.defineProperty(j,R,p(R));return j.e=function(W){return g==="ready"&&c("prepare"),E++,b.e(W).then(K,function(N){throw K(),N});function K(){E--,g==="prepare"&&(T[W]||S(W),E===0&&m===0&&A())}},j.t=function(W,K){return K&1&&(W=j(W)),b.t(W,K&-2)},j}function i(y){var x={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:o!==y,active:!0,accept:function(j,p){if(j===void 0)x._selfAccepted=!0;else if(typeof j=="function")x._selfAccepted=j;else if(typeof j=="object")for(var R=0;R<j.length;R++)x._acceptedDependencies[j[R]]=p||function(){};else x._acceptedDependencies[j]=p||function(){}},decline:function(j){if(j===void 0)x._selfDeclined=!0;else if(typeof j=="object")for(var p=0;p<j.length;p++)x._declinedDependencies[j[p]]=!0;else x._declinedDependencies[j]=!0},dispose:function(j){x._disposeHandlers.push(j)},addDisposeHandler:function(j){x._disposeHandlers.push(j)},removeDisposeHandler:function(j){var p=x._disposeHandlers.indexOf(j);p>=0&&x._disposeHandlers.splice(p,1)},check:D,apply:U,status:function(j){if(!j)return g;h.push(j)},addStatusHandler:function(j){h.push(j)},removeStatusHandler:function(j){var p=h.indexOf(j);p>=0&&h.splice(p,1)},data:t[y]};return o=void 0,x}var h=[],g="idle";function c(y){g=y;for(var x=0;x<h.length;x++)h[x].call(null,y)}var m=0,E=0,T={},P={},M={},C,O,I;function _(y){var x=+y+""===y;return x?+y:y}function D(y){if(g!=="idle")throw new Error("check() is only allowed in idle status");return f=y,c("check"),u(d).then(function(x){if(!x)return c("idle"),null;P={},T={},M=x.c,I=x.h,c("prepare");var j=new Promise(function(R,W){C={resolve:R,reject:W}});O={};var p="cornerstoneTools";return S(p),g==="prepare"&&E===0&&m===0&&A(),j})}function L(y,x){if(!(!M[y]||!P[y])){P[y]=!1;for(var j in x)Object.prototype.hasOwnProperty.call(x,j)&&(O[j]=x[j]);--m===0&&E===0&&A()}}function S(y){M[y]?(P[y]=!0,m++,r(y)):T[y]=!0}function A(){c("ready");var y=C;if(C=null,!!y)if(f)Promise.resolve().then(function(){return U(f)}).then(function(p){y.resolve(p)},function(p){y.reject(p)});else{var x=[];for(var j in O)Object.prototype.hasOwnProperty.call(O,j)&&x.push(_(j));y.resolve(x)}}function U(y){if(g!=="ready")throw new Error("apply() is only allowed in ready status");y=y||{};var x,j,p,R,W;function K(ie){for(var ve=[ie],Me={},me=ve.map(function(je){return{chain:[je],id:je}});me.length>0;){var De=me.pop(),Te=De.id,Ce=De.chain;if(R=B[Te],!(!R||R.hot._selfAccepted)){if(R.hot._selfDeclined)return{type:"self-declined",chain:Ce,moduleId:Te};if(R.hot._main)return{type:"unaccepted",chain:Ce,moduleId:Te};for(var Ee=0;Ee<R.parents.length;Ee++){var Oe=R.parents[Ee],_e=B[Oe];if(_e){if(_e.hot._declinedDependencies[Te])return{type:"declined",chain:Ce.concat([Oe]),moduleId:Te,parentId:Oe};if(ve.indexOf(Oe)===-1){if(_e.hot._acceptedDependencies[Te]){Me[Oe]||(Me[Oe]=[]),N(Me[Oe],[Te]);continue}delete Me[Oe],ve.push(Oe),me.push({chain:Ce.concat([Oe]),id:Oe})}}}}}return{type:"accepted",moduleId:ie,outdatedModules:ve,outdatedDependencies:Me}}function N(ie,ve){for(var Me=0;Me<ve.length;Me++){var me=ve[Me];ie.indexOf(me)===-1&&ie.push(me)}}var z={},Y=[],$={},J=function(){console.warn("[HMR] unexpected require("+ne.moduleId+") to disposed module")};for(var te in O)if(Object.prototype.hasOwnProperty.call(O,te)){W=_(te);var ne;O[te]?ne=K(W):ne={type:"disposed",moduleId:te};var de=!1,w=!1,G=!1,Z="";switch(ne.chain&&(Z=`
Update propagation: `+ne.chain.join(" -> ")),ne.type){case"self-declined":y.onDeclined&&y.onDeclined(ne),y.ignoreDeclined||(de=new Error("Aborted because of self decline: "+ne.moduleId+Z));break;case"declined":y.onDeclined&&y.onDeclined(ne),y.ignoreDeclined||(de=new Error("Aborted because of declined dependency: "+ne.moduleId+" in "+ne.parentId+Z));break;case"unaccepted":y.onUnaccepted&&y.onUnaccepted(ne),y.ignoreUnaccepted||(de=new Error("Aborted because "+W+" is not accepted"+Z));break;case"accepted":y.onAccepted&&y.onAccepted(ne),w=!0;break;case"disposed":y.onDisposed&&y.onDisposed(ne),G=!0;break;default:throw new Error("Unexception type "+ne.type)}if(de)return c("abort"),Promise.reject(de);if(w){$[W]=O[W],N(Y,ne.outdatedModules);for(W in ne.outdatedDependencies)Object.prototype.hasOwnProperty.call(ne.outdatedDependencies,W)&&(z[W]||(z[W]=[]),N(z[W],ne.outdatedDependencies[W]))}G&&(N(Y,[ne.moduleId]),$[W]=J)}var Q=[];for(j=0;j<Y.length;j++)W=Y[j],B[W]&&B[W].hot._selfAccepted&&$[W]!==J&&Q.push({module:W,errorHandler:B[W].hot._selfAccepted});c("dispose"),Object.keys(M).forEach(function(ie){M[ie]===!1&&n(ie)});for(var k,ae=Y.slice();ae.length>0;)if(W=ae.pop(),R=B[W],!!R){var ee={},oe=R.hot._disposeHandlers;for(p=0;p<oe.length;p++)x=oe[p],x(ee);for(t[W]=ee,R.hot.active=!1,delete B[W],delete z[W],p=0;p<R.children.length;p++){var se=B[R.children[p]];se&&(k=se.parents.indexOf(W),k>=0&&se.parents.splice(k,1))}}var re,ce;for(W in z)if(Object.prototype.hasOwnProperty.call(z,W)&&(R=B[W],R))for(ce=z[W],p=0;p<ce.length;p++)re=ce[p],k=R.children.indexOf(re),k>=0&&R.children.splice(k,1);c("apply"),v=I;for(W in $)Object.prototype.hasOwnProperty.call($,W)&&(H[W]=$[W]);var le=null;for(W in z)if(Object.prototype.hasOwnProperty.call(z,W)&&(R=B[W],R)){ce=z[W];var fe=[];for(j=0;j<ce.length;j++)if(re=ce[j],x=R.hot._acceptedDependencies[re],x){if(fe.indexOf(x)!==-1)continue;fe.push(x)}for(j=0;j<fe.length;j++){x=fe[j];try{x(ce)}catch(ie){y.onErrored&&y.onErrored({type:"accept-errored",moduleId:W,dependencyId:ce[j],error:ie}),y.ignoreErrored||le||(le=ie)}}}for(j=0;j<Q.length;j++){var ge=Q[j];W=ge.module,s=[W];try{b(W)}catch(ie){if(typeof ge.errorHandler=="function")try{ge.errorHandler(ie)}catch(ve){y.onErrored&&y.onErrored({type:"self-accept-error-handler-errored",moduleId:W,error:ve,originalError:ie}),y.ignoreErrored||le||(le=ve),le||(le=ie)}else y.onErrored&&y.onErrored({type:"self-accept-errored",moduleId:W,error:ie}),y.ignoreErrored||le||(le=ie)}}return le?(c("fail"),Promise.reject(le)):(c("idle"),new Promise(function(ie){ie(Y)}))}var B={};function b(y){if(B[y])return B[y].exports;var x=B[y]={i:y,l:!1,exports:{},hot:i(y),parents:(l=s,s=[],l),children:[]};return H[y].call(x.exports,x,x.exports,a(y)),x.l=!0,x.exports}return b.m=H,b.c=B,b.d=function(y,x,j){b.o(y,x)||Object.defineProperty(y,x,{enumerable:!0,get:j})},b.r=function(y){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(y,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(y,"__esModule",{value:!0})},b.t=function(y,x){if(x&1&&(y=b(y)),x&8||x&4&&typeof y=="object"&&y&&y.__esModule)return y;var j=Object.create(null);if(b.r(j),Object.defineProperty(j,"default",{enumerable:!0,value:y}),x&2&&typeof y!="string")for(var p in y)b.d(j,p,(function(R){return y[R]}).bind(null,p));return j},b.n=function(y){var x=y&&y.__esModule?function(){return y.default}:function(){return y};return b.d(x,"a",x),x},b.o=function(y,x){return Object.prototype.hasOwnProperty.call(y,x)},b.p="",b.h=function(){return v},a("./index.js")(b.s="./index.js")}({"../node_modules/@babel/runtime/helpers/arrayWithHoles.js":function(H,n){function e(r){if(Array.isArray(r))return r}H.exports=e},"../node_modules/@babel/runtime/helpers/arrayWithoutHoles.js":function(H,n){function e(r){if(Array.isArray(r)){for(var u=0,f=new Array(r.length);u<r.length;u++)f[u]=r[u];return f}}H.exports=e},"../node_modules/@babel/runtime/helpers/assertThisInitialized.js":function(H,n){function e(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}H.exports=e},"../node_modules/@babel/runtime/helpers/asyncToGenerator.js":function(H,n){function e(u,f,v,d,t,o,s){try{var l=u[o](s),a=l.value}catch(i){v(i);return}l.done?f(a):Promise.resolve(a).then(d,t)}function r(u){return function(){var f=this,v=arguments;return new Promise(function(d,t){var o=u.apply(f,v);function s(a){e(o,d,t,s,l,"next",a)}function l(a){e(o,d,t,s,l,"throw",a)}s(void 0)})}}H.exports=r},"../node_modules/@babel/runtime/helpers/classCallCheck.js":function(H,n){function e(r,u){if(!(r instanceof u))throw new TypeError("Cannot call a class as a function")}H.exports=e},"../node_modules/@babel/runtime/helpers/createClass.js":function(H,n){function e(u,f){for(var v=0;v<f.length;v++){var d=f[v];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(u,d.key,d)}}function r(u,f,v){return f&&e(u.prototype,f),v&&e(u,v),u}H.exports=r},"../node_modules/@babel/runtime/helpers/defineProperty.js":function(H,n){function e(r,u,f){return u in r?Object.defineProperty(r,u,{value:f,enumerable:!0,configurable:!0,writable:!0}):r[u]=f,r}H.exports=e},"../node_modules/@babel/runtime/helpers/getPrototypeOf.js":function(H,n){function e(r){return H.exports=e=Object.setPrototypeOf?Object.getPrototypeOf:function(f){return f.__proto__||Object.getPrototypeOf(f)},e(r)}H.exports=e},"../node_modules/@babel/runtime/helpers/inherits.js":function(H,n,e){var r=e("../node_modules/@babel/runtime/helpers/setPrototypeOf.js");function u(f,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function");f.prototype=Object.create(v&&v.prototype,{constructor:{value:f,writable:!0,configurable:!0}}),v&&r(f,v)}H.exports=u},"../node_modules/@babel/runtime/helpers/iterableToArray.js":function(H,n){function e(r){if(Symbol.iterator in Object(r)||Object.prototype.toString.call(r)==="[object Arguments]")return Array.from(r)}H.exports=e},"../node_modules/@babel/runtime/helpers/iterableToArrayLimit.js":function(H,n){function e(r,u){var f=[],v=!0,d=!1,t=void 0;try{for(var o=r[Symbol.iterator](),s;!(v=(s=o.next()).done)&&(f.push(s.value),!(u&&f.length===u));v=!0);}catch(l){d=!0,t=l}finally{try{!v&&o.return!=null&&o.return()}finally{if(d)throw t}}return f}H.exports=e},"../node_modules/@babel/runtime/helpers/nonIterableRest.js":function(H,n){function e(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}H.exports=e},"../node_modules/@babel/runtime/helpers/nonIterableSpread.js":function(H,n){function e(){throw new TypeError("Invalid attempt to spread non-iterable instance")}H.exports=e},"../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js":function(H,n,e){var r=e("../node_modules/@babel/runtime/helpers/typeof.js"),u=e("../node_modules/@babel/runtime/helpers/assertThisInitialized.js");function f(v,d){return d&&(r(d)==="object"||typeof d=="function")?d:u(v)}H.exports=f},"../node_modules/@babel/runtime/helpers/setPrototypeOf.js":function(H,n){function e(r,u){return H.exports=e=Object.setPrototypeOf||function(v,d){return v.__proto__=d,v},e(r,u)}H.exports=e},"../node_modules/@babel/runtime/helpers/slicedToArray.js":function(H,n,e){var r=e("../node_modules/@babel/runtime/helpers/arrayWithHoles.js"),u=e("../node_modules/@babel/runtime/helpers/iterableToArrayLimit.js"),f=e("../node_modules/@babel/runtime/helpers/nonIterableRest.js");function v(d,t){return r(d)||u(d,t)||f()}H.exports=v},"../node_modules/@babel/runtime/helpers/toConsumableArray.js":function(H,n,e){var r=e("../node_modules/@babel/runtime/helpers/arrayWithoutHoles.js"),u=e("../node_modules/@babel/runtime/helpers/iterableToArray.js"),f=e("../node_modules/@babel/runtime/helpers/nonIterableSpread.js");function v(d){return r(d)||u(d)||f()}H.exports=v},"../node_modules/@babel/runtime/helpers/typeof.js":function(H,n){function e(u){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?e=function(v){return typeof v}:e=function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},e(u)}function r(u){return typeof Symbol=="function"&&e(Symbol.iterator)==="symbol"?H.exports=r=function(v){return e(v)}:H.exports=r=function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":e(v)},r(u)}H.exports=r},"../node_modules/@babel/runtime/regenerator/index.js":function(H,n,e){H.exports=e("../node_modules/regenerator-runtime/runtime-module.js")},"../node_modules/ms/index.js":function(H,n){var e=1e3,r=e*60,u=r*60,f=u*24,v=f*7,d=f*365.25;H.exports=function(a,i){i=i||{};var h=typeof a;if(h==="string"&&a.length>0)return t(a);if(h==="number"&&isFinite(a))return i.long?s(a):o(a);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(a))};function t(a){if(a=String(a),!(a.length>100)){var i=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(a);if(i){var h=parseFloat(i[1]),g=(i[2]||"ms").toLowerCase();switch(g){case"years":case"year":case"yrs":case"yr":case"y":return h*d;case"weeks":case"week":case"w":return h*v;case"days":case"day":case"d":return h*f;case"hours":case"hour":case"hrs":case"hr":case"h":return h*u;case"minutes":case"minute":case"mins":case"min":case"m":return h*r;case"seconds":case"second":case"secs":case"sec":case"s":return h*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return h;default:return}}}}function o(a){var i=Math.abs(a);return i>=f?Math.round(a/f)+"d":i>=u?Math.round(a/u)+"h":i>=r?Math.round(a/r)+"m":i>=e?Math.round(a/e)+"s":a+"ms"}function s(a){var i=Math.abs(a);return i>=f?l(a,i,f,"day"):i>=u?l(a,i,u,"hour"):i>=r?l(a,i,r,"minute"):i>=e?l(a,i,e,"second"):a+" ms"}function l(a,i,h,g){var c=i>=h*1.5;return Math.round(a/h)+" "+g+(c?"s":"")}},"../node_modules/process/browser.js":function(H,n){var e=H.exports={},r,u;function f(){throw new Error("setTimeout has not been defined")}function v(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?r=setTimeout:r=f}catch{r=f}try{typeof clearTimeout=="function"?u=clearTimeout:u=v}catch{u=v}})();function d(m){if(r===setTimeout)return setTimeout(m,0);if((r===f||!r)&&setTimeout)return r=setTimeout,setTimeout(m,0);try{return r(m,0)}catch{try{return r.call(null,m,0)}catch{return r.call(this,m,0)}}}function t(m){if(u===clearTimeout)return clearTimeout(m);if((u===v||!u)&&clearTimeout)return u=clearTimeout,clearTimeout(m);try{return u(m)}catch{try{return u.call(null,m)}catch{return u.call(this,m)}}}var o=[],s=!1,l,a=-1;function i(){!s||!l||(s=!1,l.length?o=l.concat(o):a=-1,o.length&&h())}function h(){if(!s){var m=d(i);s=!0;for(var E=o.length;E;){for(l=o,o=[];++a<E;)l&&l[a].run();a=-1,E=o.length}l=null,s=!1,t(m)}}e.nextTick=function(m){var E=new Array(arguments.length-1);if(arguments.length>1)for(var T=1;T<arguments.length;T++)E[T-1]=arguments[T];o.push(new g(m,E)),o.length===1&&!s&&d(h)};function g(m,E){this.fun=m,this.array=E}g.prototype.run=function(){this.fun.apply(null,this.array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={};function c(){}e.on=c,e.addListener=c,e.once=c,e.off=c,e.removeListener=c,e.removeAllListeners=c,e.emit=c,e.prependListener=c,e.prependOnceListener=c,e.listeners=function(m){return[]},e.binding=function(m){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(m){throw new Error("process.chdir is not supported")},e.umask=function(){return 0}},"../node_modules/regenerator-runtime/runtime-module.js":function(H,n,e){var r=function(){return this||typeof self=="object"&&self}()||Function("return this")(),u=r.regeneratorRuntime&&Object.getOwnPropertyNames(r).indexOf("regeneratorRuntime")>=0,f=u&&r.regeneratorRuntime;if(r.regeneratorRuntime=void 0,H.exports=e("../node_modules/regenerator-runtime/runtime.js"),u)r.regeneratorRuntime=f;else try{delete r.regeneratorRuntime}catch{r.regeneratorRuntime=void 0}},"../node_modules/regenerator-runtime/runtime.js":function(H,n){(function(e){var r=Object.prototype,u=r.hasOwnProperty,f,v=typeof Symbol=="function"?Symbol:{},d=v.iterator||"@@iterator",t=v.asyncIterator||"@@asyncIterator",o=v.toStringTag||"@@toStringTag",s=typeof H=="object",l=e.regeneratorRuntime;if(l){s&&(H.exports=l);return}l=e.regeneratorRuntime=s?H.exports:{};function a(j,p,R,W){var K=p&&p.prototype instanceof T?p:T,N=Object.create(K.prototype),z=new b(W||[]);return N._invoke=S(j,R,z),N}l.wrap=a;function i(j,p,R){try{return{type:"normal",arg:j.call(p,R)}}catch(W){return{type:"throw",arg:W}}}var h="suspendedStart",g="suspendedYield",c="executing",m="completed",E={};function T(){}function P(){}function M(){}var C={};C[d]=function(){return this};var O=Object.getPrototypeOf,I=O&&O(O(y([])));I&&I!==r&&u.call(I,d)&&(C=I);var _=M.prototype=T.prototype=Object.create(C);P.prototype=_.constructor=M,M.constructor=P,M[o]=P.displayName="GeneratorFunction";function D(j){["next","throw","return"].forEach(function(p){j[p]=function(R){return this._invoke(p,R)}})}l.isGeneratorFunction=function(j){var p=typeof j=="function"&&j.constructor;return p?p===P||(p.displayName||p.name)==="GeneratorFunction":!1},l.mark=function(j){return Object.setPrototypeOf?Object.setPrototypeOf(j,M):(j.__proto__=M,o in j||(j[o]="GeneratorFunction")),j.prototype=Object.create(_),j},l.awrap=function(j){return{__await:j}};function L(j){function p(K,N,z,Y){var $=i(j[K],j,N);if($.type==="throw")Y($.arg);else{var J=$.arg,te=J.value;return te&&typeof te=="object"&&u.call(te,"__await")?Promise.resolve(te.__await).then(function(ne){p("next",ne,z,Y)},function(ne){p("throw",ne,z,Y)}):Promise.resolve(te).then(function(ne){J.value=ne,z(J)},function(ne){return p("throw",ne,z,Y)})}}var R;function W(K,N){function z(){return new Promise(function(Y,$){p(K,N,Y,$)})}return R=R?R.then(z,z):z()}this._invoke=W}D(L.prototype),L.prototype[t]=function(){return this},l.AsyncIterator=L,l.async=function(j,p,R,W){var K=new L(a(j,p,R,W));return l.isGeneratorFunction(p)?K:K.next().then(function(N){return N.done?N.value:K.next()})};function S(j,p,R){var W=h;return function(N,z){if(W===c)throw new Error("Generator is already running");if(W===m){if(N==="throw")throw z;return x()}for(R.method=N,R.arg=z;;){var Y=R.delegate;if(Y){var $=A(Y,R);if($){if($===E)continue;return $}}if(R.method==="next")R.sent=R._sent=R.arg;else if(R.method==="throw"){if(W===h)throw W=m,R.arg;R.dispatchException(R.arg)}else R.method==="return"&&R.abrupt("return",R.arg);W=c;var J=i(j,p,R);if(J.type==="normal"){if(W=R.done?m:g,J.arg===E)continue;return{value:J.arg,done:R.done}}else J.type==="throw"&&(W=m,R.method="throw",R.arg=J.arg)}}}function A(j,p){var R=j.iterator[p.method];if(R===f){if(p.delegate=null,p.method==="throw"){if(j.iterator.return&&(p.method="return",p.arg=f,A(j,p),p.method==="throw"))return E;p.method="throw",p.arg=new TypeError("The iterator does not provide a 'throw' method")}return E}var W=i(R,j.iterator,p.arg);if(W.type==="throw")return p.method="throw",p.arg=W.arg,p.delegate=null,E;var K=W.arg;if(!K)return p.method="throw",p.arg=new TypeError("iterator result is not an object"),p.delegate=null,E;if(K.done)p[j.resultName]=K.value,p.next=j.nextLoc,p.method!=="return"&&(p.method="next",p.arg=f);else return K;return p.delegate=null,E}D(_),_[o]="Generator",_[d]=function(){return this},_.toString=function(){return"[object Generator]"};function U(j){var p={tryLoc:j[0]};1 in j&&(p.catchLoc=j[1]),2 in j&&(p.finallyLoc=j[2],p.afterLoc=j[3]),this.tryEntries.push(p)}function B(j){var p=j.completion||{};p.type="normal",delete p.arg,j.completion=p}function b(j){this.tryEntries=[{tryLoc:"root"}],j.forEach(U,this),this.reset(!0)}l.keys=function(j){var p=[];for(var R in j)p.push(R);return p.reverse(),function W(){for(;p.length;){var K=p.pop();if(K in j)return W.value=K,W.done=!1,W}return W.done=!0,W}};function y(j){if(j){var p=j[d];if(p)return p.call(j);if(typeof j.next=="function")return j;if(!isNaN(j.length)){var R=-1,W=function K(){for(;++R<j.length;)if(u.call(j,R))return K.value=j[R],K.done=!1,K;return K.value=f,K.done=!0,K};return W.next=W}}return{next:x}}l.values=y;function x(){return{value:f,done:!0}}b.prototype={constructor:b,reset:function(j){if(this.prev=0,this.next=0,this.sent=this._sent=f,this.done=!1,this.delegate=null,this.method="next",this.arg=f,this.tryEntries.forEach(B),!j)for(var p in this)p.charAt(0)==="t"&&u.call(this,p)&&!isNaN(+p.slice(1))&&(this[p]=f)},stop:function(){this.done=!0;var j=this.tryEntries[0],p=j.completion;if(p.type==="throw")throw p.arg;return this.rval},dispatchException:function(j){if(this.done)throw j;var p=this;function R($,J){return N.type="throw",N.arg=j,p.next=$,J&&(p.method="next",p.arg=f),!!J}for(var W=this.tryEntries.length-1;W>=0;--W){var K=this.tryEntries[W],N=K.completion;if(K.tryLoc==="root")return R("end");if(K.tryLoc<=this.prev){var z=u.call(K,"catchLoc"),Y=u.call(K,"finallyLoc");if(z&&Y){if(this.prev<K.catchLoc)return R(K.catchLoc,!0);if(this.prev<K.finallyLoc)return R(K.finallyLoc)}else if(z){if(this.prev<K.catchLoc)return R(K.catchLoc,!0)}else if(Y){if(this.prev<K.finallyLoc)return R(K.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(j,p){for(var R=this.tryEntries.length-1;R>=0;--R){var W=this.tryEntries[R];if(W.tryLoc<=this.prev&&u.call(W,"finallyLoc")&&this.prev<W.finallyLoc){var K=W;break}}K&&(j==="break"||j==="continue")&&K.tryLoc<=p&&p<=K.finallyLoc&&(K=null);var N=K?K.completion:{};return N.type=j,N.arg=p,K?(this.method="next",this.next=K.finallyLoc,E):this.complete(N)},complete:function(j,p){if(j.type==="throw")throw j.arg;return j.type==="break"||j.type==="continue"?this.next=j.arg:j.type==="return"?(this.rval=this.arg=j.arg,this.method="return",this.next="end"):j.type==="normal"&&p&&(this.next=p),E},finish:function(j){for(var p=this.tryEntries.length-1;p>=0;--p){var R=this.tryEntries[p];if(R.finallyLoc===j)return this.complete(R.completion,R.afterLoc),B(R),E}},catch:function(j){for(var p=this.tryEntries.length-1;p>=0;--p){var R=this.tryEntries[p];if(R.tryLoc===j){var W=R.completion;if(W.type==="throw"){var K=W.arg;B(R)}return K}}throw new Error("illegal catch attempt")},delegateYield:function(j,p,R){return this.delegate={iterator:y(j),resultName:p,nextLoc:R},this.method==="next"&&(this.arg=f),E}}})(function(){return this||typeof self=="object"&&self}()||Function("return this")())},"./drawing/draw.js":function(H,n,e){e.r(n),n.default=function(r,u){r.save(),u(r),r.restore()}},"./drawing/drawArrow.js":function(H,n,e){e.r(n);var r=e("./drawing/drawLine.js"),u=e("./drawing/drawJoinedLines.js");n.default=function(f,v,d,t,o,s){var l=10,a=Math.atan2(d.y-v.y,d.x-v.x),i={color:t,lineWidth:o};s&&(i.lineDash=s),Object(r.default)(f,void 0,v,d,i,"canvas"),i={color:t,lineWidth:o,fillStyle:t};var h=[{x:d.x-l*Math.cos(a-Math.PI/7),y:d.y-l*Math.sin(a-Math.PI/7)},{x:d.x-l*Math.cos(a+Math.PI/7),y:d.y-l*Math.sin(a+Math.PI/7)},d];Object(u.default)(f,void 0,d,h,i,"canvas")}},"./drawing/drawCircle.js":function(H,n,e){e.r(n);var r=e("./externalModules.js"),u=e("./drawing/path.js");n.default=function(f,v,d,t,o){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"pixel";s==="pixel"&&(d=r.default.cornerstone.pixelToCanvas(v,d)),Object(u.default)(f,o,function(l){l.arc(d.x,d.y,t,0,2*Math.PI)})}},"./drawing/drawEllipse.js":function(H,n,e){e.r(n);var r=e("./externalModules.js"),u=e("./drawing/path.js"),f=e("./util/pointProjector.js");n.default=function(v,d,t,o,s){var l=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"pixel",a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:0;l==="pixel"&&(t=r.default.cornerstone.pixelToCanvas(d,t),o=r.default.cornerstone.pixelToCanvas(d,o));var i=r.default.cornerstone.getViewport(d),h=d.clientWidth,g=d.clientHeight,c=i.scale,m=i.translation,E=i.rotation-a,T={x:h/2+m.x*c,y:g/2+m.y*c};Math.abs(E)>.05&&(t=Object(f.rotatePoint)(t,T,-E),o=Object(f.rotatePoint)(o,T,-E));var P=Math.abs(t.x-o.x),M=Math.abs(t.y-o.y),C=Math.min(t.x,o.x),O=Math.min(t.y,o.y),I={x:C+P/2,y:O+M/2};Math.abs(E)>.05&&(I=Object(f.rotatePoint)(I,T,E));var _=E*Math.PI/180;Object(u.default)(v,s,function(D){D.ellipse(I.x,I.y,P/2,M/2,_,0,2*Math.PI),D.closePath()})}},"./drawing/drawHandles.js":function(H,n,e){e.r(n);var r=e("./externalModules.js"),u=e("./stateManagement/toolStyle.js"),f=e("./stateManagement/toolColors.js"),v=e("./drawing/path.js"),d=e("./store/index.js");n.default=function(t,o,s){var l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},a=o.element,i=f.default.getToolColor();t.strokeStyle=l.color||i;for(var h=Object.keys(s),g=function(T){var P=h[T],M=s[P];if(M.drawnIndependently===!0||l.drawHandlesIfActive===!0&&!M.active||l.hideHandlesIfMoving&&M.moving)return"continue";var C=M.active?u.default.getActiveWidth():u.default.getToolWidth(),O=l.fill,I={lineWidth:C,fillStyle:O};l.lineDash&&(I.lineDash=l.lineDash),Object(v.default)(t,I,function(_){var D=r.default.cornerstone.pixelToCanvas(a,M),L=M.radius||l.handleRadius||d.state.handleRadius;_.arc(D.x,D.y,L,0,2*Math.PI)})},c=0;c<h.length;c++)var m=g(c)}},"./drawing/drawJoinedLines.js":function(H,n,e){e.r(n);var r=e("./externalModules.js"),u=e("./drawing/path.js");n.default=function(f,v,d,t,o){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"pixel";Object(u.default)(f,o,function(l){s==="pixel"&&(d=r.default.cornerstone.pixelToCanvas(v,d),t=t.map(function(a){return r.default.cornerstone.pixelToCanvas(v,a)})),l.moveTo(d.x,d.y),t.forEach(function(a){var i=a.x,h=a.y;l.lineTo(i,h)})})}},"./drawing/drawLine.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return f});var r=e("./externalModules.js"),u=e("./drawing/path.js");function f(v,d,t,o,s){var l=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"pixel";Object(u.default)(v,s,function(a){l==="pixel"&&(t=r.default.cornerstone.pixelToCanvas(d,t),o=r.default.cornerstone.pixelToCanvas(d,o)),a.moveTo(t.x,t.y),a.lineTo(o.x,o.y)})}},"./drawing/drawLines.js":function(H,n,e){e.r(n);var r=e("./externalModules.js"),u=e("./drawing/path.js");n.default=function(f,v,d,t){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"pixel";Object(u.default)(f,t,function(s){d.forEach(function(l){var a=l.start,i=l.end;if(o==="pixel"){var h=r.default.cornerstone;a=h.pixelToCanvas(v,a),i=h.pixelToCanvas(v,i)}s.moveTo(a.x,a.y),s.lineTo(i.x,i.y)})})}},"./drawing/drawLink.js":function(H,n,e){e.r(n);var r=e("./externalModules.js"),u=e("./drawing/drawLine.js");n.default=function(f,v,d,t,o,s){var l=f.length>0?r.default.cornerstoneMath.point.findClosestPoint(f,v):v,a=[{x:d.left+d.width/2,y:d.top},{x:d.left,y:d.top+d.height/2},{x:d.left+d.width/2,y:d.top+d.height},{x:d.left+d.width,y:d.top+d.height/2}],i=r.default.cornerstoneMath.point.findClosestPoint(a,l),h={color:o,lineWidth:s,lineDash:[2,3]};Object(u.default)(t,void 0,l,i,h,"canvas")}},"./drawing/drawLinkedTextBox.js":function(H,n,e){e.r(n);var r=e("./externalModules.js"),u=e("./drawing/drawTextBox.js"),f=e("./drawing/drawLink.js"),v=e("./store/index.js"),d=e("./util/clip.js");n.default=function(t,o,s,l,a,i,h,g,c,m){var E=r.default.cornerstone.pixelToCanvas,T=E(o,s);c&&(T.x+=c);var P={centering:{x:!1,y:m}};if(v.state.preventTextBoxOutsideDisplayedArea&&(P.displacer=function(C){return Object(d.clipBoxToDisplayedArea)(o,C)}),s.boundingBox=Object(u.default)(t,l,T.x,T.y,h,P),s.hasMoved){var M=i(a).map(function(C){return E(o,C)});Object(f.default)(M,T,s.boundingBox,t,h,g)}}},"./drawing/drawRect.js":function(H,n,e){e.r(n);var r=e("./externalModules.js"),u=e("./drawing/path.js"),f=e("./util/pointProjector.js");n.default=function(v,d,t,o,s){var l=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"pixel",a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:0;if(l==="pixel"){var i=r.default.cornerstone;t=i.pixelToCanvas(d,t),o=i.pixelToCanvas(d,o)}var h=r.default.cornerstone.getViewport(d),g=d.clientWidth,c=d.clientHeight,m=h.scale,E=h.translation,T=h.rotation-a,P={x:g/2+E.x*m,y:c/2+E.y*m};Math.abs(T)>.05&&(t=Object(f.rotatePoint)(t,P,-T),o=Object(f.rotatePoint)(o,P,-T));var M=Math.abs(t.x-o.x),C=Math.abs(t.y-o.y);t={x:Math.min(t.x,o.x),y:Math.min(t.y,o.y)},o={x:t.x+M,y:t.y+C};var O={x:t.x+M,y:t.y},I={x:t.x,y:t.y+C};Math.abs(T)>.05&&(t=Object(f.rotatePoint)(t,P,T),o=Object(f.rotatePoint)(o,P,T),O=Object(f.rotatePoint)(O,P,T),I=Object(f.rotatePoint)(I,P,T)),Object(u.default)(v,s,function(_){_.moveTo(t.x,t.y),_.lineTo(O.x,O.y),_.lineTo(o.x,o.y),_.lineTo(I.x,I.y),_.lineTo(t.x,t.y)})}},"./drawing/drawTextBox.js":function(H,n,e){e.r(n),e.d(n,"textBoxWidth",function(){return d});var r=e("./stateManagement/textStyle.js"),u=e("./drawing/draw.js"),f=e("./drawing/fillTextLines.js"),v=e("./drawing/fillBox.js");function d(t,o,s){var l=r.default.getFont(),a=t.font;l&&l!==a&&(t.font=l);var i=t.measureText(o).width;return l&&l!==a&&(t.font=a),i+2*s}n.default=function(t,o,s,l,a){var i=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{};Object.prototype.toString.call(o)!=="[object Array]"&&(o=[o]);var h=5,g=r.default.getFontSize(),c=r.default.getBackgroundColor(),m=0;o.forEach(function(T){var P=d(t,T,h);m=Math.max(m,P)});var E={width:m,height:h+o.length*(g+h)};return Object(u.default)(t,function(T){T.strokeStyle=a,i.centering&&(i.centering.x===!0&&(s-=E.width/2),i.centering.y===!0&&(l-=E.height/2)),E.left=s,E.top=l,typeof i.displacer=="function"&&i.displacer(E),Object(v.default)(T,E,c),Object(f.default)(T,E,o,a,h)}),E}},"./drawing/fillBox.js":function(H,n,e){e.r(n),n.default=function(r,u,f){r.fillStyle=f,r.fillRect(u.left,u.top,u.width,u.height)}},"./drawing/fillOutsideRect.js":function(H,n,e){e.r(n);var r=e("./externalModules.js"),u=e("./drawing/path.js");n.default=function(f,v,d,t,o){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"pixel";if(s==="pixel"){var l=r.default.cornerstone;d=l.pixelToCanvas(v,d),t=l.pixelToCanvas(v,t)}var a=Math.min(d.x,t.x),i=Math.min(d.y,t.y),h=Math.abs(d.x-t.x),g=Math.abs(d.y-t.y);Object(u.default)(f,o,function(c){c.rect(0,0,c.canvas.clientWidth,c.canvas.clientHeight),c.rect(a+h,i,-h,g)})}},"./drawing/fillTextLines.js":function(H,n,e){e.r(n);var r=e("./stateManagement/textStyle.js");n.default=function(u,f,v,d,t){var o=r.default.getFontSize();u.font=r.default.getFont(),u.textBaseline="top",u.fillStyle=d,v.forEach(function(s,l){u.fillText(s,f.left+t,f.top+t+l*(o+t))})}},"./drawing/getNewContext.js":function(H,n,e){e.r(n),n.default=function(r){var u=r.getContext("2d");return u.setTransform(1,0,0,1,0,0),u}},"./drawing/index.js":function(H,n,e){e.r(n);var r=e("./drawing/draw.js");e.d(n,"draw",function(){return r.default});var u=e("./drawing/drawArrow.js");e.d(n,"drawArrow",function(){return u.default});var f=e("./drawing/drawCircle.js");e.d(n,"drawCircle",function(){return f.default});var v=e("./drawing/drawEllipse.js");e.d(n,"drawEllipse",function(){return v.default});var d=e("./drawing/drawHandles.js");e.d(n,"drawHandles",function(){return d.default});var t=e("./drawing/drawJoinedLines.js");e.d(n,"drawJoinedLines",function(){return t.default});var o=e("./drawing/drawLine.js");e.d(n,"drawLine",function(){return o.default});var s=e("./drawing/drawLines.js");e.d(n,"drawLines",function(){return s.default});var l=e("./drawing/drawLink.js");e.d(n,"drawLink",function(){return l.default});var a=e("./drawing/drawLinkedTextBox.js");e.d(n,"drawLinkedTextBox",function(){return a.default});var i=e("./drawing/drawRect.js");e.d(n,"drawRect",function(){return i.default});var h=e("./drawing/drawTextBox.js");e.d(n,"drawTextBox",function(){return h.default});var g=e("./drawing/fillBox.js");e.d(n,"fillBox",function(){return g.default});var c=e("./drawing/fillOutsideRect.js");e.d(n,"fillOutsideRect",function(){return c.default});var m=e("./drawing/fillTextLines.js");e.d(n,"fillTextLines",function(){return m.default});var E=e("./drawing/getNewContext.js");e.d(n,"getNewContext",function(){return E.default});var T=e("./drawing/path.js");e.d(n,"path",function(){return T.default});var P=e("./drawing/setShadow.js");e.d(n,"setShadow",function(){return P.default});var M=e("./drawing/transformCanvasContext.js");e.d(n,"transformCanvasContext",function(){return M.default});var C=e("./drawing/resetCanvasContextTransform.js");e.d(n,"resetCanvasContextTransform",function(){return C.default})},"./drawing/path.js":function(H,n,e){e.r(n);var r=e("./stateManagement/toolStyle.js");n.default=function(u){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},v=arguments.length>2?arguments[2]:void 0,d=f.color,t=f.lineWidth,o=f.fillStyle,s=f.lineDash,l=f.shouldDrawLines,a=l===void 0?!0:l;u.beginPath(),u.strokeStyle=d||u.strokeStyle,u.lineWidth=t||t===void 0&&r.default.getToolWidth()||u.lineWidth,s&&u.setLineDash(s),v(u),o&&(u.fillStyle=o,u.fill()),a&&u.stroke(),s&&u.setLineDash([])}},"./drawing/resetCanvasContextTransform.js":function(H,n,e){e.r(n),n.default=function(r){r.setTransform(1,0,0,1,0,0)}},"./drawing/setShadow.js":function(H,n,e){e.r(n);var r=e("./util/getDefault.js");n.default=function(u){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};f.shadow&&(u.shadowColor=Object(r.default)(f.shadowColor,"#000000"),u.shadowBlur=Object(r.default)(f.shadowBlur,0),u.shadowOffsetX=Object(r.default)(f.shadowOffsetX,1),u.shadowOffsetY=Object(r.default)(f.shadowOffsetY,1))}},"./drawing/transformCanvasContext.js":function(H,n,e){e.r(n),n.default=function(r,u,f){if(f.hflip||f.vflip||f.rotation){var v={x:u.width/2+f.translation.x*f.scale,y:u.height/2+f.translation.y*f.scale};r.translate(v.x,v.y),f.rotation&&r.rotate(f.rotation*Math.PI/180),f.vflip&&r.scale(1,-1),f.hflip&&r.scale(-1,1),r.translate(-v.x,-v.y)}}},"./eventDispatchers/imageRenderedEventDispatcher.js":function(H,n,e){e.r(n);var r=e("./store/index.js"),u=e("./stateManagement/toolState.js"),f=e("./eventListeners/onImageRenderedBrushEventHandler.js"),v=e("./externalModules.js"),d=Object(r.getModule)("segmentation"),t=function(a){var i=a.detail,h=i.element,g=r.state.tools.filter(function(T){return T.element===h&&(T.mode==="active"||T.mode==="passive"||T.mode==="enabled")}),c=Object(u.getToolState)(h,"stack"),m=d.configuration;c&&(m.renderFill||m.renderOutline)&&Object(f.default)(a);var E=i.canvasContext.canvas.getContext("2d");g.forEach(function(T){T.renderToolData&&(E.save(),T.renderToolData(a),E.restore())})},o=function(a){a.addEventListener(v.default.cornerstone.EVENTS.IMAGE_RENDERED,t)},s=function(a){a.removeEventListener(v.default.cornerstone.EVENTS.IMAGE_RENDERED,t)};n.default={enable:o,disable:s}},"./eventDispatchers/index.js":function(H,n,e){e.r(n);var r=e("./eventDispatchers/imageRenderedEventDispatcher.js");e.d(n,"imageRenderedEventDispatcher",function(){return r.default});var u=e("./eventDispatchers/mouseToolEventDispatcher.js");e.d(n,"mouseToolEventDispatcher",function(){return u.default});var f=e("./eventDispatchers/newImageEventDispatcher.js");e.d(n,"newImageEventDispatcher",function(){return f.default});var v=e("./eventDispatchers/touchToolEventDispatcher.js");e.d(n,"touchToolEventDispatcher",function(){return v.default})},"./eventDispatchers/mouseEventHandlers/addNewMeasurement.js":function(H,n,e){e.r(n);var r=e("./events.js"),u=e("./externalModules.js"),f=e("./stateManagement/toolState.js"),v=e("./manipulators/index.js"),d=e("./util/logger.js"),t=e("./util/triggerEvent.js"),o=Object(d.getLogger)("eventDispatchers:mouseEventHandlers");n.default=function(s,l){o.log("addNewMeasurement"),s.preventDefault(),s.stopPropagation();var a=s.detail,i=a.element,h=l.createNewMeasurement(a);if(h){Object(f.addToolState)(i,l.name,h),u.default.cornerstone.updateImage(i);var g=Object.keys(h.handles).length===1?v.moveHandle:v.moveNewHandle,c=new Date().getTime();g(a,l.name,h,h.handles.end,l.options,"mouse",function(m){if(!h.cancelled){var E=l.configuration&&Object(l.configuration).hasOwnProperty("measurementCreationThreshold"),T=E?new Date().getTime()-c<l.configuration.measurementCreationThreshold:!1;if(m&&T===!1){var P=r.default.MEASUREMENT_COMPLETED,M={toolName:l.name,toolType:l.name,element:i,measurementData:h};Object(t.default)(i,P,M)}else Object(f.removeToolState)(i,l.name,h)}})}}},"./eventDispatchers/mouseEventHandlers/index.js":function(H,n,e){e.r(n),e.d(n,"mouseClick",function(){return t}),e.d(n,"mouseDoubleClick",function(){return o}),e.d(n,"mouseUp",function(){return s}),e.d(n,"mouseWheel",function(){return l});var r=e("./eventDispatchers/shared/customCallbackHandler.js"),u=e("./eventDispatchers/mouseEventHandlers/mouseDown.js");e.d(n,"mouseDown",function(){return u.default});var f=e("./eventDispatchers/mouseEventHandlers/mouseDownActivate.js");e.d(n,"mouseDownActivate",function(){return f.default});var v=e("./eventDispatchers/mouseEventHandlers/mouseDrag.js");e.d(n,"mouseDrag",function(){return v.default});var d=e("./eventDispatchers/mouseEventHandlers/mouseMove.js");e.d(n,"mouseMove",function(){return d.default});var t=r.default.bind(null,"Mouse","mouseClickCallback"),o=r.default.bind(null,"Mouse","doubleClickCallback"),s=r.default.bind(null,"Mouse","mouseUpCallback"),l=r.default.bind(null,"MouseWheel","mouseWheelCallback")},"./eventDispatchers/mouseEventHandlers/mouseDown.js":function(H,n,e){e.r(n);var r=e("./store/index.js"),u=e("./stateManagement/toolState.js"),f=e("./store/getToolsWithMoveableHandles.js"),v=e("./util/findAndMoveHelpers.js"),d=e("./store/getInteractiveToolsForElement.js"),t=e("./store/getToolsWithDataForElement.js"),o=e("./store/filterToolsUsableWithMultiPartTools.js");n.default=function(s){if(!r.state.isToolLocked){var l=s.detail,a=s.detail.element,i=s.detail.currentPoints.canvas,h=Object(d.default)(a,r.getters.mouseTools()),g=h.filter(function(B){return B.mode==="active"&&Array.isArray(B.options.mouseButtonMask)&&B.options.mouseButtonMask.includes(l.buttons)&&B.options.isMouseActive});if(r.state.isMultiPartToolActive&&(g=Object(o.default)(g)),g.length>0){var c=g.find(function(B){return typeof B.preMouseDownCallback=="function"});if(c){var m=c.preMouseDownCallback(s);if(m)return}}if(!r.state.isMultiPartToolActive){var E=Object(t.default)(a,h),T=Object(f.default)(a,E,i,"mouse");if(T.length>0){var P=T[0],M=Object(u.getToolState)(a,P.name),C=Object(v.findHandleDataNearImagePoint)(a,M,P.name,i),O=C.handle,I=C.data;P.handleSelectedCallback(s,I,O,"mouse");return}var _=h.filter(function(B){var b=Object(u.getToolState)(a,B.name),y=b&&b.data&&B.pointNearTool&&b.data.some(function(x){return B.pointNearTool(a,x,i,"mouse")});return y});if(_.length>0){var D=_[0],L=Object(u.getToolState)(a,D.name),S=L.data.find(function(B){return D.pointNearTool(a,B,i)});D.toolSelectedCallback(s,S,"mouse");return}if(g.length>0){var A=g.find(function(B){return typeof B.postMouseDownCallback=="function"});if(A){var U=A.postMouseDownCallback(s);if(U)return}}}}}},"./eventDispatchers/mouseEventHandlers/mouseDownActivate.js":function(H,n,e){e.r(n);var r=e("./eventDispatchers/mouseEventHandlers/addNewMeasurement.js"),u=e("./store/index.js"),f=e("./tools/base/BaseAnnotationTool.js"),v=e("./util/getActiveTool.js");n.default=function(d){if(!u.state.isToolLocked){var t=d.detail,o=t.element,s=t.buttons,l=Object(v.default)(o,s,"mouse");if(l){if(typeof l.preMouseDownActivateCallback=="function"){var a=l.preMouseDownActivateCallback(d);if(a)return}u.state.isMultiPartToolActive||(l.addNewMeasurement?l.addNewMeasurement(d,"mouse"):l instanceof f.default&&Object(r.default)(d,l))}}}},"./eventDispatchers/mouseEventHandlers/mouseDrag.js":function(H,n,e){e.r(n);var r=e("./store/index.js"),u=e("./store/getActiveToolsForElement.js"),f=e("./store/filterToolsUsableWithMultiPartTools.js");n.default=function(v){if(!r.state.isToolLocked){var d,t=v.detail,o=t.element;if(d=Object(u.default)(o,r.getters.mouseTools()),d=d.filter(function(l){return Array.isArray(l.options.mouseButtonMask)&&l.options.mouseButtonMask.includes(t.buttons)&&l.options.isMouseActive}),d=d.filter(function(l){return typeof l.mouseDragCallback=="function"}),r.state.isMultiPartToolActive&&(d=Object(f.default)(d)),d.length!==0){var s=d[0];s.mouseDragCallback(v)}}}},"./eventDispatchers/mouseEventHandlers/mouseMove.js":function(H,n,e){e.r(n);var r=e("./externalModules.js"),u=e("./store/index.js"),f=e("./store/getInteractiveToolsForElement.js"),v=e("./store/getToolsWithDataForElement.js");n.default=function(d){if(!(u.state.isToolLocked||u.state.isMultiPartToolActive)){var t,o=d.detail,s=o.element,l=o.currentPoints;u.state.mousePositionImage=l.image,t=Object(f.default)(s,u.getters.mouseTools());var a=t.filter(function(c){return c.mode==="active"&&c.options.isMouseActive}),i=!1;a.length>0&&(i=a.some(function(c){return c.updateOnMouseMove})),t=Object(v.default)(s,t);for(var h=0;h<t.length;h++){var g=t[h];typeof g.mouseMoveCallback=="function"&&(i=g.mouseMoveCallback(d)||i)}i===!0&&r.default.cornerstone.updateImage(s)}}},"./eventDispatchers/mouseToolEventDispatcher.js":function(H,n,e){e.r(n);var r=e("./events.js"),u=e("./eventDispatchers/mouseEventHandlers/index.js"),f=function(t){t.addEventListener(r.default.MOUSE_CLICK,u.mouseClick),t.addEventListener(r.default.MOUSE_DOWN,u.mouseDown),t.addEventListener(r.default.MOUSE_DOWN_ACTIVATE,u.mouseDownActivate),t.addEventListener(r.default.MOUSE_DOUBLE_CLICK,u.mouseDoubleClick),t.addEventListener(r.default.MOUSE_DRAG,u.mouseDrag),t.addEventListener(r.default.MOUSE_MOVE,u.mouseMove),t.addEventListener(r.default.MOUSE_UP,u.mouseUp),t.addEventListener(r.default.MOUSE_WHEEL,u.mouseWheel)},v=function(t){t.removeEventListener(r.default.MOUSE_CLICK,u.mouseClick),t.removeEventListener(r.default.MOUSE_DOWN,u.mouseDown),t.removeEventListener(r.default.MOUSE_DOWN_ACTIVATE,u.mouseDownActivate),t.removeEventListener(r.default.MOUSE_DOUBLE_CLICK,u.mouseDoubleClick),t.removeEventListener(r.default.MOUSE_DRAG,u.mouseDrag),t.removeEventListener(r.default.MOUSE_MOVE,u.mouseMove),t.removeEventListener(r.default.MOUSE_UP,u.mouseUp),t.removeEventListener(r.default.MOUSE_WHEEL,u.mouseWheel)};n.default={enable:f,disable:v}},"./eventDispatchers/newImageEventDispatcher.js":function(H,n,e){e.r(n);var r=e("./store/index.js"),u=e("./externalModules.js"),f=function(o){if(r.state.isToolLocked)return!1;var s=o.detail.element,l=r.state.tools.filter(function(a){return a.element===s&&(a.mode==="active"||a.mode==="passive"||a.mode==="enabled")});if(l.length===0)return!1;l.forEach(function(a){a.newImageCallback&&a.newImageCallback(o)})},v=function(o){o.addEventListener(u.default.cornerstone.EVENTS.NEW_IMAGE,f)},d=function(o){o.removeEventListener(u.default.cornerstone.EVENTS.NEW_IMAGE,f)};n.default={enable:v,disable:d}},"./eventDispatchers/shared/customCallbackHandler.js":function(H,n,e){e.r(n);var r=e("./store/index.js"),u=e("./store/getActiveToolsForElement.js"),f=e("./store/filterToolsUsableWithMultiPartTools.js");n.default=function(v,d,t){if(r.state.isToolLocked)return!1;var o=t.detail.element,s=r.state.tools.filter(function(l){return l.supportedInteractionTypes.includes(v)});if(s=Object(u.default)(o,s,v),s=s.filter(function(l){return typeof l[d]=="function"}),r.state.isMultiPartToolActive&&(s=Object(f.default)(s)),s.length===0)return!1;s[0][d](t)}},"./eventDispatchers/touchEventHandlers/addNewMeasurement.js":function(H,n,e){e.r(n);var r=e("./events.js"),u=e("./externalModules.js"),f=e("./store/index.js"),v=e("./manipulators/anyHandlesOutsideImage.js"),d=e("./manipulators/index.js"),t=e("./stateManagement/toolState.js"),o=e("./util/triggerEvent.js"),s=e("./util/logger.js"),l=Object(s.getLogger)("eventDispatchers:touchEventHandlers");n.default=function(a,i){l.log("addNewMeasurement"),a.preventDefault(),a.stopPropagation();var h=a.detail,g=h.element,c=i.createNewMeasurement(h);if(c){if(Object(t.addToolState)(g,i.name,c),Object.keys(c.handles).length===1&&h.type===r.default.TAP){c.active=!1,c.handles.end.active=!1,c.handles.end.highlight=!1,c.invalidated=!0;var m=f.state.deleteIfHandleOutsideImage||i.options.deleteIfHandleOutsideImage;m&&Object(v.default)(h,c.handles)&&Object(t.removeToolState)(g,i.name,c),u.default.cornerstone.updateImage(g);return}u.default.cornerstone.updateImage(g),Object(d.moveNewHandle)(h,i.name,c,c.handles.end,i.options,"touch",function(){var E=r.default.MEASUREMENT_COMPLETED,T={toolName:i.name,toolType:i.name,element:g,measurementData:c};Object(o.default)(g,E,T)})}}},"./eventDispatchers/touchEventHandlers/index.js":function(H,n,e){e.r(n),e.d(n,"doubleTap",function(){return t}),e.d(n,"touchDrag",function(){return o}),e.d(n,"touchEnd",function(){return s}),e.d(n,"touchPinch",function(){return l}),e.d(n,"touchPress",function(){return a}),e.d(n,"touchRotate",function(){return i});var r=e("./eventDispatchers/shared/customCallbackHandler.js"),u=e("./eventDispatchers/touchEventHandlers/multiTouchDrag.js");e.d(n,"multiTouchDrag",function(){return u.default});var f=e("./eventDispatchers/touchEventHandlers/tap.js");e.d(n,"tap",function(){return f.default});var v=e("./eventDispatchers/touchEventHandlers/touchStart.js");e.d(n,"touchStart",function(){return v.default});var d=e("./eventDispatchers/touchEventHandlers/touchStartActive.js");e.d(n,"touchStartActive",function(){return d.default});var t=r.default.bind(null,"DoubleTap","doubleTapCallback"),o=r.default.bind(null,"Touch","touchDragCallback"),s=r.default.bind(null,"Touch","touchEndCallback"),l=r.default.bind(null,"TouchPinch","touchPinchCallback"),a=r.default.bind(null,"Touch","touchPressCallback"),i=r.default.bind(null,"TouchRotate","touchRotateCallback")},"./eventDispatchers/touchEventHandlers/multiTouchDrag.js":function(H,n,e){e.r(n);var r=e("./store/index.js"),u=e("./store/getActiveToolsForElement.js"),f=e("./store/filterToolsUsableWithMultiPartTools.js");n.default=function(v){if(r.state.isToolLocked)return!1;var d=v.detail,t=d.element,o=d.numPointers,s=r.state.tools.filter(function(a){return a.supportedInteractionTypes.includes("MultiTouch")});if(s=Object(u.default)(t,s,"MultiTouch"),s=s.filter(function(a){return typeof a.multiTouchDragCallback=="function"&&o===a.configuration.touchPointers}),r.state.isMultiPartToolActive&&(s=Object(f.default)(s)),s.length===0)return!1;var l=s[0];l.multiTouchDragCallback(v)}},"./eventDispatchers/touchEventHandlers/shared/deactivateAllToolInstances.js":function(H,n,e){e.r(n),n.default=function(u){if(u)for(var f=0;f<u.data.length;f++){var v=u.data[f];v.active=!1,v.handles&&r(v.handles)}};function r(u){Object.keys(u).forEach(function(f){var v=u[f];v.active=!1})}},"./eventDispatchers/touchEventHandlers/tap.js":function(H,n,e){e.r(n);var r=e("./externalModules.js"),u=e("./eventDispatchers/touchEventHandlers/touchStartActive.js"),f=e("./store/index.js"),v=e("./store/getActiveToolsForElement.js"),d=e("./store/getToolsWithDataForElement.js"),t=e("./stateManagement/toolState.js"),o=e("./manipulators/getHandleNearImagePoint.js"),s=e("./manipulators/index.js"),l=e("./eventDispatchers/touchEventHandlers/shared/deactivateAllToolInstances.js");n.default=function(a){if(!(f.state.isToolLocked||f.state.isMultiPartToolActive)){var i,h=28,g=a.detail.element,c=a.detail.currentPoints.canvas;i=Object(v.default)(g,f.getters.touchTools()),i=Object(d.default)(g,i);var m=i.filter(function(D){for(var L=Object(t.getToolState)(g,D.name),S=0;S<L.data.length;S++)if(Object(o.default)(g,L.data[S].handles,c,h)!==void 0)return!0;return!1});if(m.length>0){var E=m[0],T=Object(t.getToolState)(g,E.name),P=T.data.find(function(D){return Object(o.default)(g,D.handles,c,h)!==void 0});T.data.active=!0,P.active=!0,r.default.cornerstone.updateImage(g),Object(s.moveHandle)(a.detail,E.name,T.data,P,E.options,"touch",function(){return Object(l.default)(T)}),a.stopImmediatePropagation(),a.preventDefault();return}var M=i.filter(function(D){var L=Object(t.getToolState)(g,D.name),S=L&&L.data&&D.pointNearTool&&L.data.some(function(A){return D.pointNearTool(g,A,c)});return S});if(M.length>0){var C=M[0],O=Object(t.getToolState)(g,C.name),I=O.data.find(function(D){return C.pointNearTool(g,D,c)});I.active=!0,r.default.cornerstone.updateImage(g),Object(s.moveAllHandles)(a.detail,C.name,I,null,C.options,"touch",function(){return Object(l.default)(O)}),a.stopImmediatePropagation(),a.preventDefault();return}var _=Object(v.default)(g,f.getters.touchTools());return _.length>0&&_[0].touchStartActiveCallback?_[0].touchStartActiveCallback(a):Object(u.default)(a),!1}}},"./eventDispatchers/touchEventHandlers/touchStart.js":function(H,n,e){e.r(n);var r=e("./store/index.js"),u=e("./util/findAndMoveHelpers.js"),f=e("./store/getToolsWithMoveableHandles.js"),v=e("./stateManagement/toolState.js"),d=e("./store/getInteractiveToolsForElement.js"),t=e("./store/getToolsWithDataForElement.js"),o=e("./store/filterToolsUsableWithMultiPartTools.js");n.default=function(s){if(!r.state.isToolLocked){var l=s.detail,a=l.element,i=l.startPoints.canvas,h=Object(d.default)(a,r.getters.touchTools()),g=h.filter(function(B){return B.mode==="active"&&B.options.isTouchActive});if(r.state.isMultiPartToolActive&&(g=Object(o.default)(g)),g.length>0){var c=g.find(function(B){return typeof B.preTouchStartCallback=="function"});if(c){var m=c.preTouchStartCallback(s);if(m)return}}if(!r.state.isMultiPartToolActive){var E=Object(t.default)(a,h),T=Object(f.default)(a,E,i,"touch");if(T.length>0){var P=T[0],M=Object(v.getToolState)(a,P.name),C=Object(u.findHandleDataNearImagePoint)(a,M,P.name,i,"touch"),O=C.handle,I=C.data;P.handleSelectedCallback(s,I,O,"touch");return}var _=E.filter(function(B){var b=Object(v.getToolState)(a,B.name),y=b&&b.data&&B.pointNearTool&&b.data.some(function(x){return B.pointNearTool(a,x,i,"touch")});return y});if(_.length>0){var D=_[0],L=Object(v.getToolState)(a,D.name),S=L.data.find(function(B){return D.pointNearTool(a,B,i)});D.toolSelectedCallback(s,S,"touch");return}if(g.length>0){var A=g.find(function(B){return typeof B.postTouchStartCallback=="function"});if(A){var U=A.postTouchStartCallback(s);if(U)return}}}}}},"./eventDispatchers/touchEventHandlers/touchStartActive.js":function(H,n,e){e.r(n);var r=e("./store/index.js"),u=e("./eventDispatchers/touchEventHandlers/addNewMeasurement.js"),f=e("./tools/base/BaseAnnotationTool.js"),v=e("./util/getActiveTool.js");n.default=function(d){if(!(r.state.isToolLocked||r.state.isMultiPartToolActive)){var t=d.detail.element,o=Object(v.default)(t,null,"touch");o&&o.addNewMeasurement?o.addNewMeasurement(d,"touch"):o instanceof f.default&&Object(u.default)(d,o)}}},"./eventDispatchers/touchToolEventDispatcher.js":function(H,n,e){e.r(n);var r=e("./events.js"),u=e("./eventDispatchers/touchEventHandlers/index.js"),f=function(t){t.addEventListener(r.default.TAP,u.tap),t.addEventListener(r.default.TOUCH_START,u.touchStart,{passive:!1}),t.addEventListener(r.default.TOUCH_DRAG,u.touchDrag,{passive:!1}),t.addEventListener(r.default.TOUCH_END,u.touchEnd),t.addEventListener(r.default.TOUCH_START_ACTIVE,u.touchStartActive),t.addEventListener(r.default.TOUCH_PRESS,u.touchPress),t.addEventListener(r.default.DOUBLE_TAP,u.doubleTap),t.addEventListener(r.default.TOUCH_PINCH,u.touchPinch),t.addEventListener(r.default.TOUCH_ROTATE,u.touchRotate),t.addEventListener(r.default.MULTI_TOUCH_DRAG,u.multiTouchDrag)},v=function(t){t.removeEventListener(r.default.TAP,u.tap),t.removeEventListener(r.default.TOUCH_START,u.touchStart),t.removeEventListener(r.default.TOUCH_DRAG,u.touchDrag),t.removeEventListener(r.default.TOUCH_END,u.touchEnd),t.removeEventListener(r.default.TOUCH_START_ACTIVE,u.touchStartActive),t.removeEventListener(r.default.TOUCH_PRESS,u.touchPress),t.removeEventListener(r.default.DOUBLE_TAP,u.doubleTap),t.removeEventListener(r.default.TOUCH_PINCH,u.touchPinch),t.removeEventListener(r.default.TOUCH_ROTATE,u.touchRotate),t.removeEventListener(r.default.MULTI_TOUCH_DRAG,u.multiTouchDrag)};n.default={enable:f,disable:v}},"./eventListeners/index.js":function(H,n,e){e.r(n);var r=e("./eventListeners/mouseEventListeners.js");e.d(n,"mouseEventListeners",function(){return r.default});var u=e("./eventListeners/wheelEventListener.js");e.d(n,"wheelEventListener",function(){return u.default});var f=e("./eventListeners/touchEventListeners.js");e.d(n,"touchEventListeners",function(){return f.default})},"./eventListeners/internals/normalizeWheel.js":function(H,n,e){e.r(n);var r=10,u=40,f=800;n.default=function(v){var d=0,t=0,o=0,s=0;return"detail"in v&&(t=v.detail),"wheelDelta"in v&&(t=-v.wheelDelta/120),"wheelDeltaY"in v&&(t=-v.wheelDeltaY/120),"wheelDeltaX"in v&&(d=-v.wheelDeltaX/120),o=d*r,s=t*r,"deltaY"in v&&(s=v.deltaY),"deltaX"in v&&(o=v.deltaX),(o||s)&&v.deltaMode&&(v.deltaMode===1?(o*=u,s*=u):(o*=f,s*=f)),o&&!d&&(d=o<1?-1:1),s&&!t&&(t=s<1?-1:1),{spinX:d,spinY:t,pixelX:o,pixelY:s}}},"./eventListeners/internals/renderSegmentation.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return d});var r=e("./store/index.js"),u=e("./eventListeners/internals/renderSegmentationFill.js"),f=e("./eventListeners/internals/renderSegmentationOutline.js"),v=Object(r.getModule)("segmentation");function d(s,l,a,i,h){t(h)&&Object(u.default)(s,l,i,a,h),o(h)&&Object(f.default)(s,l,i,a,h)}function t(s){var l=v.configuration;return l.renderFill&&(s&&l.fillAlpha!==0||!s&&l.fillAlphaInactive!==0)}function o(s){var l=v.configuration;return l.renderOutline&&(s&&l.outlineAlpha!==0||!s&&l.outlineAlphaInactive!==0)}},"./eventListeners/internals/renderSegmentationFill.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return d}),e.d(n,"getLabelmapCanvas",function(){return t}),e.d(n,"renderFill",function(){return o});var r=e("./store/index.js"),u=e("./drawing/index.js"),f=e("./externalModules.js"),v=Object(r.getModule)("segmentation");function d(l,a,i,h,g){var c=t(l,a,i);o(l,c,g)}function t(l,a,i){var h=v.state,g=l.detail,c=g.image,m=c.width,E=c.height,T=a.segmentsHidden,P=i.pixelData,M=h.colorLutTables[a.colorLUTIndex],C=document.createElement("canvas");C.width=m,C.height=E;for(var O=Object(u.getNewContext)(C),I=new ImageData(m,E),_=I.data,D=0;D<P.length;D++){var L=P[D];if(L!==0&&!T[L]){var S=M[P[D]];_[4*D]=S[0],_[4*D+1]=S[1],_[4*D+2]=S[2],_[4*D+3]=S[3]}}return O.putImageData(I,0,0),C}function o(l,a,i){var h=v.configuration,g=l.detail,c=g.canvasContext,m=g.element,E=g.image,T=g.viewport,P=c.getTransform(),M=Object(u.getNewContext)(c.canvas),C=f.default.cornerstone.pixelToCanvas(m,{x:0,y:0}),O=f.default.cornerstone.pixelToCanvas(m,{x:E.width,y:0}),I=f.default.cornerstone.pixelToCanvas(m,{x:E.width,y:E.height}),_=f.default.cornerstoneMath.point.distance(C,O),D=f.default.cornerstoneMath.point.distance(O,I),L=c.canvas,S=M.imageSmoothingEnabled,A=M.globalAlpha;M.imageSmoothingEnabled=!1,M.globalAlpha=i?h.fillAlpha:h.fillAlphaInactive,Object(u.transformCanvasContext)(M,L,T);var U=s(g);M.drawImage(a,L.width/2-_/2+U.x,L.height/2-D/2+U.y,_,D),M.globalAlpha=A,M.imageSmoothingEnabled=S,M.setTransform(P)}function s(l){var a=l.viewport,i=l.image,h=a.scale,g=a.scale;return i.rowPixelSpacing<i.columnPixelSpacing?h*=i.columnPixelSpacing/i.rowPixelSpacing:i.columnPixelSpacing<i.rowPixelSpacing&&(g*=i.rowPixelSpacing/i.columnPixelSpacing),{x:a.translation.x*h,y:a.translation.y*g}}},"./eventListeners/internals/renderSegmentationOutline.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return d}),e.d(n,"renderOutline",function(){return t}),e.d(n,"getOutline",function(){return o}),e.d(n,"_addTopRightCorner",function(){return i});var r=e("./store/index.js"),u=e("./externalModules.js"),f=e("./drawing/index.js");e("./index.js");var v=Object(r.getModule)("segmentation");function d(P,M,C,O,I){var _=v.configuration,D=o(P,M,C,_.outlineWidth);t(P,D,M.colorLUTIndex,I)}function t(P,M,C){var O=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,I=v.configuration,_=v.state,D=P.detail,L=D.element,S=D.canvasContext,A=I.outlineWidth||1,U=S.getTransform(),B=Object(f.getNewContext)(S.canvas),b=_.colorLutTables[C],y=B.globalAlpha;B.globalAlpha=O?I.outlineAlpha:I.outlineAlphaInactive,Object(f.draw)(B,function(x){for(var j=1;j<M.length;j++)if(M[j]){var p=b[j];Object(f.drawLines)(x,L,M[j],{color:"rgba(".concat(p[0],", ").concat(p[1],", ").concat(p[2],", 1.0 )"),lineWidth:A},"canvas")}}),B.globalAlpha=y,B.setTransform(U)}function o(P,M,C,O){var I=P.detail,_=I.element,D=I.image,L=I.viewport,S=D.width,A=D.height;O=O||1;var U=M.segmentsHidden,B=C.pixelData,b=M.activeSegmentIndex,y=[];C.segmentsOnLabelmap.forEach(function(z){var Y=!U[z];Y&&(y[z]=[])}),y[b]||(y[b]=[]);for(var x=function(Y){return{x:Y%S,y:Math.floor(Y/S)}},j=s(L,O),p=0;p<B.length;p++){var R=B[p];if(R!==0){var W=!U[R];if(W){var K=x(p),N=l(K,A,S);(N.top===void 0||B[N.top]!==R)&&c(y[R],_,K,j),(N.bottom===void 0||B[N.bottom]!==R)&&m(y[R],_,K,j),(N.left===void 0||B[N.left]!==R)&&E(y[R],_,K,j),(N.right===void 0||B[N.right]!==R)&&T(y[R],_,K,j),N.topLeft!==void 0&&B[N.topLeft]!==R&&B[N.top]===R&&B[N.left]===R&&a(y[R],_,K,j),N.topRight!==void 0&&B[N.topRight]!==R&&B[N.top]===R&&B[N.right]===R&&i(y[R],_,K,j),N.bottomLeft!==void 0&&B[N.bottomLeft]!==R&&B[N.bottom]===R&&B[N.left]===R&&h(y[R],_,K,j),N.bottomRight!==void 0&&B[N.bottomRight]!==R&&B[N.bottom]===R&&B[N.right]===R&&g(y[R],_,K,j)}}}return y}function s(P,M){var C=M/2,O=P.rotation;O*=Math.PI/180;var I=Math.cos(O),_=Math.sin(O),D=[I,_],L=[-_,I],S={x:C*D[0],y:C*D[1]},A={x:C*L[0],y:C*L[1]};return P.hflip&&(S.x*=-1,S.y*=-1),P.vflip&&(A.x*=-1,A.y*=-1),{i:S,j:A}}function l(P,M,C){var O=P.y*C+P.x,I={},_=P.y-1>=0,D=P.y+1<M,L=P.x-1>=0,S=P.x+1<C;return _&&(I.top=O-C,S&&(I.topRight=I.top+1),L&&(I.topLeft=I.top-1)),D&&(I.bottom=O+C,S&&(I.bottomRight=I.bottom+1),L&&(I.bottomLeft=I.bottom-1)),L&&(I.left=O-1),S&&(I.right=O+1),I}function a(P,M,C,O){var I=u.default.cornerstone.pixelToCanvas,_=I(M,C);_.x+=O.j.x,_.y+=O.j.y;var D={x:_.x,y:_.y};D.x+=O.i.x*2,D.y+=O.i.y*2,P.push({start:_,end:D})}function i(P,M,C,O){var I=u.default.cornerstone.pixelToCanvas,_=I(M,{x:C.x+1,y:C.y});_.x+=O.j.x,_.y+=O.j.y;var D={x:_.x,y:_.y};D.x-=O.i.x*2,D.y-=O.i.y*2,P.push({start:_,end:D})}function h(P,M,C,O){var I=u.default.cornerstone.pixelToCanvas,_=I(M,{x:C.x,y:C.y+1});_.x-=O.j.x,_.y-=O.j.y;var D={x:_.x,y:_.y};D.x+=O.i.x*2,D.y+=O.i.y*2,P.push({start:_,end:D})}function g(P,M,C,O){var I=u.default.cornerstone.pixelToCanvas,_=I(M,{x:C.x+1,y:C.y+1});_.x-=O.j.x,_.y-=O.j.y;var D={x:_.x,y:_.y};D.x-=O.i.x*2,D.y-=O.i.y*2,P.push({start:_,end:D})}function c(P,M,C,O){var I=u.default.cornerstone.pixelToCanvas,_=I(M,C),D=I(M,{x:C.x+1,y:C.y});_.x+=O.j.x,_.y+=O.j.y,D.x+=O.j.x,D.y+=O.j.y,P.push({start:_,end:D})}function m(P,M,C,O){var I=u.default.cornerstone.pixelToCanvas,_=I(M,{x:C.x,y:C.y+1}),D=I(M,{x:C.x+1,y:C.y+1});_.x-=O.j.x,_.y-=O.j.y,D.x-=O.j.x,D.y-=O.j.y,P.push({start:_,end:D})}function E(P,M,C,O){var I=u.default.cornerstone.pixelToCanvas,_=I(M,C),D=I(M,{x:C.x,y:C.y+1});_.x+=O.i.x,_.y+=O.i.y,D.x+=O.i.x,D.y+=O.i.y,P.push({start:_,end:D})}function T(P,M,C,O){var I=u.default.cornerstone.pixelToCanvas,_=I(M,{x:C.x+1,y:C.y}),D=I(M,{x:C.x+1,y:C.y+1});_.x-=O.i.x,_.y-=O.i.y,D.x-=O.i.x,D.y-=O.i.y,P.push({start:_,end:D})}},"./eventListeners/mouseEventListeners.js":function(H,n,e){e.r(n);var r=e("./events.js"),u=e("./externalModules.js"),f=e("./util/copyPoints.js"),v=e("./util/triggerEvent.js"),d=e("./util/logger.js"),t=Object(d.getLogger)("eventListeners:mouseEventListeners"),o=!0,s,l=200,a=new Map;function i(P){if(typeof P.buttons=="number")return P.buttons;switch(P.which){case 0:return 0;case 1:return 1;case 2:return 4;case 3:return 2}return 0}function h(){o=!1}function g(P){var M=P.currentTarget,C=u.default.cornerstone.getEnabledElement(M);if(C.image){var O=r.default.MOUSE_DOUBLE_CLICK,I={page:u.default.cornerstoneMath.point.pageToPoint(P),image:u.default.cornerstone.pageToPixel(M,P.pageX,P.pageY),client:{x:P.clientX,y:P.clientY}};I.canvas=u.default.cornerstone.pixelToCanvas(M,I.image);var _=Object(f.default)(I);t.log("double-click: %o",i(P));var D={event:P,buttons:i(P),viewport:u.default.cornerstone.getViewport(M),image:C.image,element:M,startPoints:I,lastPoints:_,currentPoints:I,deltaPoints:{x:0,y:0},type:O};Object(v.default)(M,O,D)}}function c(P){var M=P.currentTarget,C=u.default.cornerstone.getEnabledElement(M);if(!C.image)return;s=setTimeout(h,l),M.removeEventListener("mousemove",m);var O={page:u.default.cornerstoneMath.point.pageToPoint(P),image:u.default.cornerstone.pageToPixel(M,P.pageX,P.pageY),client:{x:P.clientX,y:P.clientY}};O.canvas=u.default.cornerstone.pixelToCanvas(M,O.image);var I=Object(f.default)(O),_={event:P,buttons:i(P),viewport:u.default.cornerstone.getViewport(M),image:C.image,element:M,startPoints:O,lastPoints:I,currentPoints:O,deltaPoints:{x:0,y:0},type:r.default.MOUSE_DOWN},D=Object(v.default)(_.element,r.default.MOUSE_DOWN,_);D&&(_.type=r.default.MOUSE_DOWN_ACTIVATE,Object(v.default)(_.element,r.default.MOUSE_DOWN_ACTIVATE,_));function L(A){var U=r.default.MOUSE_DRAG,B={page:u.default.cornerstoneMath.point.pageToPoint(A),image:u.default.cornerstone.pageToPixel(M,A.pageX,A.pageY),client:{x:A.clientX,y:A.clientY}};B.canvas=u.default.cornerstone.pixelToCanvas(M,B.image);var b={page:u.default.cornerstoneMath.point.subtract(B.page,I.page),image:u.default.cornerstoneMath.point.subtract(B.image,I.image),client:u.default.cornerstoneMath.point.subtract(B.client,I.client),canvas:u.default.cornerstoneMath.point.subtract(B.canvas,I.canvas)};t.log("mousemove: %o",i(A));var y={buttons:i(A),viewport:u.default.cornerstone.getViewport(M),image:C.image,element:M,startPoints:O,lastPoints:I,currentPoints:B,deltaPoints:b,type:U,ctrlKey:A.ctrlKey,metaKey:A.metaKey,shiftKey:A.shiftKey};Object(v.default)(y.element,U,y),I=Object(f.default)(B)}function S(A){clearTimeout(s);var U=r.default.MOUSE_UP;o&&(U=r.default.MOUSE_CLICK);var B={page:u.default.cornerstoneMath.point.pageToPoint(A),image:u.default.cornerstone.pageToPixel(M,A.pageX,A.pageY),client:{x:A.clientX,y:A.clientY}};B.canvas=u.default.cornerstone.pixelToCanvas(M,B.image);var b={page:u.default.cornerstoneMath.point.subtract(B.page,I.page),image:u.default.cornerstoneMath.point.subtract(B.image,I.image),client:u.default.cornerstoneMath.point.subtract(B.client,I.client),canvas:u.default.cornerstoneMath.point.subtract(B.canvas,I.canvas)};t.log("mouseup: %o",i(A));var y={event:A,buttons:i(A),viewport:u.default.cornerstone.getViewport(M),image:C.image,element:M,startPoints:O,lastPoints:I,currentPoints:B,deltaPoints:b,type:U};Object(v.default)(y.element,U,y),document.removeEventListener("mousemove",L),document.removeEventListener("mouseup",S),a.delete(L),a.delete(S),M.addEventListener("mousemove",m),o=!0}document.addEventListener("mousemove",L),document.addEventListener("mouseup",S),a.set(L,"mousemove"),a.set(S,"mouseup")}function m(P){var M=P.currentTarget,C=u.default.cornerstone.getEnabledElement(M);if(C.image){var O=r.default.MOUSE_MOVE,I={page:u.default.cornerstoneMath.point.pageToPoint(P),image:u.default.cornerstone.pageToPixel(M,P.pageX,P.pageY),client:{x:P.clientX,y:P.clientY}};I.canvas=u.default.cornerstone.pixelToCanvas(M,I.image);var _=Object(f.default)(I),D={page:u.default.cornerstoneMath.point.pageToPoint(P),image:u.default.cornerstone.pageToPixel(M,P.pageX,P.pageY),client:{x:P.clientX,y:P.clientY}};D.canvas=u.default.cornerstone.pixelToCanvas(M,D.image);var L={page:u.default.cornerstoneMath.point.subtract(D.page,_.page),image:u.default.cornerstoneMath.point.subtract(D.image,_.image),client:u.default.cornerstoneMath.point.subtract(D.client,_.client),canvas:u.default.cornerstoneMath.point.subtract(D.canvas,_.canvas)},S={viewport:u.default.cornerstone.getViewport(M),image:C.image,element:M,startPoints:I,lastPoints:_,currentPoints:D,deltaPoints:L,type:O};Object(v.default)(M,O,S),_=Object(f.default)(D)}}function E(P){P.removeEventListener("mousedown",c),P.removeEventListener("mousemove",m),P.removeEventListener("dblclick",g),a.forEach(function(M,C){document.removeEventListener(M,C)}),a.clear()}function T(P){E(P),P.addEventListener("mousedown",c),P.addEventListener("mousemove",m),P.addEventListener("dblclick",g)}n.default={enable:T,disable:E}},"./eventListeners/onImageRenderedBrushEventHandler.js":function(H,n,e){e.r(n);var r=e("./store/index.js"),u=e("./eventListeners/internals/renderSegmentation.js"),f=Object(r.getModule)("segmentation");n.default=function(t){var o=t.detail,s=o.element,l=f.configuration,a=f.getters,i=a.labelmaps3D(s),h=i.activeLabelmapIndex,g=i.labelmaps3D,c=i.currentImageIdIndex;g&&(l.shouldRenderInactiveLabelmaps&&d(t,g,h,c),v(t,g,h,c))};function v(t,o,s,l){var a=o[s];if(a){var i=a.labelmaps2D[l];i&&Object(u.default)(t,a,s,i,!0)}}function d(t,o,s,l){for(var a=0;a<o.length;a++){var i=o[a];if(!(a===s||!i)){var h=i.labelmaps2D[l];h&&Object(u.default)(t,i,a,h,!1)}}}},"./eventListeners/preventGhostClick.js":function(H,n,e){e.r(n);var r=2e3,u={mouse:0,touch:1},f,v;function d(c,m){var E=Date.now();if(c!==f){if(E-v<=r)return m.preventDefault(),m.stopPropagation(),m.stopImmediatePropagation(),!1;f=c}v=E}var t=d.bind(null,u.mouse),o=d.bind(null,u.touch);function s(c,m,E){var T=E?t:o;m.forEach(function(P){c.addEventListener(P,T,{passive:!1})})}function l(c,m,E){var T=E?t:o;m.forEach(function(P){c.removeEventListener(P,T)})}var a=["mousedown","mouseup"],i=["touchstart","touchend"];function h(c){l(c,a,u.mouse),l(c,i,u.touch)}function g(c){h(c),s(c,a,u.mouse),s(c,i,u.touch)}n.default={enable:g,disable:h}},"./eventListeners/touchEventListeners.js":function(H,n,e){e.r(n);var r=e("./events.js"),u=e("./externalModules.js"),f=e("./util/copyPoints.js"),v=e("./eventListeners/preventGhostClick.js"),d=e("./util/triggerEvent.js"),t=e("./toolOptions.js"),o,s,l,a,i,h,g,c,m=1,E=0,T=!1,P=!1,M,C=700,O=5,I="touchInput";function _(A){var U=A.currentTarget||A.srcEvent.currentTarget,B=u.default.cornerstone.getEnabledElement(U);if(B.image){var b,y,x,j,p;switch(A.preventDefault(),(A.pointers&&A.pointers.length>1||A.touches&&A.touches.length>1)&&(P=!1,clearTimeout(g)),A.type){case"tap":P=!1,clearTimeout(g),s={page:u.default.cornerstoneMath.point.pageToPoint(A.pointers[0]),image:u.default.cornerstone.pageToPixel(U,A.pointers[0].pageX,A.pointers[0].pageY),client:{x:A.pointers[0].clientX,y:A.pointers[0].clientY}},s.canvas=u.default.cornerstone.pixelToCanvas(U,s.image),b=r.default.TAP,i={event:A,viewport:u.default.cornerstone.getViewport(U),image:B.image,element:U,currentPoints:s,type:b,isTouchEvent:!0},Object(d.default)(U,b,i);break;case"doubletap":P=!1,clearTimeout(g),s={page:u.default.cornerstoneMath.point.pageToPoint(A.pointers[0]),image:u.default.cornerstone.pageToPixel(U,A.pointers[0].pageX,A.pointers[0].pageY),client:{x:A.pointers[0].clientX,y:A.pointers[0].clientY}},s.canvas=u.default.cornerstone.pixelToCanvas(U,s.image),b=r.default.DOUBLE_TAP,i={event:A,viewport:u.default.cornerstone.getViewport(U),image:B.image,element:U,currentPoints:s,type:b,isTouchEvent:!0},Object(d.default)(U,b,i);break;case"pinchstart":P=!1,clearTimeout(g),m=1;break;case"pinchmove":if(P=!1,clearTimeout(g),T===!0){m=A.scale,T=!1;break}y=(A.scale-m)/m,o={page:A.center,image:u.default.cornerstone.pageToPixel(U,A.center.x,A.center.y)},o.canvas=u.default.cornerstone.pixelToCanvas(U,o.image),b=r.default.TOUCH_PINCH,i={event:A,startPoints:o,viewport:u.default.cornerstone.getViewport(U),image:B.image,element:U,direction:A.scale<1?1:-1,scaleChange:y,type:b,isTouchEvent:!0},Object(d.default)(U,b,i),m=A.scale;break;case"touchstart":m=1,clearTimeout(g),clearTimeout(h),h=setTimeout(function(){o={page:u.default.cornerstoneMath.point.pageToPoint(A.touches[0]),image:u.default.cornerstone.pageToPixel(U,A.touches[0].pageX,A.touches[0].pageY),client:{x:A.touches[0].clientX,y:A.touches[0].clientY}},o.canvas=u.default.cornerstone.pixelToCanvas(U,o.image),b=r.default.TOUCH_START,A.touches.length>1&&(b=r.default.MULTI_TOUCH_START),i={event:A,viewport:u.default.cornerstone.getViewport(U),image:B.image,element:U,startPoints:o,currentPoints:o,type:b,isTouchEvent:!0};var R=Object(d.default)(U,b,i);R===!0&&(b=r.default.TOUCH_START_ACTIVE,A.touches.length>1&&(b=r.default.MULTI_TOUCH_START_ACTIVE),i.type=b,Object(d.default)(U,b,i)),l=Object(f.default)(o)},50),P=!0,c=0,g=setTimeout(function(){P&&(s={page:u.default.cornerstoneMath.point.pageToPoint(A.touches[0]),image:u.default.cornerstone.pageToPixel(U,A.touches[0].pageX,A.touches[0].pageY),client:{x:A.touches[0].clientX,y:A.touches[0].clientY}},s.canvas=u.default.cornerstone.pixelToCanvas(U,o.image),b=r.default.TOUCH_PRESS,i={event:A,viewport:u.default.cornerstone.getViewport(U),image:B.image,element:U,currentPoints:s,type:b,isTouchEvent:!0},Object(d.default)(U,b,i))},C);break;case"touchend":m=1,P=!1,clearTimeout(g),setTimeout(function(){o={page:u.default.cornerstoneMath.point.pageToPoint(A.changedTouches[0]),image:u.default.cornerstone.pageToPixel(U,A.changedTouches[0].pageX,A.changedTouches[0].pageY),client:{x:A.changedTouches[0].clientX,y:A.changedTouches[0].clientY}},o.canvas=u.default.cornerstone.pixelToCanvas(U,o.image),b=r.default.TOUCH_END,i={event:A,viewport:u.default.cornerstone.getViewport(U),image:B.image,element:U,startPoints:o,currentPoints:o,type:b,isTouchEvent:!0},Object(d.default)(U,b,i)},50);break;case"panmove":x={x:A.deltaX-M.x,y:A.deltaY-M.y},M={x:A.deltaX,y:A.deltaY},s={page:{x:l.page.x+x.x,y:l.page.y+x.y},image:u.default.cornerstone.pageToPixel(U,l.page.x+x.x,l.page.y+x.y),client:{x:l.client.x+x.x,y:l.client.y+x.y}},s.canvas=u.default.cornerstone.pixelToCanvas(U,s.image),a={page:u.default.cornerstoneMath.point.subtract(s.page,l.page),image:u.default.cornerstoneMath.point.subtract(s.image,l.image),client:u.default.cornerstoneMath.point.subtract(s.client,l.client),canvas:u.default.cornerstoneMath.point.subtract(s.canvas,l.canvas)},c+=Math.sqrt(a.page.x*a.page.x+a.page.y*a.page.y),c>O&&(P=!1,clearTimeout(g)),b=r.default.TOUCH_DRAG,A.pointers.length>1&&(b=r.default.MULTI_TOUCH_DRAG),i={viewport:u.default.cornerstone.getViewport(U),image:B.image,element:U,startPoints:o,lastPoints:l,currentPoints:s,deltaPoints:a,numPointers:A.pointers.length,type:b,isTouchEvent:!0},Object(d.default)(U,b,i),l=Object(f.default)(s);break;case"panstart":M={x:A.deltaX,y:A.deltaY},s={page:u.default.cornerstoneMath.point.pageToPoint(A.pointers[0]),image:u.default.cornerstone.pageToPixel(U,A.pointers[0].pageX,A.pointers[0].pageY),client:{x:A.pointers[0].clientX,y:A.pointers[0].clientY}},s.canvas=u.default.cornerstone.pixelToCanvas(U,s.image),l=Object(f.default)(s);break;case"panend":if(P=!1,clearTimeout(g),!l)return!1;s={page:u.default.cornerstoneMath.point.pageToPoint(A.pointers[0]),image:u.default.cornerstone.pageToPixel(U,A.pointers[0].pageX,A.pointers[0].pageY),client:{x:A.pointers[0].clientX,y:A.pointers[0].clientY}},s.canvas=u.default.cornerstone.pixelToCanvas(U,s.image),a={page:u.default.cornerstoneMath.point.subtract(s.page,l.page),image:u.default.cornerstoneMath.point.subtract(s.image,l.image),client:u.default.cornerstoneMath.point.subtract(s.client,l.client),canvas:u.default.cornerstoneMath.point.subtract(s.canvas,l.canvas)},b=r.default.TOUCH_DRAG_END,i={event:A.srcEvent,viewport:u.default.cornerstone.getViewport(U),image:B.image,element:U,startPoints:o,lastPoints:l,currentPoints:s,deltaPoints:a,type:b,isTouchEvent:!0},Object(d.default)(U,b,i),j=A.pointers.length-A.changedPointers.length,j===2&&(T=!0);break;case"rotatemove":P=!1,clearTimeout(g),p=A.rotation-E,E=A.rotation,b=r.default.TOUCH_ROTATE,i={event:A.srcEvent,viewport:u.default.cornerstone.getViewport(U),image:B.image,element:U,rotation:p,type:b},Object(d.default)(U,b,i);break}return!1}}function D(A){L(A);var U=u.default.Hammer,B={inputClass:U.SUPPORT_POINTER_EVENTS?U.PointerEventInput:U.TouchInput},b=new U.Manager(A,B),y={pointers:0,direction:U.DIRECTION_ALL,threshold:0},x=new U.Pan(y),j=new U.Pinch({threshold:0}),p=new U.Rotate({threshold:0});j.recognizeWith(x),j.recognizeWith(p),p.recognizeWith(x);var R=new U.Tap({event:"doubletap",taps:2,interval:1500,threshold:50,posThreshold:50});R.recognizeWith(x),b.add([R,x,p,j]),b.on("tap doubletap panstart panmove panend pinchstart pinchmove rotatemove",_),v.default.enable(A);var W=["touchstart","touchend"];W.forEach(function(N){A.addEventListener(N,_,{passive:!1})});var K=Object(t.getToolOptions)(I,A);K.hammer=b,Object(t.setToolOptions)(I,A,K)}function L(A){v.default.disable(A);var U=["touchstart","touchend"];U.forEach(function(y){A.removeEventListener(y,_)});var B=Object(t.getToolOptions)(I,A),b=B.hammer;b&&(b.off("tap doubletap panstart panmove panend pinchstart pinchmove rotatemove",_),b.input.destroy()),B.hammer=null,Object(t.clearToolOptions)(I,A)}var S={enable:D,disable:L};n.default=S},"./eventListeners/wheelEventListener.js":function(H,n,e){e.r(n);var r=e("./events.js"),u=e("./externalModules.js"),f=e("./util/triggerEvent.js"),v=e("./eventListeners/internals/normalizeWheel.js");function d(s){var l=s.currentTarget,a=u.default.cornerstone.getEnabledElement(l);if(a.image&&!(s.deltaY>-1&&s.deltaY<1)){s.preventDefault();var i=s.pageX,h=s.pageY,g=u.default.cornerstone.pageToPixel(l,i,h),c=Object(v.default)(s),m=c.spinX,E=c.spinY,T=c.pixelX,P=c.pixelY,M=E<0?-1:1,C={element:l,viewport:u.default.cornerstone.getViewport(l),detail:s,image:a.image,direction:M,spinX:m,spinY:E,pixelX:T,pixelY:P,pageX:i,pageY:h,imageX:g.x,imageY:g.y};Object(f.default)(l,r.default.MOUSE_WHEEL,C)}}function t(s){o(s),s.addEventListener("wheel",d,{passive:!1})}function o(s){s.removeEventListener("wheel",d,{passive:!1})}n.default={enable:t,disable:o}},"./eventListeners/windowResizeHandler.js":function(H,n,e){e.r(n),e.d(n,"forceEnabledElementResize",function(){return o});var r=e("./store/index.js"),u=e("./externalModules.js"),f=function(){v(),window.addEventListener("resize",t,!1)},v=function(){window.removeEventListener("resize",t,!1)},d;function t(){d||(d=setTimeout(function(){d=null,o()},66))}var o=function(){r.state.enabledElements.forEach(function(l){u.default.cornerstone.resize(l)})};n.default={enable:f,disable:v}},"./events.js":function(H,n,e){e.r(n);var r={MOUSE_DOWN:"cornerstonetoolsmousedown",MOUSE_UP:"cornerstonetoolsmouseup",MOUSE_DOWN_ACTIVATE:"cornerstonetoolsmousedownactivate",MOUSE_DRAG:"cornerstonetoolsmousedrag",MOUSE_MOVE:"cornerstonetoolsmousemove",MOUSE_CLICK:"cornerstonetoolsmouseclick",MOUSE_DOUBLE_CLICK:"cornerstonetoolsmousedoubleclick",MOUSE_WHEEL:"cornerstonetoolsmousewheel",TOUCH_START:"cornerstonetoolstouchstart",TOUCH_START_ACTIVE:"cornerstonetoolstouchstartactive",TOUCH_END:"cornerstonetoolstouchend",TOUCH_DRAG:"cornerstonetoolstouchdrag",TOUCH_DRAG_END:"cornerstonetoolstouchdragend",TOUCH_PINCH:"cornerstonetoolstouchpinch",TOUCH_ROTATE:"cornerstonetoolstouchrotate",TOUCH_PRESS:"cornerstonetoolstouchpress",TAP:"cornerstonetoolstap",DOUBLE_TAP:"cornerstonetoolsdoubletap",MULTI_TOUCH_START:"cornerstonetoolsmultitouchstart",MULTI_TOUCH_START_ACTIVE:"cornerstonetoolsmultitouchstartactive",MULTI_TOUCH_DRAG:"cornerstonetoolsmultitouchdrag",KEY_DOWN:"cornerstonetoolskeydown",KEY_UP:"cornerstonetoolskeyup",KEY_PRESS:"cornerstonetoolskeypress",MEASUREMENT_ADDED:"cornerstonetoolsmeasurementadded",MEASUREMENT_MODIFIED:"cornerstonetoolsmeasurementmodified",MEASUREMENT_COMPLETED:"cornerstonetoolsmeasurementcompleted",MEASUREMENT_REMOVED:"cornerstonetoolsmeasurementremoved",TOOL_DEACTIVATED:"cornerstonetoolstooldeactivated",CLIP_STOPPED:"cornerstonetoolsclipstopped",STACK_SCROLL:"cornerstonetoolsstackscroll",STACK_PREFETCH_IMAGE_LOADED:"cornerstonetoolsstackprefetchimageloaded",STACK_PREFETCH_DONE:"cornerstonetoolsstackprefetchdone",LABELMAP_MODIFIED:"cornersontetoolslabelmapmodified"};n.default=r},"./externalModules.js":function(H,n,e){e.r(n);var r=window.cornerstone,u=window.cornerstoneMath,f=window.Hammer;n.default={set cornerstone(v){r=v},get cornerstone(){return r},set cornerstoneMath(v){u=v},get cornerstoneMath(){return u},set Hammer(v){f=v},get Hammer(){return f}}},"./importInternal.js":function(H,n,e){e.r(n);var r=e("./lib.js");n.default=function(u){return r.lib[u]}},"./index.js":function(H,n,e){e.r(n);var r=e("./tools/annotation/index.js");e.d(n,"AngleTool",function(){return r.AngleTool}),e.d(n,"ArrowAnnotateTool",function(){return r.ArrowAnnotateTool}),e.d(n,"BidirectionalTool",function(){return r.BidirectionalTool}),e.d(n,"CircleRoiTool",function(){return r.CircleRoiTool}),e.d(n,"CobbAngleTool",function(){return r.CobbAngleTool}),e.d(n,"EllipticalRoiTool",function(){return r.EllipticalRoiTool}),e.d(n,"FreehandRoiTool",function(){return r.FreehandRoiTool}),e.d(n,"LengthTool",function(){return r.LengthTool}),e.d(n,"ProbeTool",function(){return r.ProbeTool}),e.d(n,"RectangleRoiTool",function(){return r.RectangleRoiTool}),e.d(n,"TextMarkerTool",function(){return r.TextMarkerTool});var u=e("./tools/segmentation/index.js");e.d(n,"BrushTool",function(){return u.BrushTool}),e.d(n,"SphericalBrushTool",function(){return u.SphericalBrushTool}),e.d(n,"RectangleScissorsTool",function(){return u.RectangleScissorsTool}),e.d(n,"FreehandScissorsTool",function(){return u.FreehandScissorsTool}),e.d(n,"CircleScissorsTool",function(){return u.CircleScissorsTool}),e.d(n,"CorrectionScissorsTool",function(){return u.CorrectionScissorsTool});var f=e("./tools/index.js");e.d(n,"CrosshairsTool",function(){return f.CrosshairsTool}),e.d(n,"DoubleTapFitToWindowTool",function(){return f.DoubleTapFitToWindowTool}),e.d(n,"DragProbeTool",function(){return f.DragProbeTool}),e.d(n,"EraserTool",function(){return f.EraserTool}),e.d(n,"FreehandRoiSculptorTool",function(){return f.FreehandRoiSculptorTool}),e.d(n,"MagnifyTool",function(){return f.MagnifyTool}),e.d(n,"OverlayTool",function(){return f.OverlayTool}),e.d(n,"OrientationMarkersTool",function(){return f.OrientationMarkersTool}),e.d(n,"PanMultiTouchTool",function(){return f.PanMultiTouchTool}),e.d(n,"PanTool",function(){return f.PanTool}),e.d(n,"ReferenceLinesTool",function(){return f.ReferenceLinesTool}),e.d(n,"RotateTool",function(){return f.RotateTool}),e.d(n,"RotateTouchTool",function(){return f.RotateTouchTool}),e.d(n,"ScaleOverlayTool",function(){return f.ScaleOverlayTool}),e.d(n,"StackScrollMouseWheelTool",function(){return f.StackScrollMouseWheelTool}),e.d(n,"StackScrollMultiTouchTool",function(){return f.StackScrollMultiTouchTool}),e.d(n,"StackScrollTool",function(){return f.StackScrollTool}),e.d(n,"WwwcRegionTool",function(){return f.WwwcRegionTool}),e.d(n,"WwwcTool",function(){return f.WwwcTool}),e.d(n,"ZoomMouseWheelTool",function(){return f.ZoomMouseWheelTool}),e.d(n,"ZoomTool",function(){return f.ZoomTool}),e.d(n,"ZoomTouchPinchTool",function(){return f.ZoomTouchPinchTool});var v=e("./init.js");e.d(n,"init",function(){return v.default});var d=e("./stackTools/stackPrefetch.js");e.d(n,"stackPrefetch",function(){return d.default});var t=e("./stackTools/stackRenderers.js");e.d(n,"stackRenderers",function(){return t.default});var o=e("./stackTools/playClip.js");e.d(n,"playClip",function(){return o.playClip}),e.d(n,"stopClip",function(){return o.stopClip});var s=e("./store/index.js");e.d(n,"store",function(){return s.default}),e.d(n,"getModule",function(){return s.getModule});var l=e("./store/getToolForElement.js");e.d(n,"getToolForElement",function(){return l.default});var a=e("./store/addTool.js");e.d(n,"addTool",function(){return a.addTool}),e.d(n,"addToolForElement",function(){return a.addToolForElement});var i=e("./store/removeTool.js");e.d(n,"removeTool",function(){return i.removeTool}),e.d(n,"removeToolForElement",function(){return i.removeToolForElement});var h=e("./store/setToolOptions.js");e.d(n,"setToolOptions",function(){return h.setToolOptions}),e.d(n,"setToolOptionsForElement",function(){return h.setToolOptionsForElement});var g=e("./store/setToolMode.js");e.d(n,"setToolActive",function(){return g.setToolActive}),e.d(n,"setToolActiveForElement",function(){return g.setToolActiveForElement}),e.d(n,"setToolEnabled",function(){return g.setToolEnabled}),e.d(n,"setToolEnabledForElement",function(){return g.setToolEnabledForElement}),e.d(n,"setToolDisabled",function(){return g.setToolDisabled}),e.d(n,"setToolDisabledForElement",function(){return g.setToolDisabledForElement}),e.d(n,"setToolPassive",function(){return g.setToolPassive}),e.d(n,"setToolPassiveForElement",function(){return g.setToolPassiveForElement});var c=e("./store/isToolActiveForElement.js");e.d(n,"isToolActiveForElement",function(){return c.default});var m=e("./stateManagement/toolState.js");e.d(n,"addToolState",function(){return m.addToolState}),e.d(n,"getToolState",function(){return m.getToolState}),e.d(n,"removeToolState",function(){return m.removeToolState}),e.d(n,"clearToolState",function(){return m.clearToolState}),e.d(n,"setElementToolStateManager",function(){return m.setElementToolStateManager}),e.d(n,"getElementToolStateManager",function(){return m.getElementToolStateManager});var E=e("./stateManagement/textStyle.js");e.d(n,"textStyle",function(){return E.default});var T=e("./stateManagement/toolStyle.js");e.d(n,"toolStyle",function(){return T.default});var P=e("./stateManagement/toolColors.js");e.d(n,"toolColors",function(){return P.default});var M=e("./stateManagement/toolCoordinates.js");e.d(n,"toolCoordinates",function(){return M.default});var C=e("./stateManagement/stackSpecificStateManager.js");e.d(n,"stackSpecificStateManager",function(){return C.stackSpecificStateManager}),e.d(n,"newStackSpecificToolStateManager",function(){return C.newStackSpecificToolStateManager}),e.d(n,"addStackStateManager",function(){return C.addStackStateManager});var O=e("./stateManagement/loadHandlerManager.js");e.d(n,"loadHandlerManager",function(){return O.default});var I=e("./stateManagement/imageIdSpecificStateManager.js");e.d(n,"newImageIdSpecificToolStateManager",function(){return I.newImageIdSpecificToolStateManager}),e.d(n,"globalImageIdSpecificToolStateManager",function(){return I.globalImageIdSpecificToolStateManager});var _=e("./stateManagement/frameOfReferenceStateManager.js");e.d(n,"newFrameOfReferenceSpecificToolStateManager",function(){return _.newFrameOfReferenceSpecificToolStateManager}),e.d(n,"globalFrameOfReferenceSpecificToolStateManager",function(){return _.globalFrameOfReferenceSpecificToolStateManager});var D=e("./eventListeners/windowResizeHandler.js");e.d(n,"forceEnabledElementResize",function(){return D.forceEnabledElementResize});var L=e("./orientation/index.js");e.d(n,"orientation",function(){return L.default});var S=e("./util/SaveAs.js");e.d(n,"SaveAs",function(){return S.default});var A=e("./util/logger.js");e.d(n,"enableLogger",function(){return A.enable}),e.d(n,"disableLogger",function(){return A.disable});var U=e("./thirdParty/register.js");e.d(n,"register",function(){return U.default});var B=e("./thirdParty/registerSome.js");e.d(n,"registerSome",function(){return B.default});var b=e("./synchronization/wwwcSynchronizer.js");e.d(n,"wwwcSynchronizer",function(){return b.default});var y=e("./synchronization/updateImageSynchronizer.js");e.d(n,"updateImageSynchronizer",function(){return y.default});var x=e("./synchronization/Synchronizer.js");e.d(n,"Synchronizer",function(){return x.default});var j=e("./synchronization/stackScrollSynchronizer.js");e.d(n,"stackScrollSynchronizer",function(){return j.default});var p=e("./synchronization/stackImagePositionSynchronizer.js");e.d(n,"stackImagePositionSynchronizer",function(){return p.default});var R=e("./synchronization/stackImagePositionOffsetSynchronizer.js");e.d(n,"stackImagePositionOffsetSynchronizer",function(){return R.default});var W=e("./synchronization/stackImageIndexSynchronizer.js");e.d(n,"stackImageIndexSynchronizer",function(){return W.default});var K=e("./synchronization/panZoomSynchronizer.js");e.d(n,"panZoomSynchronizer",function(){return K.default});var N=e("./externalModules.js");e.d(n,"external",function(){return N.default});var z=e("./events.js");e.d(n,"EVENTS",function(){return z.default});var Y=e("./version.js");e.d(n,"version",function(){return Y.default});var $=e("./importInternal.js");e.d(n,"importInternal",function(){return $.default}),e.d(n,"import",function(){return $.default});var J={AngleTool:r.AngleTool,ArrowAnnotateTool:r.ArrowAnnotateTool,BidirectionalTool:r.BidirectionalTool,CircleRoiTool:r.CircleRoiTool,CobbAngleTool:r.CobbAngleTool,EllipticalRoiTool:r.EllipticalRoiTool,FreehandRoiTool:r.FreehandRoiTool,LengthTool:r.LengthTool,ProbeTool:r.ProbeTool,RectangleRoiTool:r.RectangleRoiTool,TextMarkerTool:r.TextMarkerTool,BrushTool:u.BrushTool,SphericalBrushTool:u.SphericalBrushTool,RectangleScissorsTool:u.RectangleScissorsTool,FreehandScissorsTool:u.FreehandScissorsTool,CircleScissorsTool:u.CircleScissorsTool,CorrectionScissorsTool:u.CorrectionScissorsTool,CrosshairsTool:f.CrosshairsTool,DoubleTapFitToWindowTool:f.DoubleTapFitToWindowTool,DragProbeTool:f.DragProbeTool,EraserTool:f.EraserTool,FreehandRoiSculptorTool:f.FreehandRoiSculptorTool,MagnifyTool:f.MagnifyTool,OverlayTool:f.OverlayTool,OrientationMarkersTool:f.OrientationMarkersTool,PanMultiTouchTool:f.PanMultiTouchTool,PanTool:f.PanTool,ReferenceLinesTool:f.ReferenceLinesTool,RotateTool:f.RotateTool,RotateTouchTool:f.RotateTouchTool,ScaleOverlayTool:f.ScaleOverlayTool,StackScrollMouseWheelTool:f.StackScrollMouseWheelTool,StackScrollMultiTouchTool:f.StackScrollMultiTouchTool,StackScrollTool:f.StackScrollTool,WwwcRegionTool:f.WwwcRegionTool,WwwcTool:f.WwwcTool,ZoomMouseWheelTool:f.ZoomMouseWheelTool,ZoomTool:f.ZoomTool,ZoomTouchPinchTool:f.ZoomTouchPinchTool,init:v.default,stackPrefetch:d.default,stackRenderers:t.default,playClip:o.playClip,stopClip:o.stopClip,store:s.default,getModule:s.getModule,getToolForElement:l.default,addTool:a.addTool,addToolForElement:a.addToolForElement,removeTool:i.removeTool,removeToolForElement:i.removeToolForElement,setToolOptions:h.setToolOptions,setToolOptionsForElement:h.setToolOptionsForElement,isToolActiveForElement:c.default,setToolActive:g.setToolActive,setToolActiveForElement:g.setToolActiveForElement,setToolEnabled:g.setToolEnabled,setToolEnabledForElement:g.setToolEnabledForElement,setToolDisabled:g.setToolDisabled,setToolDisabledForElement:g.setToolDisabledForElement,setToolPassive:g.setToolPassive,setToolPassiveForElement:g.setToolPassiveForElement,addToolState:m.addToolState,getToolState:m.getToolState,removeToolState:m.removeToolState,clearToolState:m.clearToolState,setElementToolStateManager:m.setElementToolStateManager,getElementToolStateManager:m.getElementToolStateManager,textStyle:E.default,toolStyle:T.default,toolColors:P.default,toolCoordinates:M.default,stackSpecificStateManager:C.stackSpecificStateManager,newStackSpecificToolStateManager:C.newStackSpecificToolStateManager,addStackStateManager:C.addStackStateManager,loadHandlerManager:O.default,newImageIdSpecificToolStateManager:I.newImageIdSpecificToolStateManager,globalImageIdSpecificToolStateManager:I.globalImageIdSpecificToolStateManager,newFrameOfReferenceSpecificToolStateManager:_.newFrameOfReferenceSpecificToolStateManager,globalFrameOfReferenceSpecificToolStateManager:_.globalFrameOfReferenceSpecificToolStateManager,forceEnabledElementResize:D.forceEnabledElementResize,orientation:L.default,SaveAs:S.default,enableLogger:A.enable,disableLogger:A.disable,importInternal:$.default,import:$.default,register:U.default,registerSome:B.default,wwwcSynchronizer:b.default,updateImageSynchronizer:y.default,Synchronizer:x.default,stackScrollSynchronizer:j.default,stackImagePositionSynchronizer:p.default,stackImagePositionOffsetSynchronizer:R.default,stackImageIndexSynchronizer:W.default,panZoomSynchronizer:K.default,external:N.default,EVENTS:z.default,version:Y.default};n.default=J},"./init.js":function(H,n,e){e.r(n);var r=e("./externalModules.js"),u=e("./store/index.js"),f=e("./store/internals/addEnabledElement.js"),v=e("./store/internals/removeEnabledElement.js"),d=e("./eventListeners/windowResizeHandler.js");n.default=function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};t(),s();var a=Object(u.getModule)("globalConfiguration");Array.isArray(l)?l.forEach(function(i){var h=i.moduleName,g=i.configuration,c=Object(u.getModule)(h);c&&(c.configuration=Object.assign({},c.configuration,g))}):a.configuration=Object.assign({},a.configuration,l),a.configuration.autoResizeViewports&&d.default.enable()};function t(){o();var l=r.default.cornerstone,a=l.EVENTS.ELEMENT_ENABLED,i=l.EVENTS.ELEMENT_DISABLED;l.events.addEventListener(a,f.default),l.events.addEventListener(i,v.default)}function o(){var l=r.default.cornerstone,a=l.EVENTS.ELEMENT_ENABLED,i=l.EVENTS.ELEMENT_DISABLED;l.events.removeEventListener(a,f.default),l.events.removeEventListener(i,v.default)}function s(){var l=u.default.modules;Object.keys(l).forEach(function(a){typeof l[a].onRegisterCallback=="function"&&l[a].onRegisterCallback()})}},"./lib.js":function(H,n,e){e.r(n),e.d(n,"lib",function(){return ee});var r=e("./tools/base/BaseTool.js"),u=e("./tools/base/BaseAnnotationTool.js"),f=e("./tools/base/BaseBrushTool.js"),v=e("./manipulators/index.js"),d=e("./util/findAndMoveHelpers.js"),t=e("./mixins/index.js"),o=e("./tools/cursors/index.js"),s=e("./drawing/index.js"),l=e("./util/clip.js"),a=e("./util/debounce.js"),i=e("./util/deepmerge.js"),h=e("./util/getDefault.js"),g=e("./util/getPixelSpacing.js"),c=e("./util/isEmptyObject.js"),m=e("./util/isObject.js"),E=e("./util/isPointInImage.js"),T=e("./util/isPointInPolygon.js"),P=e("./util/throttle.js"),M=e("./util/wait.js"),C=e("./util/getKeyPressData.js"),O=e("./util/getProximityThreshold.js"),I=e("./drawing/drawTextBox.js"),_=e("./drawing/drawArrow.js"),D=e("./drawing/drawLink.js"),L=e("./drawing/drawLinkedTextBox.js"),S=e("./drawing/drawHandles.js"),A=e("./util/getActiveTool.js"),U=e("./util/getLuminance.js"),B=e("./util/getROITextBoxCoords.js"),b=e("./util/copyPoints.js"),y=e("./util/calculateSUV.js"),x=e("./util/setContextToDisplayFontSize.js"),j=e("./util/scrollToIndex.js"),p=e("./util/scroll.js"),R=e("./util/roundToDecimal.js"),W=e("./util/pointProjector.js"),K=e("./util/lineSegDistance.js"),N=e("./util/logger.js"),z=e("./util/pointInsideBoundingBox.js"),Y=e("./util/makeUnselectable.js"),$=e("./util/getRGBPixels.js"),J=e("./util/getMaxSimultaneousRequests.js"),te=e("./util/angleBetweenPoints.js"),ne=e("./util/numbersWithCommas.js"),de=e("./tools/cursors/MouseCursor.js"),w=e("./util/ellipse/index.js"),G=e("./util/freehand/index.js"),Z=e("./util/segmentation/index.js"),Q=e("./util/zoom/index.js"),k=e("./util/triggerEvent.js"),ae=e("./util/convertToVector3.js"),ee={"base/BaseTool":r.default,"base/BaseAnnotationTool":u.default,"base/BaseBrushTool":f.default,"tools/cursors/MouseCursor":de.default,"tools/cursors":o,"manipulators/anyHandlesOutsideImage":v.anyHandlesOutsideImage,"manipulators/getHandleNearImagePoint":v.getHandleNearImagePoint,"manipulators/getHandlePixelPosition":v.getHandlePixelPosition,"manipulators/handleActivator":v.handleActivator,"manipulators/moveAllHandles":v.moveAllHandles,"manipulators/moveHandle":v.moveHandle,"manipulators/moveNewHandle":v.moveNewHandle,"manipulators/moveHandleNearImagePoint":d.moveHandleNearImagePoint,"manipulators/findHandleDataNearImagePoint":d.findHandleDataNearImagePoint,"manipulators/moveAnnotation":d.moveAnnotation,"mixins/activeOrDisabledBinaryTool":t.default.activeOrDisabledBinaryTool,"mixins/enabledOrDisabledBinaryTool":t.default.enabledOrDisabledBinaryTool,"drawing/getNewContext":s.getNewContext,"drawing/draw":s.draw,"drawing/path":s.path,"drawing/setShadow":s.setShadow,"drawing/drawLine":s.drawLine,"drawing/drawLines":s.drawLines,"drawing/drawJoinedLines":s.drawJoinedLines,"drawing/drawCircle":s.drawCircle,"drawing/drawEllipse":s.drawEllipse,"drawing/drawRect":s.drawRect,"drawing/fillOutsideRect":s.fillOutsideRect,"drawing/drawTextBox":I.default,"drawing/drawArrow":_.default,"drawing/fillBox":s.fillBox,"drawing/fillTextLines":s.fillTextLines,"drawing/drawLink":D.default,"drawing/drawLinkedTextBox":L.default,"drawing/drawHandles":S.default,"drawing/textBoxWidth":I.textBoxWidth,"util/getActiveTool":A.default,"util/getLuminance":U.default,"util/getROITextBoxCoords":B.default,"util/copyPoints":b.default,"util/calculateSUV":y.default,"util/setContextToDisplayFontSize":x.default,"util/scrollToIndex":j.default,"util/scroll":p.default,"util/roundToDecimal":R.default,"util/projectPatientPointToImagePlane":W.projectPatientPointToImagePlane,"util/imagePointToPatientPoint":W.imagePointToPatientPoint,"util/planePlaneIntersection":W.planePlaneIntersection,"util/pointInsideBoundingBox":z.default,"util/makeUnselectable":Y.default,"util/getRGBPixels":$.default,"util/getBrowserInfo":J.getBrowserInfo,"util/isMobileDevice":J.isMobileDevice,"util/angleBetweenPoints":te.default,"util/numbersWithCommas":ne.default,"util/lineSegDistance":K.default,"util/triggerEvent":k.default,"util/convertToVector3":ae.default,"util/clip":l.clip,"util/clipToBox":l.clipToBox,"util/clipBoxToDisplayedArea":l.clipBoxToDisplayedArea,"util/debounce":a.default,"util/deepmerge":i.default,"util/getDefault":h.default,"util/getProximityThreshold":O.default,"util/getPixelSpacing":g.default,"util/isEmptyObject":c.default,"util/isObject":m.default,"util/isPointInImage":E.default,"util/isPointInPolygon":T.default,"util/getLogger":N.getLogger,"util/throttle":P.default,"util/wait":M.wait,"util/waitForEnabledElementImageToLoad":M.waitForEnabledElementImageToLoad,"util/getKeyPressData":C.default,"util/ellipseUtils":w.default,"util/freehandUtils":G.default,"util/segmentationUtils":Z,"util/zoomUtils":Q.default}},"./manipulators/anyHandlesOutsideImage.js":function(H,n,e){e.r(n);var r=e("./externalModules.js");n.default=function(u,f){var v=u.image,d={left:0,top:0,width:v.width,height:v.height},t=!1;return Object.keys(f).forEach(function(o){var s=f[o];s.allowedOutsideImage!==!0&&r.default.cornerstoneMath.point.insideRect(s,d)===!1&&(t=!0)}),t}},"./manipulators/getHandleNearImagePoint.js":function(H,n,e){e.r(n);var r=e("../node_modules/@babel/runtime/helpers/typeof.js"),u=e.n(r),f=e("./externalModules.js"),v=e("./util/pointInsideBoundingBox.js"),d=function o(s,l,a,i){var h;if(l){if(Array.isArray(l))for(var g=Object.keys(l),c=0;c<g.length;c++){var m=g[c],E=l[m];if(!(!E.hasOwnProperty("x")||!E.hasOwnProperty("y"))&&t(E,s,a,i)){h=E;break}}else if(u()(l)==="object")for(var T=Object.keys(l),P=0;P<T.length;P++){var M=T[P];if(Array.isArray(l[M])){if(h=o(s,l[M],a,i),h)break}else{var C=l[M];if(t(C,s,a,i)){h=C;break}}}return h}},t=function(s,l,a,i){if(s.hasOwnProperty("pointNearHandle")){if(s.pointNearHandle(l,s,a))return!0}else if(s.hasBoundingBox===!0){if(Object(v.default)(s,a))return!0}else{var h=f.default.cornerstone.pixelToCanvas(l,s),g=f.default.cornerstoneMath.point.distance(h,a);if(g<=i)return!0}return!1};n.default=d},"./manipulators/getHandlePixelPosition.js":function(H,n,e){e.r(n);var r=e("./externalModules.js"),u=e("./store/index.js");n.default=function(f,v){var d=f.currentPoints,t=f.element,o=d.page,s=u.state.handleTouchOffset,l=0,a=0;return v==="touch"&&(l=s.x,a=s.y),r.default.cornerstone.pageToPixel(t,o.x+l,o.y+a)}},"./manipulators/handleActivator.js":function(H,n,e){e.r(n);var r=e("./manipulators/getHandleNearImagePoint.js");n.default=function(f,v,d,t){t||(t=6);var o=u(v),s=Object(r.default)(f,v,d,t);return o!==s?(s!==void 0&&(s.active=!0),o!==void 0&&(o.active=!1),!0):!1};function u(f){var v;return Object.keys(f).forEach(function(d){var t=f[d];if(t.active===!0){v=t;return}}),v}},"./manipulators/index.js":function(H,n,e){e.r(n);var r=e("./manipulators/anyHandlesOutsideImage.js");e.d(n,"anyHandlesOutsideImage",function(){return r.default});var u=e("./manipulators/getHandleNearImagePoint.js");e.d(n,"getHandleNearImagePoint",function(){return u.default});var f=e("./manipulators/getHandlePixelPosition.js");e.d(n,"getHandlePixelPosition",function(){return f.default});var v=e("./manipulators/handleActivator.js");e.d(n,"handleActivator",function(){return v.default});var d=e("./manipulators/moveAllHandles.js");e.d(n,"moveAllHandles",function(){return d.default});var t=e("./manipulators/moveHandle.js");e.d(n,"moveHandle",function(){return t.default});var o=e("./manipulators/moveNewHandle.js");e.d(n,"moveNewHandle",function(){return o.default})},"./manipulators/moveAllHandles.js":function(H,n,e){e.r(n);var r=e("./events.js"),u=e("./externalModules.js"),f=e("./manipulators/anyHandlesOutsideImage.js"),v=e("./stateManagement/toolState.js"),d=e("./util/triggerEvent.js"),t=e("./util/clip.js"),o=e("./store/index.js"),s=e("./util/getActiveTool.js"),l=e("./tools/base/BaseAnnotationTool.js"),a=e("./util/logger.js"),i=Object(a.getLogger)("manipulators:moveAllHandles"),h=Object(o.getModule)("manipulatorState"),g={mouse:[r.default.MOUSE_DRAG],touch:[r.default.TOUCH_DRAG]},c={mouse:[r.default.MOUSE_UP,r.default.MOUSE_CLICK],touch:[r.default.TOUCH_END,r.default.TOUCH_DRAG_END,r.default.TOUCH_PINCH,r.default.TOUCH_PRESS,r.default.TAP]};n.default=function(M,C,O,I){var _=M.element,D=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{},L=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"mouse",S=arguments.length>6?arguments[6]:void 0;D=Object.assign({deleteIfHandleOutsideImage:o.state.deleteIfHandleOutsideImage,preventHandleOutsideImage:o.state.preventHandleOutsideImage},D);var A=m.bind(this,C,O,D,L),U=function B(b){T(C,O,D,L,{dragHandler:A,upOrEndHandler:B},b,S)};h.setters.addActiveManipulatorForElement(_,E.bind(null,O,D,L,{dragHandler:A,upOrEndHandler:U},_,S)),O.active=!0,o.state.isToolLocked=!0,g[L].forEach(function(B){_.addEventListener(B,A)}),c[L].forEach(function(B){_.addEventListener(B,U)})};function m(M,C){var O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},I=arguments.length>3?arguments[3]:void 0,_=arguments.length>4?arguments[4]:void 0,D=_.detail,L=D.element,S=D.image,A=D.buttons,U=_.detail.deltaPoints.image,B=U.x,b=U.y;C.active=!0,C.invalidated=!0;for(var y=Object.keys(C.handles),x=0;x<y.length;x++){var j=y[x],p=C.handles[j];p.movesIndependently===!0||!p.hasOwnProperty("x")||!p.hasOwnProperty("y")||(p.x+=B,p.y+=b,O.preventHandleOutsideImage&&Object(t.clipToBox)(p,S))}u.default.cornerstone.updateImage(L);var R=Object(s.default)(L,A,I);R instanceof l.default&&R.updateCachedStats(S,L,C);var W=r.default.MEASUREMENT_MODIFIED,K={toolName:M,toolType:M,element:L,measurementData:C};Object(d.default)(L,W,K),_.preventDefault(),_.stopPropagation()}function E(M){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},O=arguments.length>2?arguments[2]:void 0,I=arguments.length>3?arguments[3]:void 0,_=I.dragHandler,D=I.upOrEndHandler,L=arguments.length>4?arguments[4]:void 0,S=arguments.length>5?arguments[5]:void 0;P(M,C,O,{dragHandler:_,upOrEndHandler:D},L,S,!1)}function T(M,C){var O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},I=arguments.length>3?arguments[3]:void 0,_=arguments.length>4?arguments[4]:void 0,D=_.dragHandler,L=_.upOrEndHandler,S=arguments.length>5?arguments[5]:void 0,A=arguments.length>6?arguments[6]:void 0,U=S.detail,B=U.element;h.setters.removeActiveManipulatorForElement(B),O.deleteIfHandleOutsideImage&&Object(f.default)(U,C.handles)&&Object(v.removeToolState)(B,M,C),P(C,O,I,{dragHandler:D,upOrEndHandler:L},B,A,!0)}function P(M){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},O=arguments.length>2?arguments[2]:void 0,I=arguments.length>3?arguments[3]:void 0,_=I.dragHandler,D=I.upOrEndHandler,L=arguments.length>4?arguments[4]:void 0,S=arguments.length>5?arguments[5]:void 0,A=arguments.length>6&&arguments[6]!==void 0?arguments[6]:!0;M.active=!1,M.invalidated=!0,o.state.isToolLocked=!1,g[O].forEach(function(U){L.removeEventListener(U,_)}),c[O].forEach(function(U){L.removeEventListener(U,D)}),typeof C.doneMovingCallback=="function"&&(i.warn("`options.doneMovingCallback` has been depricated. See https://github.com/cornerstonejs/cornerstoneTools/pull/915 for details."),C.doneMovingCallback(A)),typeof S=="function"&&S(A),u.default.cornerstone.updateImage(L)}},"./manipulators/moveHandle.js":function(H,n,e){e.r(n);var r=e("./events.js"),u=e("./externalModules.js"),f=e("./manipulators/anyHandlesOutsideImage.js"),v=e("./manipulators/getHandlePixelPosition.js"),d=e("./stateManagement/toolState.js"),t=e("./util/triggerEvent.js"),o=e("./util/clip.js"),s=e("./store/index.js"),l=e("./util/getActiveTool.js"),a=e("./tools/base/BaseAnnotationTool.js"),i=e("./util/logger.js"),h=Object(i.getLogger)("manipulators:moveHandle"),g=Object(s.getModule)("manipulatorState"),c={value:!1},m={mouse:[r.default.MOUSE_DRAG],touch:[r.default.TOUCH_DRAG]},E={mouse:[r.default.MOUSE_UP,r.default.MOUSE_CLICK],touch:[r.default.TOUCH_END,r.default.TOUCH_DRAG_END,r.default.TOUCH_PINCH,r.default.TOUCH_PRESS,r.default.TAP]};n.default=function(I,_,D,L){var S=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{},A=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"mouse",U=arguments.length>6?arguments[6]:void 0;S=Object.assign({deleteIfHandleOutsideImage:s.state.deleteIfHandleOutsideImage,preventHandleOutsideImage:s.state.preventHandleOutsideImage},S);var B=I.element,b=T.bind(this,_,D,L,S,A),y=function p(){M(_,I,D,L,S,A,{dragHandler:b,upOrEndHandler:p},U)};if(g.setters.addActiveManipulatorForElement(B,P.bind(null,_,I,D,L,S,A,{dragHandler:b,upOrEndHandler:y},U)),L.active=!0,L.moving=!0,D.active=!0,s.state.isToolLocked=!0,m[A].forEach(function(p){B.addEventListener(p,b)}),E[A].forEach(function(p){B.addEventListener(p,y)}),A==="touch"){c.value=!0;var x=u.default.cornerstone.getEnabledElement(B),j=Object(v.default)(I,A);O(L,c,x,j)}};function T(I,_,D,L,S,A){var U=A.detail,B=U.image,b=U.element,y=U.buttons,x=Object(v.default)(A.detail,S);c.value=!1,D.active=!0,D.hasMoved=!0,D.x=x.x,D.y=x.y,_.invalidated=!0,L.preventHandleOutsideImage&&Object(o.clipToBox)(D,B),u.default.cornerstone.updateImage(b);var j=Object(l.default)(b,y,S);j instanceof a.default&&j.updateCachedStats(B,b,_);var p=r.default.MEASUREMENT_MODIFIED,R={toolName:I,toolType:I,element:b,measurementData:_};Object(t.default)(b,p,R)}function P(I,_,D,L){var S=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{},A=arguments.length>5?arguments[5]:void 0,U=arguments.length>6?arguments[6]:void 0,B=U.dragHandler,b=U.upOrEndHandler,y=arguments.length>7?arguments[7]:void 0;C(I,_,D,L,S,A,{dragHandler:B,upOrEndHandler:b},y,!1)}function M(I,_,D,L){var S=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{},A=arguments.length>5?arguments[5]:void 0,U=arguments.length>6?arguments[6]:void 0,B=U.dragHandler,b=U.upOrEndHandler,y=arguments.length>7?arguments[7]:void 0,x=_.element;g.setters.removeActiveManipulatorForElement(x),C(I,_,D,L,S,A,{dragHandler:B,upOrEndHandler:b},y,!0)}function C(I,_,D,L){var S=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{},A=arguments.length>5?arguments[5]:void 0,U=arguments.length>6?arguments[6]:void 0,B=U.dragHandler,b=U.upOrEndHandler,y=arguments.length>7?arguments[7]:void 0,x=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!0,j=_.element;L.active=!1,L.moving=!1,D.active=!1,D.invalidated=!0,c.value=!1,s.state.isToolLocked=!1,m[A].forEach(function(p){j.removeEventListener(p,B)}),E[A].forEach(function(p){j.removeEventListener(p,b)}),S.deleteIfHandleOutsideImage&&Object(f.default)(_,D.handles)&&Object(d.removeToolState)(j,I,D),typeof S.doneMovingCallback=="function"&&(h.warn("`options.doneMovingCallback` has been depricated. See https://github.com/cornerstonejs/cornerstoneTools/pull/915 for details."),S.doneMovingCallback(x)),typeof y=="function"&&y(x),u.default.cornerstone.updateImage(j)}function O(I,_,D,L){if(_.value){var S=Math.abs(I.y-L.y),A=S/10;if(S<1){I.y=L.y,_.value=!1;return}I.y>L.y?I.y-=A:I.y<L.y&&(I.y+=A),u.default.cornerstone.updateImage(D.element),u.default.cornerstone.requestAnimationFrame(function(){O(I,_,D,L)})}}},"./manipulators/moveNewHandle.js":function(H,n,e){e.r(n);var r=e("./events.js"),u=e("./externalModules.js"),f=e("./manipulators/anyHandlesOutsideImage.js"),v=e("./manipulators/getHandlePixelPosition.js"),d=e("./stateManagement/toolState.js"),t=e("./util/triggerEvent.js"),o=e("./util/clip.js"),s=e("./store/index.js"),l=e("./util/getActiveTool.js"),a=e("./tools/base/BaseAnnotationTool.js"),i=e("./util/logger.js"),h=Object(i.getLogger)("manipulators:moveNewHandle"),g=Object(s.getModule)("manipulatorState"),c={mouse:[r.default.MOUSE_MOVE,r.default.MOUSE_DRAG],touch:[r.default.TOUCH_DRAG]},m={mouse:[r.default.MOUSE_UP,r.default.MOUSE_CLICK],touch:[r.default.TOUCH_END,r.default.TOUCH_PINCH,r.default.TAP]};n.default=function(O,I,_,D,L){var S=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"mouse",A=arguments.length>6?arguments[6]:void 0;L=Object.assign({deleteIfHandleOutsideImage:s.state.deleteIfHandleOutsideImage,preventHandleOutsideImage:s.state.preventHandleOutsideImage},L),L.hasMoved=!1;var U=O.element;_.active=!0,D.moving=!0,D.active=!0,s.state.isToolLocked=!0;function B(y){E(I,_,D,L,S,y)}function b(y){P(I,_,D,L,S,{moveHandler:B,moveEndHandler:b},y,A)}c[S].forEach(function(y){U.addEventListener(y,B)}),U.addEventListener(r.default.TOUCH_START,C),m[S].forEach(function(y){U.addEventListener(y,b)}),g.setters.addActiveManipulatorForElement(U,M.bind(null,_,D,L,S,{moveHandler:B,moveEndHandler:b},U,A))};function E(O,I,_,D,L,S){var A=S.detail,U=A.image,B=A.element,b=A.buttons,y=Object(v.default)(S.detail,L);D.hasMoved=!0,I.invalidated=!0,_.active=!0,_.x=y.x,_.y=y.y,D&&D.preventHandleOutsideImage&&Object(o.clipToBox)(_,U),u.default.cornerstone.updateImage(B);var x=Object(l.default)(B,b,L);x instanceof a.default&&x.updateCachedStats(U,B,I);var j=r.default.MEASUREMENT_MODIFIED,p={toolName:O,toolType:O,element:B,measurementData:I};Object(t.default)(B,j,p)}function T(O,I,_,D,L){var S=D.moveHandler,A=D.moveEndHandler,U=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;c[O].forEach(function(B){_.removeEventListener(B,S)}),m[O].forEach(function(B){_.removeEventListener(B,A)}),_.removeEventListener(r.default.TOUCH_START,C),s.state.isToolLocked=!1,typeof L=="function"&&L(U),typeof I.doneMovingCallback=="function"&&(h.warn("`options.doneMovingCallback` has been depricated. See https://github.com/cornerstonejs/cornerstoneTools/pull/915 for details."),I.doneMovingCallback(U)),u.default.cornerstone.updateImage(_)}function P(O,I,_,D,L,S,A,U){var B=S.moveHandler,b=S.moveEndHandler,y=A.detail,x=y.element,j=!0;if(D.hasMoved!==!1){var p=Object(v.default)(y,L);I.active=!1,I.invalidated=!0,_.active=!1,_.moving=!1,_.x=p.x,_.y=p.y,g.setters.removeActiveManipulatorForElement(x),D.preventHandleOutsideImage&&Object(o.clipToBox)(_,A.detail.image),D.deleteIfHandleOutsideImage&&Object(f.default)(A.detail,I.handles)&&(I.cancelled=!0,j=!1,Object(d.removeToolState)(x,O,I)),T(L,D,x,{moveHandler:B,moveEndHandler:b},U,j)}}function M(O,I,_,D,L,S,A){var U=L.moveHandler,B=L.moveEndHandler;O.active=!1,O.invalidated=!0,I.active=!1,T(D,_,S,{moveHandler:U,moveEndHandler:B},A,!1)}function C(O){return O.stopImmediatePropagation(),!1}},"./mixins/activeOrDisabledBinaryTool.js":function(H,n,e){e.r(n);var r=e("./store/setToolMode.js");function u(v){Object(r.setToolDisabledForElement)(v,this.name)}function f(v){Object(r.setToolActiveForElement)(v,this.name)}n.default={passiveCallback:u,enabledCallback:f}},"./mixins/enabledOrDisabledBinaryTool.js":function(H,n,e){e.r(n);var r=e("./store/setToolMode.js");function u(v){Object(r.setToolDisabledForElement)(v,this.name)}function f(v){Object(r.setToolEnabledForElement)(v,this.name)}n.default={passiveCallback:u,activeCallback:f}},"./mixins/index.js":function(H,n,e){e.r(n);var r=e("./mixins/activeOrDisabledBinaryTool.js"),u=e("./mixins/enabledOrDisabledBinaryTool.js"),f=e("./mixins/segmentation/circleSegmentationMixin.js"),v=e("./mixins/segmentation/polylineSegmentationMixin.js"),d=e("./mixins/segmentation/freehandSegmentationMixin.js"),t=e("./mixins/segmentation/rectangleSegmentationMixin.js"),o=e("./mixins/segmentation/renderBrushMixin.js");n.default={activeOrDisabledBinaryTool:r.default,enabledOrDisabledBinaryTool:u.default,circleSegmentationMixin:f.default,polylineSegmentationMixin:v.default,freehandSegmentationMixin:d.default,rectangleSegmentationMixin:t.default,renderBrushMixin:o.default}},"./mixins/segmentation/circleSegmentationMixin.js":function(H,n,e){e.r(n);var r=e("./drawing/index.js"),u=e("./externalModules.js"),f=e("./util/isEmptyObject.js"),v=e("./store/index.js"),d=e("./util/segmentation/index.js"),t=Object(v.getModule)("segmentation"),o=t.getters,s=t.setters;function l(){this.handles={start:{},end:{}}}function a(c){var m=this,E=c.detail,T=E.element,P=o.brushColor(T,!0),M=Object(r.getNewContext)(E.canvasContext.canvas),C=u.default.cornerstoneMath.point.distance;Object(r.draw)(M,function(O){if(!m.handles)return null;var I=u.default.cornerstone.pixelToCanvas(T,m.handles.start),_=u.default.cornerstone.pixelToCanvas(T,m.handles.end),D=C(I,_);Object(r.drawCircle)(O,T,m.handles.start,D,{color:P})})}function i(c){var m=!0,E=c.detail.element,T=c.detail.currentPoints.image;return Object(f.default)(this.handles.start)?this.handles.start=T:(this.handles.end=T,this._applyStrategy(c)),u.default.cornerstone.updateImage(E),m}function h(c){var m=c.detail,E=m.element,T=m.currentPoints,P=T.image;this.handles.end=P,u.default.cornerstone.updateImage(E)}function g(c){c.detail.handles=this.handles;var m=c.detail.element,E=o.labelmap2D(m),T=E.labelmap2D,P=E.labelmap3D,M=E.currentImageIdIndex,C=T.pixelData,O=C.slice(),I={start:{x:this.handles.start.x,y:this.handles.start.y},end:{x:this.handles.end.x,y:this.handles.end.y}},_={points:I,pixelData:C,segmentIndex:P.activeSegmentIndex,segmentationMixinType:"circleSegmentationMixin"};this.applyActiveStrategy(c,_);var D={imageIdIndex:M,diff:Object(d.getDiffBetweenPixelData)(O,C)};s.pushState(this.element,[D]),s.updateSegmentsOnLabelmap2D(T),u.default.cornerstone.updateImage(m),this._resetHandles()}n.default={postTouchStartCallback:i,postMouseDownCallback:i,mouseClickCallback:i,touchDragCallback:h,mouseDragCallback:h,mouseMoveCallback:h,touchEndCallback:g,mouseUpCallback:g,initializeMixin:l,renderToolData:a,_resetHandles:l,_applyStrategy:g}},"./mixins/segmentation/freehandSegmentationMixin.js":function(H,n,e){e.r(n);var r=e("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),u=e.n(r),f=e("./externalModules.js"),v=e("./store/index.js"),d=e("./util/logger.js"),t=e("./drawing/index.js"),o=e("./util/segmentation/index.js"),s=Object(d.getLogger)("tools:ScissorsTool"),l=Object(v.getModule)("segmentation"),a=l.getters,i=l.setters;function h(P){var M=P.detail,C=M.element,O=a.brushColor(C,!0),I=Object(t.getNewContext)(M.canvasContext.canvas),_=this.handles.points;_.length<2||Object(t.draw)(I,function(D){for(var L=0;L<_.length;L++){var S=u()(_[L].lines);L===_.length-1&&S.push(_[0]),Object(t.drawJoinedLines)(D,C,_[L],S,{color:O})}})}function g(P){var M=P.detail.element,C=P.detail.currentPoints.image,O=this.handles.points;if(!O.length)return s.warn("Something went wrong, empty handles detected."),null;O.push({x:C.x,y:C.y,lines:[]}),this.currentHandle+=1,f.default.cornerstone.updateImage(M)}function c(P){var M=P.detail,C=P.detail.element;this._addPoint(M),f.default.cornerstone.updateImage(C)}function m(P){var M=this.handles.points,C=P.detail.element,O=a.labelmap2D(C),I=O.labelmap2D,_=O.labelmap3D,D=O.currentImageIdIndex,L=I.pixelData,S=L.slice(),A={points:M,pixelData:L,segmentIndex:_.activeSegmentIndex,segmentationMixinType:"freehandSegmentationMixin"};this.applyActiveStrategy(P,A);var U={imageIdIndex:D,diff:Object(o.getDiffBetweenPixelData)(S,L)};i.pushState(this.element,[U]),i.updateSegmentsOnLabelmap2D(I),f.default.cornerstone.updateImage(C),this._resetHandles()}function E(){this.handles={points:[]},this.currentHandle=0}function T(P){var M=this.handles.points;M.length&&M[this.currentHandle-1].lines.push({x:P.currentPoints.image.x,y:P.currentPoints.image.y,lines:[]}),M.push({x:P.currentPoints.image.x,y:P.currentPoints.image.y,lines:[]}),this.currentHandle+=1,f.default.cornerstone.updateImage(P.element)}n.default={postTouchStartCallback:g,postMouseDownCallback:g,mouseClickCallback:g,touchDragCallback:c,mouseDragCallback:c,mouseMoveCallback:c,touchEndCallback:m,mouseUpCallback:m,initializeMixin:E,renderToolData:h,_resetHandles:E,_addPoint:T,_applyStrategy:m}},"./mixins/segmentation/polylineSegmentationMixin.js":function(H,n,e){e.r(n);var r=e("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),u=e.n(r),f=e("./drawing/index.js"),v=e("./store/index.js"),d=e("./mixins/segmentation/freehandSegmentationMixin.js"),t=Object(v.getModule)("segmentation"),o=t.getters;function s(a){var i=this,h=a.detail,g=h.element,c=o.brushColor(g,!0),m=Object(f.getNewContext)(h.canvasContext.canvas),E=this.handles;Object(f.draw)(m,function(T){var P=E.points.length>1;if(P)for(var M=0;M<E.points.length;M++){var C=u()(E.points[M].lines);Object(f.drawJoinedLines)(T,g,i.handles.points[M],C,{color:c})}})}var l=Object.assign({},d.default,{renderToolData:s});n.default=l},"./mixins/segmentation/rectangleSegmentationMixin.js":function(H,n,e){e.r(n);var r=e("./drawing/index.js"),u=e("./externalModules.js"),f=e("./util/isEmptyObject.js"),v=e("./store/index.js"),d=e("./util/segmentation/index.js"),t=Object(v.getModule)("segmentation"),o=t.getters,s=t.setters;function l(c){var m=this,E=c.detail,T=E.element,P=o.brushColor(T,!0),M=Object(r.getNewContext)(E.canvasContext.canvas);Object(r.draw)(M,function(C){Object(r.drawRect)(C,T,m.handles.start,m.handles.end,{color:P})})}function a(c){var m=!0,E=c.detail.element,T=c.detail.currentPoints.image;return Object(f.default)(this.handles.start)?this.handles.start=T:(this.handles.end=T,this._applyStrategy(c)),u.default.cornerstone.updateImage(E),m}function i(c){var m=c.detail,E=m.element,T=m.currentPoints.image;this.handles.end=T,u.default.cornerstone.updateImage(E)}function h(c){c.detail.handles=this.handles;var m=c.detail.element,E=o.labelmap2D(m),T=E.labelmap2D,P=E.labelmap3D,M=E.currentImageIdIndex,C=T.pixelData,O=C.slice(),I=[{x:this.handles.start.x,y:this.handles.start.y},{x:this.handles.end.x,y:this.handles.end.y}],_={points:I,pixelData:C,segmentIndex:P.activeSegmentIndex,segmentationMixinType:"rectangleSegmentationMixin"};this.applyActiveStrategy(c,_);var D={imageIdIndex:M,diff:Object(d.getDiffBetweenPixelData)(O,C)};s.pushState(this.element,[D]),s.updateSegmentsOnLabelmap2D(T),u.default.cornerstone.updateImage(m),this._resetHandles()}function g(){this.handles={start:{},end:{}}}n.default={postTouchStartCallback:a,postMouseDownCallback:a,mouseClickCallback:a,touchDragCallback:i,mouseDragCallback:i,mouseMoveCallback:i,touchEndCallback:h,mouseUpCallback:h,initializeMixin:g,renderToolData:l,_resetHandles:g,_applyStrategy:h}},"./mixins/segmentation/renderBrushMixin.js":function(H,n,e){e.r(n);var r=e("./externalModules.js"),u=e("./store/index.js");function f(v){var d=r.default.cornerstone,t=Object(u.getModule)("segmentation"),o=t.getters,s=t.configuration,l=v.detail,a=l.viewport,i;if(this._drawing?i=this._lastImageCoords:this._mouseUpRender?(i=this._lastImageCoords,this._mouseUpRender=!1):i=u.default.state.mousePositionImage,!!i){var h=l.image,g=h.rows,c=h.columns,m=i,E=m.x,T=m.y;if(!(E<0||E>c||T<0||T>g)){var P=s.radius,M=l.canvasContext,C=l.element,O=o.brushColor(C,this._drawing);M.setTransform(1,0,0,1,0,0);var I=P*a.scale,_=d.pixelToCanvas(C,i);M.beginPath(),M.strokeStyle=O,M.ellipse(_.x,_.y,I,I,0,0,2*Math.PI),M.stroke()}}}n.default={renderBrush:f}},"./orientation/getOrientationString.js":function(H,n,e){e.r(n);var r=e("./externalModules.js"),u=e("./util/convertToVector3.js");n.default=function(f){for(var v=Object(u.default)(f),d="",t=v.x<0?"R":"L",o=v.y<0?"A":"P",s=v.z<0?"F":"H",l=new r.default.cornerstoneMath.Vector3(Math.abs(v.x),Math.abs(v.y),Math.abs(v.z)),a=1e-4,i=0;i<3;i++)if(l.x>a&&l.x>l.y&&l.x>l.z)d+=t,l.x=0;else if(l.y>a&&l.y>l.x&&l.y>l.z)d+=o,l.y=0;else if(l.z>a&&l.z>l.x&&l.z>l.y)d+=s,l.z=0;else if(l.x>a&&l.y>a&&l.x===l.y)d+=t+o,l.x=0,l.y=0;else if(l.x>a&&l.z>a&&l.x===l.z)d+=t+s,l.x=0,l.z=0;else if(l.y>a&&l.z>a&&l.y===l.z)d+=o+s,l.y=0,l.z=0;else break;return d}},"./orientation/index.js":function(H,n,e){e.r(n);var r=e("./orientation/getOrientationString.js"),u=e("./orientation/invertOrientationString.js"),f={getOrientationString:r.default,invertOrientationString:u.default};n.default=f},"./orientation/invertOrientationString.js":function(H,n,e){e.r(n),n.default=function(r){var u=r.replace("H","f");return u=u.replace("F","h"),u=u.replace("R","l"),u=u.replace("L","r"),u=u.replace("A","p"),u=u.replace("P","a"),u=u.toUpperCase(),u}},"./stackTools/fusionRenderer.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return o});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("./externalModules.js"),t=e("./stateManagement/toolState.js"),o=function(){function s(){u()(this,s),this.currentImageIdIndex=0,this.layerIds=[],this.findImageFn=void 0}return v()(s,[{key:"render",value:function(a,i){var h=this;if(!Number.isInteger(this.currentImageIdIndex))throw new Error("FusionRenderer: render - Image ID Index is not an integer");if(!this.findImageFn)throw new Error("No findImage function has been defined");if(!i){var g=Object(t.getToolState)(a,"stack");i=g.data}var c=d.default.cornerstone,m=i[0],E=m.imageIds[this.currentImageIdIndex],T=i.slice(1,i.length);c.loadAndCacheImage(E).then(function(P){var M=h.layerIds[0];M?c.setLayerImage(a,P,M):(M=c.addLayer(a,P,m.options),h.layerIds.push(M)),c.displayImage(a,P),T.forEach(function(C,O){var I=h.findImageFn(C.imageIds,E),_=O+1,D=h.layerIds[_];D||(D=c.addLayer(a,void 0,C.options),h.layerIds.push(D)),I?c.loadAndCacheImage(I).then(function(L){c.setLayerImage(a,L,D),c.updateImage(a)}):(c.setLayerImage(a,void 0,D),c.setActiveLayer(a,M),c.updateImage(a))})})}}]),s}()},"./stackTools/playClip.js":function(H,n,e){e.r(n),e.d(n,"playClip",function(){return a}),e.d(n,"stopClip",function(){return i});var r=e("./events.js"),u=e("./externalModules.js"),f=e("./stateManagement/loadHandlerManager.js"),v=e("./stateManagement/toolState.js"),d=e("./util/triggerEvent.js"),t="playClip";function o(h,g){var c,m,E,T=0,P=h.length,M=[];for(M.isTimeVarying=!1,(typeof g!="number"||g<=0)&&(g=1),c=1;c<P;c++)E=Number(h[c])/g|0,M.push(E),c===1?m=E:E!==m&&(M.isTimeVarying=!0),T+=E;return M.length>0&&(M.isTimeVarying?E=T/M.length|0:E=M[0],M.push(E)),M}function s(h){var g=h.intervalId;typeof g<"u"&&(h.intervalId=void 0,h.usingFrameTimeVector?clearTimeout(g):clearInterval(g))}function l(h){var g={element:h};Object(d.default)(h,r.default.CLIP_STOPPED,g)}function a(h,g){var c,m;if(h===void 0)throw new Error("playClip: element must not be undefined");var E=Object(v.getToolState)(h,"stack");if(!(!E||!E.data||!E.data.length)){var T=u.default.cornerstone,P;if(E.data.length>1){var M=Object(v.getToolState)(h,"stackRenderer");M&&M.data&&M.data.length&&(P=M.data[0])}var C=E.data[0],O=Object(v.getToolState)(h,t);!O||!O.data||!O.data.length?(c={intervalId:void 0,framesPerSecond:30,lastFrameTimeStamp:void 0,frameRate:0,frameTimeVector:void 0,ignoreFrameTimeVector:!1,usingFrameTimeVector:!1,speed:1,reverse:!1,loop:!0},Object(v.addToolState)(h,t,c)):(c=O.data[0],s(c)),(g<0||g>0)&&(c.framesPerSecond=Number(g),c.reverse=c.framesPerSecond<0,c.ignoreFrameTimeVector=!0),c.ignoreFrameTimeVector!==!0&&c.frameTimeVector&&c.frameTimeVector.length===C.imageIds.length&&(m=o(c.frameTimeVector,c.speed));var I=function(){var D,L,S,A,U=C.currentImageIdIndex,B=C.imageIds.length;if(c.reverse?U--:U++,!c.loop&&(U<0||U>=B)){s(c),l(h);return}U>=B&&(U=0),U<0&&(U=B-1),U!==C.currentImageIdIndex&&(L=f.default.getStartLoadHandler(h),S=f.default.getEndLoadHandler(h),A=f.default.getErrorLoadingHandler(h),L&&L(h),C.preventCache===!0?D=T.loadImage(C.imageIds[U]):D=T.loadAndCacheImage(C.imageIds[U]),D.then(function(b){try{C.currentImageIdIndex=U,P?(P.currentImageIdIndex=U,P.render(h,E.data)):T.displayImage(h,b),S&&S(h,b)}catch{return}},function(b){var y=C.imageIds[U];A&&A(h,y,b)}))};m&&m.length>0&&m.isTimeVarying?(c.usingFrameTimeVector=!0,c.intervalId=setTimeout(function _(){c.intervalId=setTimeout(_,m[C.currentImageIdIndex]),I()},0)):(c.usingFrameTimeVector=!1,c.intervalId=setInterval(I,1e3/Math.abs(c.framesPerSecond)))}}function i(h){var g=Object(v.getToolState)(h,t);!g||!g.data||!g.data.length||s(g.data[0])}},"./stackTools/stackPrefetch.js":function(H,n,e){e.r(n);var r=e("./externalModules.js"),u=e("./stateManagement/loadHandlerManager.js"),f=e("./stateManagement/toolState.js"),v=e("./util/logger.js");e("./util/triggerEvent.js"),e("./events.js");var d=Object(v.getLogger)("stackTools:stackPrefetch"),t="stackPrefetch",o="prefetch",s=0,l=!0,a={maxImagesToPrefetch:1/0,preserveExistingPool:!1},i,h=10;function g(_,D){_=Math.round(_)||0,D=Math.round(D)||0;var L=[],S=D-_+1;if(S<=0)return L;for(;S--;)L[S]=D--;return L}function c(_,D){var L=0,S=_.length-1;return _.forEach(function(A,U){A<D?L=Math.max(U,L):A>D&&(S=Math.min(U,S))}),{low:L,high:S}}function m(_){var D=Object(f.getToolState)(_,"stack");if(!D||!D.data||!D.data.length)return;var L=D.data[0],S=Object(f.getToolState)(_,t);if(!S)return;var A=S.data[0]||{};if((!A.indicesToRequest||!A.indicesToRequest.length)&&(A.enabled=!1),A.enabled===!1)return;function U(te){var ne=A.indicesToRequest.indexOf(te);ne>-1&&A.indicesToRequest.splice(ne,1)}S.data[0].indicesToRequest.sort(function(te,ne){return te-ne});var B=A.indicesToRequest.slice();if(B.forEach(function(te){var ne=L.imageIds[te];if(ne){var de=r.default.cornerstone.imageCache.getImageLoadObject(ne);de&&U(te)}}),!!A.indicesToRequest.length){a.preserveExistingPool||r.default.cornerstone.imageLoadPoolManager.clearRequestStack(o);var b=c(A.indicesToRequest,L.currentImageIdIndex),y,x;u.default.getErrorLoadingHandler(_);for(var j=b.low,p=b.high,R=[];j>=0||p<A.indicesToRequest.length;){var W=L.currentImageIdIndex,K=W-A.indicesToRequest[j]>a.maxImagesToPrefetch,N=A.indicesToRequest[p]-W>a.maxImagesToPrefetch,z=!K&&j>=0,Y=!N&&p<A.indicesToRequest.length;if(!Y&&!z)break;z&&(x=A.indicesToRequest[j--],y=L.imageIds[x],R.push(y)),Y&&(x=A.indicesToRequest[p++],y=L.imageIds[x],R.push(y))}var $,J={addToBeginning:l,priority:s,requestType:o};$=function(ne){return r.default.cornerstone.loadAndCacheImage(ne,J)},R.reverse().forEach(function(te){r.default.cornerstone.imageLoadPoolManager.addRequest($.bind(null,te),o,{imageId:te},s,l)})}}function E(_){return function(D){var L=D.detail,S;try{S=Object(f.getToolState)(_,"stack")}catch{return}if(!(!S||!S.data||!S.data.length)){var A=S.data[0],U=A.imageIds.indexOf(L.imageId);if(!(U<0)){var B=Object(f.getToolState)(_,t);!B||!B.data||!B.data.length||B.data[0].indicesToRequest.push(U)}}}}function T(_){clearTimeout(i),i=setTimeout(function(){var D=_.target;try{m(D)}catch{return}},h)}function P(_){var D=Object(f.getToolState)(_,t);D.data=[];var L=Object(f.getToolState)(_,"stack");if(!(!L||!L.data||!L.data.length)){var S=L.data[0];if(S.preventCache===!0){d.warn("A stack that should not be cached was given the stackPrefetch");return}var A={indicesToRequest:g(0,S.imageIds.length-1),enabled:!0,direction:1},U=A.indicesToRequest.indexOf(S.currentImageIdIndex);A.indicesToRequest.splice(U,1),Object(f.addToolState)(_,t,A),m(_),_.removeEventListener(r.default.cornerstone.EVENTS.NEW_IMAGE,T),_.addEventListener(r.default.cornerstone.EVENTS.NEW_IMAGE,T);var B=E(_);r.default.cornerstone.events.removeEventListener(r.default.cornerstone.EVENTS.IMAGE_CACHE_PROMISE_REMOVED,B),r.default.cornerstone.events.addEventListener(r.default.cornerstone.EVENTS.IMAGE_CACHE_PROMISE_REMOVED,B)}}function M(_){clearTimeout(i),_.removeEventListener(r.default.cornerstone.EVENTS.NEW_IMAGE,T);var D=E(_);r.default.cornerstone.events.removeEventListener(r.default.cornerstone.EVENTS.IMAGE_CACHE_PROMISE_REMOVED,D);var L=Object(f.getToolState)(_,t);L&&L.data.length&&(L.data[0].enabled=!1,r.default.cornerstone.imageLoadPoolManager.clearRequestStack(o))}function C(){return a}function O(_){a=_}var I={enable:P,disable:M,getConfiguration:C,setConfiguration:O};n.default=I},"./stackTools/stackRenderers.js":function(H,n,e){e.r(n);var r=e("./stackTools/fusionRenderer.js"),u={};u.FusionRenderer=r.default,n.default=u},"./stateManagement/frameOfReferenceStateManager.js":function(H,n,e){e.r(n),e.d(n,"newFrameOfReferenceSpecificToolStateManager",function(){return r}),e.d(n,"globalFrameOfReferenceSpecificToolStateManager",function(){return u});function r(){var f={};function v(o,s,l){f.hasOwnProperty(o)===!1&&(f[o]={});var a=f[o];a.hasOwnProperty(s)===!1&&(a[s]={data:[]});var i=a[s];i.data.push(l)}function d(o,s){if(f.hasOwnProperty(o)!==!1){var l=f[o];if(l.hasOwnProperty(s)!==!1){var a=l[s];return a}}}function t(o,s,l){if(f.hasOwnProperty(o)!==!1){var a=f[o];if(a.hasOwnProperty(s)!==!1){for(var i=a[s],h=-1,g=0;g<i.data.length;g++)i.data[g]===l&&(h=g);h!==-1&&i.data.splice(h,1)}}}return{get:d,add:v,remove:t}}var u=r()},"./stateManagement/imageIdSpecificStateManager.js":function(H,n,e){e.r(n),e.d(n,"newImageIdSpecificToolStateManager",function(){return u}),e.d(n,"globalImageIdSpecificToolStateManager",function(){return f});var r=e("./externalModules.js");function u(){var v={};function d(T){return v[T]}function t(T,P){v[T]=P}function o(){return v}function s(T){v=T}function l(T,P,M){var C=r.default.cornerstone.getEnabledElement(T);C.image&&a(C.image.imageId,P,M)}function a(T,P,M){v.hasOwnProperty(T)===!1&&(v[T]={});var C=v[T];C.hasOwnProperty(P)===!1&&(C[P]={data:[]});var O=C[P];O.data.push(M)}function i(T,P){var M=r.default.cornerstone.getEnabledElement(T);if(M.image)return h(M.image.imageId,P)}function h(T,P){if(v.hasOwnProperty(T)!==!1){var M=v[T];if(M.hasOwnProperty(P)!==!1)return M[P]}}function g(T,P,M){var C=r.default.cornerstone.getEnabledElement(T);C.image&&c(C.image.imageId,P,M)}function c(T,P,M){var C=v[T];C[P]=M}function m(T){var P=r.default.cornerstone.getEnabledElement(T);P.image&&E(P.image.imageId)}function E(T){v.hasOwnProperty(T)!==!1&&delete v[T]}return{get:i,add:l,set:g,clear:m,getImageIdToolState:h,addImageIdToolState:a,setImageIdToolState:c,clearImageIdToolState:E,saveImageIdToolState:d,restoreImageIdToolState:t,saveToolState:o,restoreToolState:s,toolState:v}}var f=u()},"./stateManagement/loadHandlerManager.js":function(H,n,e){e.r(n);var r=e("./externalModules.js"),u="DEFAULT",f={},v={},d={};function t(m){if(!m)return u;var E=r.default.cornerstone.getEnabledElement(m).uuid;if(!E)throw new Error("Something went wrong when getting uuid from element");return E}function o(m){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;if(!m)throw new Error("The Handler function must be defined");var T=t(E);f[T]=m}function s(m){var E=t(m);return f[E]||f[u]}function l(m){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;if(!m)throw new Error("The Handler function must be defined");var T=t(E);v[T]=m}function a(m){var E=t(m);return v[E]||v[u]}function i(m){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;if(!m)throw new Error("The Handler function must be defined");var T=t(E);d[T]=m}function h(m){var E=t(m);return d[E]||d[u]}function g(m){var E=t(m);delete f[E],delete v[E],delete d[E]}var c={setStartLoadHandler:o,getStartLoadHandler:s,setEndLoadHandler:l,getEndLoadHandler:a,setErrorLoadingHandler:i,getErrorLoadingHandler:h,removeHandlers:g};n.default=c},"./stateManagement/stackSpecificStateManager.js":function(H,n,e){e.r(n),e.d(n,"stackSpecificStateManager",function(){return d}),e.d(n,"newStackSpecificToolStateManager",function(){return f}),e.d(n,"addStackStateManager",function(){return v});var r=e("./stateManagement/imageIdSpecificStateManager.js"),u=e("./stateManagement/toolState.js");function f(t,o){var s={};function l(){return s}function a(c){s=c}function i(c,m,E){if(t.indexOf(m)>=0){s.hasOwnProperty(m)===!1&&(s[m]={data:[]});var T=s[m];T.data.push(E)}else return o.add(c,m,E)}function h(c,m){return t.indexOf(m)>=0?(s.hasOwnProperty(m)===!1&&(s[m]={data:[]}),s[m]):o.get(c,m)}var g={get:h,add:i,saveToolState:l,restoreToolState:a,toolState:s};return g}function v(t,o){var s=Object(u.getElementToolStateManager)(t);s||(s=r.globalImageIdSpecificToolStateManager);var l=["stack","stackPrefetch","playClip","volume","slab","referenceLines","crosshairs","stackRenderer"];o&&(l=l.concat(o));var a=f(l,s);Object(u.setElementToolStateManager)(t,a)}var d={newStackSpecificToolStateManager:f,addStackStateManager:v}},"./stateManagement/textStyle.js":function(H,n,e){e.r(n);var r={fontSize:15,fontFamily:"Arial",backgroundColor:"transparent"};function u(i){var h=i.split("px ");h.length===2&&(t(parseFloat(h[0])),v(h[1]))}function f(){return"".concat(r.fontSize,"px ").concat(r.fontFamily)}function v(i){if(typeof i!="string")throw new Error("Font family must be a valid string");r.fontFamily=i}function d(){return r.fontFamily}function t(i){if(typeof i!="number"||isNaN(i)||!isFinite(i))throw new Error("Font size must be a valid number");r.fontSize=parseFloat(i)}function o(){return r.fontSize}function s(i){r.backgroundColor=i}function l(){return r.backgroundColor}var a={setFont:u,getFont:f,setFontSize:t,getFontSize:o,setFontFamily:v,getFontFamily:d,setBackgroundColor:s,getBackgroundColor:l};n.default=a},"./stateManagement/toolColors.js":function(H,n,e){e.r(n);var r="white",u="greenyellow",f="transparent";function v(h){f=h}function d(){return f}function t(h){r=h}function o(){return r}function s(h){u=h}function l(){return u}function a(h){return h.color?h.color:h.active?u:r}var i={setFillColor:v,getFillColor:d,setToolColor:t,getToolColor:o,setActiveColor:s,getActiveColor:l,getColorIfActive:a};n.default=i},"./stateManagement/toolCoordinates.js":function(H,n,e){e.r(n);var r;function u(d){r=d.currentPoints.canvas}function f(){return r}var v={setCoords:u,getCoords:f};n.default=v},"./stateManagement/toolState.js":function(H,n,e){e.r(n),e.d(n,"addToolState",function(){return o}),e.d(n,"getToolState",function(){return s}),e.d(n,"removeToolState",function(){return l}),e.d(n,"clearToolState",function(){return a}),e.d(n,"setElementToolStateManager",function(){return i}),e.d(n,"getElementToolStateManager",function(){return t});var r=e("./events.js"),u=e("./externalModules.js"),f=e("./stateManagement/imageIdSpecificStateManager.js"),v=e("./util/triggerEvent.js"),d=e("./util/uuidv4.js");function t(h){var g=u.default.cornerstone.getEnabledElement(h);return g.toolStateManager===void 0&&(g.toolStateManager=f.globalImageIdSpecificToolStateManager),g.toolStateManager}function o(h,g,c){var m=t(h);c.uuid=c.uuid||Object(d.default)(),m.add(h,g,c);var E=r.default.MEASUREMENT_ADDED,T={toolName:g,toolType:g,element:h,measurementData:c};Object(v.default)(h,E,T)}function s(h,g){var c=t(h);return c.get(h,g)}function l(h,g,c){var m=t(h),E=m.get(h,g);if(!(!E||!E.data||!E.data.length)){for(var T=-1,P=0;P<E.data.length;P++)E.data[P]===c&&(T=P);if(T!==-1){E.data.splice(T,1);var M=r.default.MEASUREMENT_REMOVED,C={toolName:g,toolType:g,element:h,measurementData:c};Object(v.default)(h,M,C)}}}function a(h,g){var c=t(h),m=c.get(h,g);m!==void 0&&(m.data=[])}function i(h,g){var c=u.default.cornerstone.getEnabledElement(h);c.toolStateManager=g}},"./stateManagement/toolStyle.js":function(H,n,e){e.r(n);var r=1,u=2;function f(s){r=s}function v(){return r}function d(s){u=s}function t(){return u}var o={setToolWidth:f,getToolWidth:v,setActiveWidth:d,getActiveWidth:t};n.default=o},"./store/addTool.js":function(H,n,e){e.r(n),e.d(n,"addTool",function(){return t}),e.d(n,"addToolForElement",function(){return d});var r=e("./store/index.js"),u=e("./store/getToolForElement.js"),f=e("./util/logger.js"),v=Object(f.getLogger)("addTool"),d=function(l,a,i){var h=new a(i),g=Object(u.default)(l,h.name);if(g){v.warn("%s has already been added to the target element",h.name);return}h.element=l,r.default.state.tools.push(h)},t=function(l,a){o(l,a),r.default.state.enabledElements.forEach(function(i){d(i,l,a)})},o=function(l,a){var i=Object(r.getModule)("globalConfiguration"),h=i.configuration;if(h.globalToolSyncEnabled){var g=new l(a),c=r.default.state.globalTools[g.name]!==void 0;if(c){v.warn("%s has already been added globally",g.name);return}r.default.state.globalTools[g.name]={tool:l,props:a,activeBindings:[]}}}},"./store/filterToolsUsableWithMultiPartTools.js":function(H,n,e){e.r(n);var r=e("./tools/base/BaseAnnotationTool.js"),u=e("./tools/base/BaseBrushTool.js");n.default=function(f){return f.filter(function(v){return!v.isMultiPartTool&&!(v instanceof r.default)&&!(v instanceof u.default)})}},"./store/getActiveToolsForElement.js":function(H,n,e){e.r(n),n.default=function(r,u,f){return u.filter(function(v){return v.element===r&&v.mode==="active"&&(f===void 0||v.options["is".concat(f,"Active")])})}},"./store/getInteractiveToolsForElement.js":function(H,n,e){e.r(n),n.default=function(r,u){return u.filter(function(f){return f.element===r&&(f.mode==="active"||f.mode==="passive")})}},"./store/getToolForElement.js":function(H,n,e){e.r(n);var r=e("./store/index.js");n.default=function(u,f){return r.state.tools.find(function(v){return v.element===u&&v.name===f})}},"./store/getToolsWithDataForElement.js":function(H,n,e){e.r(n);var r=e("./stateManagement/toolState.js");n.default=function(u,f){return f.filter(function(v){var d=Object(r.getToolState)(u,v.name);return d&&d.data.length>0})}},"./store/getToolsWithMoveableHandles.js":function(H,n,e){e.r(n);var r=e("./stateManagement/toolState.js"),u=e("./manipulators/getHandleNearImagePoint.js"),f=e("./util/getProximityThreshold.js");n.default=function(v,d,t){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"mouse";return d.filter(function(s){for(var l=Object(f.default)(o,s.name),a=Object(r.getToolState)(v,s.name),i=0;i<a.data.length;i++)if(Object(u.default)(v,a.data[i].handles,t,l)!==void 0)return!0;return!1})}},"./store/index.js":function(H,n,e){e.r(n),e.d(n,"state",function(){return o}),e.d(n,"getters",function(){return s}),e.d(n,"modules",function(){return l}),e.d(n,"getModule",function(){return a});var r=e("./store/modules/segmentationModule/index.js"),u=e("./store/modules/manipulatorStateModule.js"),f=e("./store/modules/cursorModule.js"),v=e("./store/modules/globalConfigurationModule.js"),d=e("./externalModules.js"),t=e("./util/logger.js");Object(t.getLogger)("store:modules:storeLogger");var o={globalTools:{},globalToolChangeHistory:[],enabledElements:[],tools:[],isToolLocked:!1,activeMultiPartTool:null,mousePositionImage:{},clickProximity:6,touchProximity:10,handleRadius:6,deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:!1,preventTextBoxOutsideDisplayedArea:!1,handleTouchOffset:{x:0,y:-57},svgCursorUrl:null},s={mouseTools:function(){return o.tools.filter(function(h){return h.supportedInteractionTypes.includes("Mouse")})},touchTools:function(){return o.tools.filter(function(h){return h.supportedInteractionTypes.includes("Touch")})},enabledElementByUID:function(h){return o.enabledElements.find(function(g){return d.default.cornerstone.getEnabledElement(g).uuid===h})}},l={segmentation:r.default,cursor:f.default,globalConfiguration:v.default,manipulatorState:u.default};function a(i){return l[i]}n.default={modules:l,state:o,getters:s}},"./store/internals/addEnabledElement.js":function(H,n,e){e.r(n);var r=e("./eventListeners/index.js"),u=e("./eventDispatchers/index.js"),f=e("./store/addTool.js"),v=e("./store/setToolMode.js"),d=e("./store/index.js"),t=e("./util/logger.js"),o=Object(t.getLogger)("internals:addEnabledElement");n.default=function(h){o.log("EVENT:ELEMENT_ENABLED");var g=h.detail.element;u.imageRenderedEventDispatcher.enable(g),u.newImageEventDispatcher.enable(g);var c=Object(d.getModule)("globalConfiguration"),m=c.configuration;m.mouseEnabled&&(r.mouseEventListeners.enable(g),r.wheelEventListener.enable(g),u.mouseToolEventDispatcher.enable(g)),m.touchEnabled&&(r.touchEventListeners.enable(g),u.touchToolEventDispatcher.enable(g)),s(g)};var s=function(g){d.default.state.enabledElements.push(g),d.default.modules&&l(g),a(g),i(g)};function l(h){var g=d.default.modules;Object.keys(g).forEach(function(c){typeof g[c].enabledElementCallback=="function"&&g[c].enabledElementCallback(h)})}function a(h){var g=Object(d.getModule)("globalConfiguration"),c=g.configuration;c.globalToolSyncEnabled&&Object.keys(d.default.state.globalTools).forEach(function(m){var E=d.default.state.globalTools[m],T=E.tool,P=E.props;Object(f.addToolForElement)(h,T,P)})}function i(h){var g=Object(d.getModule)("globalConfiguration"),c=g.configuration;if(c.globalToolSyncEnabled){var m={active:v.setToolActiveForElement,passive:v.setToolPassiveForElement,enabled:v.setToolEnabledForElement,disabled:v.setToolDisabledForElement};d.default.state.globalToolChangeHistory.forEach(function(E){var T=E.args.slice(0);T.unshift(h),m[E.mode].apply(null,T)})}}},"./store/internals/removeEnabledElement.js":function(H,n,e){e.r(n);var r=e("./eventListeners/index.js"),u=e("./eventDispatchers/index.js"),f=e("./store/index.js"),v=e("./util/logger.js"),d=e("./stateManagement/loadHandlerManager.js"),t=e("./store/setToolMode.js"),o=Object(v.getLogger)("internals:removeEnabledElement");n.default=function(h){o.log("EVENT:ELEMENT_DISABLED");var g=h.detail.element,c=Object(f.getModule)("globalConfiguration"),m=c.configuration;u.imageRenderedEventDispatcher.disable(g),u.newImageEventDispatcher.disable(g),m.mouseEnabled&&(r.mouseEventListeners.disable(g),r.wheelEventListener.disable(g),u.mouseToolEventDispatcher.disable(g)),m.touchEnabled&&(r.touchEventListeners.disable(g),u.touchToolEventDispatcher.disable(g)),s(g),l(g),a(g)};var s=function(g){f.default.state.tools.forEach(function(c){c.element===g&&Object(t.setToolDisabledForElement)(c.element,c.name)}),f.default.state.tools=f.default.state.tools.filter(function(c){return c.element!==g})},l=function(g){f.default.modules&&i(g);var c=f.default.state.enabledElements.findIndex(function(m){return m===g});c>-1?f.default.state.enabledElements.splice(c,1):o.warn("unable to remove element")},a=function(g){d.default.removeHandlers(g)};function i(h){var g=f.default.modules;Object.keys(g).forEach(function(c){typeof g[c].removeEnabledElementCallback=="function"&&g[c].removeEnabledElementCallback(h)})}},"./store/isToolActiveForElement.js":function(H,n,e){e.r(n);var r=e("./store/getToolForElement.js");n.default=function(u,f){var v=Object(r.default)(u,f);return v.mode==="active"}},"./store/modules/cursorModule.js":function(H,n,e){e.r(n),e("./externalModules.js");var r={iconSize:16,viewBox:{x:16,y:16},mousePoint:{x:8,y:8},mousePointerGroupString:`
    <path stroke="ACTIVE_COLOR" d="M8 16L8 0"></path>
    <path stroke="ACTIVE_COLOR" d="M16 8L0 8"></path>
  `},u={defaultOptions:function(d){Object.assign(r,d)}},f={defaultOptions:function(){return r}};n.default={configuration:r,getters:f,setters:u}},"./store/modules/globalConfigurationModule.js":function(H,n,e){e.r(n);var r={mouseEnabled:!0,touchEnabled:!0,globalToolSyncEnabled:!1,showSVGCursors:!1,autoResizeViewports:!0,lineDash:[4,4]};n.default={configuration:r}},"./store/modules/manipulatorStateModule.js":function(H,n,e){e.r(n);var r=e("./externalModules.js"),u={activeManipulators:{}};function f(i,h){var g=r.default.cornerstone.getEnabledElement(i),c=g.uuid;u.activeManipulators[c]=h}function v(i){var h=r.default.cornerstone.getEnabledElement(i),g=h.uuid,c=u.activeManipulators;delete c[g]}function d(i){var h=r.default.cornerstone.getEnabledElement(i),g=h.uuid;t(g)}function t(i){var h=u.activeManipulators,g=h[i];typeof g=="function"&&g(),delete h[i]}function o(){var i=u.activeManipulators;Object.keys(i).forEach(function(h){return t(h)})}function s(i){var h=i.detail,g=h.element;v(g)}function l(i){var h=r.default.cornerstone.EVENTS.NEW_IMAGE;i.removeEventListener(h,s),v(i)}function a(i){var h=r.default.cornerstone.EVENTS.NEW_IMAGE;i.removeEventListener(h,s),i.addEventListener(h,s)}n.default={setters:{addActiveManipulatorForElement:f,removeActiveManipulatorForElement:v,cancelActiveManipulatorsForElement:d,cancelActiveManipulators:o},state:u,enabledElementCallback:a,removeEnabledElementCallback:l}},"./store/modules/segmentationModule/activeLabelmapIndex.js":function(H,n,e){e.r(n),e.d(n,"getActiveLabelmapIndex",function(){return t}),e.d(n,"setActiveLabelmapIndex",function(){return o});var r=e("./store/modules/segmentationModule/getElement.js"),u=e("./stateManagement/toolState.js"),f=e("./store/modules/segmentationModule/addLabelmap3D.js"),v=e("./store/modules/segmentationModule/state.js"),d=e("./externalModules.js");function t(s){var l=Object(r.default)(s);if(l){var a=Object(u.getToolState)(l,"stack"),i=a.data[0],h=i.imageIds[0],g=v.default.series[h];if(g)return g.activeLabelmapIndex}}function o(s){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=Object(r.default)(s);if(a){var i=d.default.cornerstone,h=Object(u.getToolState)(a,"stack"),g=h.data[0],c=i.getEnabledElement(a),m=c.image,E=m.rows,T=m.columns,P=g.imageIds.length,M=E*T*P,C=g.imageIds[0],O=v.default.series[C];O?(O.activeLabelmapIndex=l,O.labelmaps3D[l]||Object(f.default)(O,l,M)):(v.default.series[C]={activeLabelmapIndex:l,labelmaps3D:[]},O=v.default.series[C],Object(f.default)(O,l,M)),i.updateImage(a)}}},"./store/modules/segmentationModule/activeSegmentIndex.js":function(H,n,e){e.r(n),e.d(n,"getActiveSegmentIndex",function(){return d}),e.d(n,"setActiveSegmentIndex",function(){return t}),e.d(n,"incrementActiveSegmentIndex",function(){return o}),e.d(n,"decrementActiveSegmentIndex",function(){return s});var r=e("./store/modules/segmentationModule/getElement.js"),u=e("./stateManagement/toolState.js"),f=e("./store/modules/segmentationModule/state.js"),v=e("./store/index.js");function d(a,i){var h=Object(r.default)(a);if(h){var g=Object(u.getToolState)(h,"stack"),c=g.data[0],m=c.imageIds[0],E=f.default.series[m];if(E){i=i===void 0?E.activeLabelmapIndex:i;var T=E.labelmaps3D[i];if(T)return T.activeSegmentIndex}return 1}}function t(a,i){var h=Object(r.default)(a);if(h){var g=Object(u.getToolState)(h,"stack"),c=g.data[0],m=c.imageIds[0],E=f.default.series[m];if(E){var T=E.activeLabelmapIndex,P=E.labelmaps3D[T],M=Object(v.getModule)("segmentation"),C=M.configuration;i<=0?i=1:i>C.segmentsPerLabelmap&&(i=C.segmentsPerLabelmap),P.activeSegmentIndex=i}}}function o(a){var i=Object(r.default)(a);i&&l(i,"increase")}function s(a){var i=Object(r.default)(a);i&&l(i,"decrease")}function l(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"increase",h=Object(v.getModule)("segmentation"),g=h.configuration,c=Object(u.getToolState)(a,"stack"),m=c.data[0],E=m.imageIds[0],T=f.default.series[E];if(T){var P=T.activeLabelmapIndex,M=T.labelmaps3D[P];switch(i){case"increase":M.activeSegmentIndex++,M.activeSegmentIndex>g.segmentsPerLabelmap&&(M.activeSegmentIndex=1);break;case"decrease":M.activeSegmentIndex--,M.activeSegmentIndex<=0&&(M.activeSegmentIndex=g.segmentsPerLabelmap);break}}}},"./store/modules/segmentationModule/addLabelmap2D.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return d});var r=e("./store/modules/segmentationModule/arrayTypes.js"),u=e("./store/index.js"),f=r.default.UINT_16_ARRAY,v=r.default.FLOAT_32_ARRAY;function d(t,o,s,l,a){var i=Object(u.getModule)("segmentation"),h=i.configuration,g=l*a,c=g*s,m;switch(h.arrayType){case f:m=new Uint16Array(t.labelmaps3D[o].buffer,c*2,g);break;case v:m=new Float32Array(t.labelmaps3D[o].buffer,c*4,g);break;default:throw new Error("Unsupported Array Type ".concat(h.arrayType))}t.labelmaps3D[o].labelmaps2D[s]={pixelData:m,segmentsOnLabelmap:[]}}},"./store/modules/segmentationModule/addLabelmap3D.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return d});var r=e("./store/modules/segmentationModule/arrayTypes.js"),u=e("./store/index.js"),f=r.default.UINT_16_ARRAY,v=r.default.FLOAT_32_ARRAY;function d(t,o,s){var l=Object(u.getModule)("segmentation"),a=l.configuration,i;switch(a.arrayType){case f:i=2;break;case v:i=4;break;default:throw new Error("Unsupported Array Type ".concat(a.arrayType))}t.labelmaps3D[o]={buffer:new ArrayBuffer(s*i),labelmaps2D:[],metadata:[],activeSegmentIndex:1,colorLUTIndex:0,segmentsHidden:[],undo:[],redo:[]}}},"./store/modules/segmentationModule/arrayTypes.js":function(H,n,e){e.r(n);var r={UINT_16_ARRAY:0,FLOAT_32_ARRAY:1};n.default=r},"./store/modules/segmentationModule/colorLUT.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return o}),e.d(n,"setColorLUTIndexForLabelmap3D",function(){return s}),e.d(n,"getColorForSegmentIndexColorLUT",function(){return l}),e.d(n,"setColorForSegmentIndexOfColorLUT",function(){return a}),e.d(n,"getColorLUT",function(){return i});var r=e("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),u=e.n(r),f=e("./util/logger.js"),v=e("./store/modules/segmentationModule/state.js"),d=e("./store/index.js"),t=Object(f.getLogger)("store:modules:segmentationModule:setColorLUT");function o(_){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],L=Object(d.getModule)("segmentation"),S=L.configuration,A=S.segmentsPerLabelmap;D?(h(D,A),D.length<A&&(D=[].concat(u()(D),u()(g(A-D.length))))):D=D||g(A),D.unshift([0,0,0,0]),v.default.colorLutTables[_]=D}function s(_,D){_.colorLUTIndex=D}function l(_,D){var L=i(_);return L[D]}function a(_,D,L){var S=i(_);S[D]=L}function i(_){return typeof _=="number"?v.default.colorLutTables[_]:v.default.colorLutTables[_.colorLUTIndex]}function h(_,D){_.length<D?t.warn("The provided colorLUT only provides ".concat(_.length," labels, whereas segmentsPerLabelmap is set to ").concat(D,". Autogenerating the rest.")):_.length>D&&t.warn("segmentsPerLabelmap is set to ".concat(D,", and the provided colorLUT provides ").concat(_.length,". Using the first ").concat(D," colors from the LUT."))}function g(){for(var _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:255,D=[],L=0;L<_;L++)D.push(I(E(),O()));return D}var c=137.5,m=222.5;function E(){return m+=c,m>=360&&(m-=360),m}var T=.6,P=.82,M=.3,C=.07;function O(){if(T+=C,T>P){var _=T-P;T=M+_}return T}function I(_){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,L=arguments.length>2&&arguments[2]!==void 0?arguments[2]:.6,S=arguments.length>3&&arguments[3]!==void 0?arguments[3]:255,A=(1-Math.abs(2*L-1))*D,U=A*(1-Math.abs(_/60%2-1)),B=L-A/2,b,y,x;return _<60?(b=A,y=U,x=0):_<120?(b=U,y=A,x=0):_<180?(b=0,y=A,x=U):_<240?(b=0,y=U,x=A):_<300?(b=U,y=0,x=A):_<360&&(b=A,y=0,x=U),[(b+B)*255,(y+B)*255,(x+B)*255,S]}},"./store/modules/segmentationModule/defaultConfiguration.js":function(H,n,e){e.r(n);var r=e("./store/modules/segmentationModule/arrayTypes.js"),u=r.default.UINT_16_ARRAY,f={renderOutline:!0,renderFill:!0,shouldRenderInactiveLabelmaps:!0,radius:10,minRadius:1,maxRadius:50,fillAlpha:.2,fillAlphaInactive:.1,outlineAlpha:.7,outlineAlphaInactive:.35,outlineWidth:3,storeHistory:!0,segmentsPerLabelmap:65535,arrayType:u};n.default=f},"./store/modules/segmentationModule/deleteSegment.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return d});var r=e("./store/modules/segmentationModule/getElement.js"),u=e("./stateManagement/toolState.js"),f=e("./store/modules/segmentationModule/state.js"),v=e("./externalModules.js");function d(t,o,s){if(o){var l=Object(r.default)(t);if(l){var a=Object(u.getToolState)(l,"stack"),i=a.data[0],h=i.imageIds[0],g=f.default.series[h];if(g){s=s===void 0?g.activeLabelmapIndex:s;var c=g.labelmaps3D[s];if(c){delete c.metadata[o];for(var m=c.labelmaps2D,E=0;E<m.length;E++){var T=m[E];if(T&&T.segmentsOnLabelmap.includes(o)){var P=T.pixelData,M=T.segmentsOnLabelmap.indexOf(o);T.segmentsOnLabelmap.splice(M,1);for(var C=0;C<P.length;C++)P[C]===o&&(P[C]=0)}}v.default.cornerstone.updateImage(l)}}}}}},"./store/modules/segmentationModule/getBrushColor.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return t});var r=e("./stateManagement/toolState.js"),u=e("./store/modules/segmentationModule/state.js"),f=e("./store/modules/segmentationModule/getElement.js"),v=e("./util/logger.js"),d=Object(v.getLogger)("store:modules:segmentationModule:getBrushColor");function t(o){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=Object(f.default)(o);if(l){var a=Object(r.getToolState)(l,"stack");if(!a){d.error("Consumers must define stacks in their application if using segmentations in cornerstoneTools.");return}var i=a.data[0],h=i.imageIds[0],g=u.default.series[h],c;if(g){var m=g.activeLabelmapIndex,E=g.labelmaps3D[m],T=E.activeSegmentIndex;c=u.default.colorLutTables[E.colorLUTIndex][T]}else c=u.default.colorLutTables[0][1];return s?"rgba(".concat(c[0],", ").concat(c[1],", ").concat(c[2],", 1.0 )"):"rgba(".concat(c[0],", ").concat(c[1],", ").concat(c[2],", 0.8 )")}}},"./store/modules/segmentationModule/getElement.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return u});var r=e("./store/index.js");function u(f){return f instanceof HTMLElement?f:r.getters.enabledElementByUID(f)}},"./store/modules/segmentationModule/getLabelmap2D.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return c}),e.d(n,"getLabelmap2DByImageIdIndex",function(){return m});var r=e("./store/modules/segmentationModule/getElement.js"),u=e("./stateManagement/toolState.js"),f=e("./store/modules/segmentationModule/getSegmentsOnPixeldata.js"),v=e("./store/modules/segmentationModule/addLabelmap3D.js"),d=e("./store/modules/segmentationModule/addLabelmap2D.js"),t=e("./externalModules.js"),o=e("./store/modules/segmentationModule/state.js"),s=e("./store/modules/segmentationModule/arrayTypes.js"),l=e("./store/index.js"),a=e("./util/logger.js"),i=s.default.UINT_16_ARRAY,h=s.default.FLOAT_32_ARRAY,g=Object(a.getLogger)("store:modules:segmentationModule:getLabelmap2D");function c(E){var T=Object(r.default)(E);if(T){var P=t.default.cornerstone,M=Object(u.getToolState)(T,"stack");if(!M){g.error("Consumers must define stacks in their application if using segmentations in cornerstoneTools.");return}var C=M.data[0],O=P.getEnabledElement(T),I=C.currentImageIdIndex,_=O.image,D=_.rows,L=_.columns,S=C.imageIds.length,A=C.imageIds[0],U=o.default.series[A],B;if(U){if(B=U.activeLabelmapIndex,!U.labelmaps3D[B]){var b=D*L*S;Object(v.default)(U,B,b)}U.labelmaps3D[B].labelmaps2D[I]||Object(d.default)(U,B,I,D,L)}else{B=0,o.default.series[A]={activeLabelmapIndex:B,labelmaps3D:[]},U=o.default.series[A];var y=D*L*S;Object(v.default)(U,B,y),Object(d.default)(U,B,I,D,L)}var x=U.labelmaps3D[B];return{labelmap2D:x.labelmaps2D[I],labelmap3D:x,currentImageIdIndex:I,activeLabelmapIndex:B}}}function m(E,T,P,M){if(!E.labelmaps2D[T]){var C=Object(l.getModule)("segmentation"),O=C.configuration,I=P*M,_=I*T,D;switch(O.arrayType){case i:D=new Uint16Array(E.buffer,_*2,I);break;case h:D=new Float32Array(E.buffer,_*4,I);break;default:throw new Error("Unsupported Array Type ".concat(O.arrayType))}E.labelmaps2D[T]={pixelData:D,segmentsOnLabelmap:Object(f.default)(D)}}return E.labelmaps2D[T]}},"./store/modules/segmentationModule/getLabelmapBuffers.js":function(H,n,e){e.r(n),e.d(n,"getLabelmapBuffers",function(){return l}),e.d(n,"getActiveLabelmapBuffer",function(){return a});var r=e("./store/modules/segmentationModule/getElement.js"),u=e("./stateManagement/toolState.js"),f=e("./store/modules/segmentationModule/getLabelmaps3D.js"),v=e("./store/modules/segmentationModule/state.js"),d=e("./store/modules/segmentationModule/arrayTypes.js"),t=e("./store/index.js"),o=d.default.UINT_16_ARRAY,s=d.default.FLOAT_32_ARRAY;function l(i,h){var g=Object(r.default)(i);if(g){var c=Object(f.default)(g),m=c.labelmaps3D;if(!m)return[];var E=Object(t.getModule)("segmentation"),T=E.configuration,P,M;switch(T.arrayType){case o:P="Uint16Array",M="2";break;case s:P="Float32Array",M="4";break;default:throw new Error("Unsupported Array Type ".concat(T.arrayType))}var C=v.default.colorLutTables;if(h!==void 0){var O=m[h];return O?{labelmapIndex:h,bytesPerVoxel:M,type:P,buffer:O.buffer,colorLUT:C[O.colorLUTIndex]}:void 0}for(var I=[],_=0;_<m.length;_++){var D=m[_];D&&I.push({labelmapIndex:_,bytesPerVoxel:2,buffer:D.buffer,colorLUT:C[D.colorLUTIndex]})}return I}}function a(i){var h=Object(r.default)(i);if(h){var g=Object(u.getToolState)(h,"stack"),c=g.data[0].imageIds,m=c[0],E=v.default.series[m];if(E){var T=E.activeLabelmapIndex;return l(h,T)}}}},"./store/modules/segmentationModule/getLabelmapStats.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return o}),e.d(n,"_calculateLabelmapStats",function(){return l});var r=e("./store/modules/segmentationModule/getElement.js"),u=e("./stateManagement/toolState.js"),f=e("./store/modules/segmentationModule/state.js"),v=e("./externalModules.js"),d=e("./util/logger.js"),t=Object(d.getLogger)("store:modules:segmentationModule:getLabelmapStats");function o(g,c,m){var E=v.default.cornerstone,T=Object(r.default)(g);if(!T)return null;var P=Object(u.getToolState)(T,"stack"),M=P.data[0].imageIds,C=M[0];return new Promise(function(O){var I=f.default.series[C];I||O(null);var _=s(M),D=_.sufficientMetadata,L=_.imagePlanes;D||(t.warn("Insufficient imagePlaneModule information to calculate volume statistics."),O(null)),m=m===void 0?I.activeLabelmapIndex:m;for(var S=I.labelmaps3D[m],A=[],U=0;U<M.length;U++)A.push(E.loadAndCacheImage(M[U]));Promise.all(A).then(function(B){var b=l(S,B,L,c);O(b)})})}function s(g){for(var c=[],m=v.default.cornerstone,E=m.metaData,T=!0,P=0;P<g.length;P++){var M=E.get("imagePlaneModule",g[P]);if(!M){T=!1;break}c.push(M)}return{sufficientMetadata:T,imagePlanes:c}}function l(g,c,m,E){for(var T=a(g,c,m,E),P=0,M=T[0].values[0],C=M,O=0,I=0;I<T.length;I++){var _=T[I],D=_.values,L=_.voxelInMM3;O+=L*D.length;var S=0;D.forEach(function(y){y>M?M=y:y<C&&(C=y),S+=y}),P+=S*L}P/=O;for(var A=0,U=0;U<T.length;U++){var B=T[U],D=B.values,L=B.voxelInMM3,b=0;D.forEach(function(j){b+=Math.pow(j-P,2)}),A+=b*L}return A/=O,A=Math.sqrt(A),{volume:O,mean:P,stdDev:A,max:M,min:C}}function a(g,c,m,E){for(var T=c[0],P=T.rowPixelSpacing,M=T.columnPixelSpacing,C=g.labelmaps2D,O=[],I=0;I<C.length;I++){var _=C[I];if(_&&_.segmentsOnLabelmap.includes(E)){for(var D=i(c,m,I),L=D*P*M,S=_.pixelData,A=c[I].getPixelData(),U=[],B=0;B<S.length;B++)S[B]===E&&U.push(A[B]);O.push({voxelInMM3:L,values:U})}}return O}function i(g,c,m){var E=g.length,T=c[m].imagePositionPatient;if(m===0){var P=c[m+1].imagePositionPatient;return h(T,P)}else if(m===E-1){var M=c[m-1].imagePositionPatient;return h(T,M)}var C=c[m-1].imagePositionPatient,O=c[m+1].imagePositionPatient;return(h(T,C)+h(T,O))/2}function h(g,c){return Math.sqrt(Math.pow(g[0]-c[0],2)+Math.pow(g[1]-c[1],2)+Math.pow(g[2]-c[2],2))}},"./store/modules/segmentationModule/getLabelmaps3D.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return t}),e.d(n,"getLabelmap3D",function(){return o});var r=e("./stateManagement/toolState.js"),u=e("./store/modules/segmentationModule/getElement.js"),f=e("./store/modules/segmentationModule/state.js"),v=e("./util/logger.js"),d=Object(v.getLogger)("store:modules:segmentationModule:getLabelmaps3D");function t(s){var l=Object(u.default)(s);if(l){var a=Object(r.getToolState)(l,"stack");if(!a){d.error("Consumers must define stacks in their application if using segmentations in cornerstoneTools.");return}var i=a.data[0],h=i.imageIds[0],g=f.default.series[h],c,m;return g&&(c=g.labelmaps3D,m=g.activeLabelmapIndex),{labelmaps3D:c,activeLabelmapIndex:m,currentImageIdIndex:i.currentImageIdIndex}}}function o(s,l){var a=t(s),i=a.labelmaps3D,h=a.activeLabelmapIndex;return l=l!==void 0?l:h,i[l]}},"./store/modules/segmentationModule/getSegmentOfActiveLabelmapAtEvent.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return t});var r=e("./stateManagement/toolState.js"),u=e("./store/modules/segmentationModule/state.js"),f=e("./util/isPointInImage.js"),v=e("./util/logger.js"),d=Object(v.getLogger)("store:modules:segmentationModule:getSegmentOfActiveLabelmapAtEvent");function t(o){var s=o.detail,l=s.element,a=s.image,i=s.currentPoints;if(!i){d.warn("Not a cornerstone input event.");return}var h=a.width,g=a.height;if(l){var c=Object(r.getToolState)(l,"stack"),m=c.data[0],E=m.currentImageIdIndex,T=m.imageIds[0],P=u.default.series[T],M=P.activeLabelmapIndex,C=P.labelmaps3D[M];if(C){var O=C.labelmaps2D[E];if(O){var I=O.pixelData,_=i.image,D=_.x,L=_.y;if(D=Math.floor(D),L=Math.floor(L),Object(f.default)({x:D,y:L},g,h)){var S=I[L*h+D];return S===0?void 0:{segmentIndex:S,metadata:C.metadata[S]}}}}}}},"./store/modules/segmentationModule/getSegmentsOnPixeldata.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return f});var r=e("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),u=e.n(r);function f(v){return u()(new Set(v))}},"./store/modules/segmentationModule/history.js":function(H,n,e){e.r(n),e.d(n,"pushState",function(){return d}),e.d(n,"undo",function(){return t}),e.d(n,"redo",function(){return o});var r=e("./store/modules/segmentationModule/getLabelmaps3D.js"),u=e("./util/logger.js"),f=e("./externalModules.js"),v=Object(u.getLogger)("util:segmentation:labelmap3DHistory");function d(l,a,i){var h=Object(r.getLabelmap3D)(l,i);h.undo.push(a),h.redo=[]}function t(l,a){var i=Object(r.getLabelmap3D)(l,a),h=i.undo,g=i.redo;if(!h.length){v.warn("No undos left.");return}var c=h.pop();s(i,c,1),g.push(c),f.default.cornerstone.updateImage(l)}function o(l,a){var i=Object(r.getLabelmap3D)(l,a),h=i.undo,g=i.redo;if(!g.length){v.warn("No redos left.");return}var c=g.pop();s(i,c,2),h.push(c),f.default.cornerstone.updateImage(l)}function s(l,a,i){var h=l.labelmaps2D;a.forEach(function(g){for(var c=g.imageIdIndex,m=g.diff,E=h[c],T=E.pixelData,P=0;P<m.length;P++){var M=m[P];T[M[0]]=M[i]}})}},"./store/modules/segmentationModule/index.js":function(H,n,e){e.r(n);var r=e("./store/modules/segmentationModule/metadata.js"),u=e("./store/modules/segmentationModule/activeLabelmapIndex.js"),f=e("./store/modules/segmentationModule/activeSegmentIndex.js"),v=e("./store/modules/segmentationModule/segmentVisibility.js"),d=e("./store/modules/segmentationModule/getLabelmapBuffers.js"),t=e("./store/modules/segmentationModule/setLabelmap3D.js"),o=e("./store/modules/segmentationModule/getLabelmapStats.js"),s=e("./store/modules/segmentationModule/getLabelmaps3D.js"),l=e("./store/modules/segmentationModule/getLabelmap2D.js"),a=e("./store/modules/segmentationModule/getSegmentOfActiveLabelmapAtEvent.js"),i=e("./store/modules/segmentationModule/colorLUT.js"),h=e("./store/modules/segmentationModule/getBrushColor.js"),g=e("./store/modules/segmentationModule/getSegmentsOnPixeldata.js"),c=e("./store/modules/segmentationModule/deleteSegment.js"),m=e("./store/modules/segmentationModule/state.js"),E=e("./store/modules/segmentationModule/defaultConfiguration.js"),T=e("./store/modules/segmentationModule/history.js"),P=e("./store/modules/segmentationModule/setRadius.js");function M(){Object(i.default)(0)}n.default={state:m.default,configuration:E.default,onRegisterCallback:M,getters:{metadata:r.getMetadata,labelmap3D:s.getLabelmap3D,labelmaps3D:s.default,activeLabelmapIndex:u.getActiveLabelmapIndex,activeSegmentIndex:f.getActiveSegmentIndex,isSegmentVisible:v.isSegmentVisible,labelmap2D:l.default,labelmap2DByImageIdIndex:l.getLabelmap2DByImageIdIndex,labelmapStats:o.default,segmentOfActiveLabelmapAtEvent:a.default,brushColor:h.default,labelmapBuffers:d.getLabelmapBuffers,activeLabelmapBuffer:d.getActiveLabelmapBuffer,colorLUT:i.getColorLUT,colorForSegmentIndexColorLUT:i.getColorForSegmentIndexColorLUT},setters:{metadata:r.setMetadata,labelmap3DForElement:t.setLabelmap3DForElement,labelmap3DByFirstImageId:t.setLabelmap3DByFirstImageId,incrementActiveSegmentIndex:f.incrementActiveSegmentIndex,decrementActiveSegmentIndex:f.decrementActiveSegmentIndex,activeSegmentIndex:f.setActiveSegmentIndex,toggleSegmentVisibility:v.toggleSegmentVisibility,updateSegmentsOnLabelmap2D:function(O){O.segmentsOnLabelmap=Object(g.default)(O.pixelData)},deleteSegment:c.default,colorLUT:i.default,colorLUTIndexForLabelmap3D:i.setColorLUTIndexForLabelmap3D,colorForSegmentIndexOfColorLUT:i.setColorForSegmentIndexOfColorLUT,activeLabelmapIndex:u.setActiveLabelmapIndex,radius:P.default,pushState:T.pushState,undo:T.undo,redo:T.redo}}},"./store/modules/segmentationModule/metadata.js":function(H,n,e){e.r(n),e.d(n,"getMetadata",function(){return s}),e.d(n,"setMetadata",function(){return l});var r=e("./store/modules/segmentationModule/getElement.js"),u=e("./store/modules/segmentationModule/addLabelmap3D.js"),f=e("./stateManagement/toolState.js"),v=e("./externalModules.js"),d=e("./util/logger.js"),t=e("./store/modules/segmentationModule/state.js"),o=Object(d.getLogger)("store:modules:segmentationModule:metadata");function s(a,i,h){var g=Object(r.default)(a);if(g){var c=Object(f.getToolState)(g,"stack"),m=c.data[0],E=m.imageIds[0],T=t.default.series[E];if(!T){o.warn("brushStackState is undefined");return}if(i=i===void 0?T.activeLabelmapIndex:i,!T.labelmaps3D[i]){o.warn("No labelmap3D of labelmap index ".concat(i," on stack."));return}var P=T.labelmaps3D[i];return h===void 0?P.metadata:P.metadata[h]}}function l(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,h=arguments.length>2?arguments[2]:void 0,g=arguments.length>3?arguments[3]:void 0,c=Object(r.default)(a);if(c){var m=v.default.cornerstone,E=Object(f.getToolState)(c,"stack"),T=E.data[0],P=T.imageIds[0],M=t.default.series[P];if(M||(t.default.series[P]={labelmapIndex:i,labelmaps3D:[]},M=t.default.series[P]),!M.labelmaps3D[i]){var C=m.getEnabledElement(c),O=C.image,I=O.rows,_=O.columns,D=T.imageIds.length,L=I*_*D;Object(u.default)(M,i,L)}var S=M.labelmaps3D[i];S.metadata[h]=g}}},"./store/modules/segmentationModule/segmentVisibility.js":function(H,n,e){e.r(n),e.d(n,"isSegmentVisible",function(){return t}),e.d(n,"toggleSegmentVisibility",function(){return o});var r=e("./store/modules/segmentationModule/getElement.js"),u=e("./stateManagement/toolState.js"),f=e("./store/modules/segmentationModule/state.js"),v=e("./util/logger.js"),d=Object(v.getLogger)("store:modules:segmentationModule:segmentVisibility");function t(s,l,a){if(l){var i=Object(r.default)(s);if(i){var h=Object(u.getToolState)(i,"stack"),g=h.data[0],c=g.imageIds[0],m=f.default.series[c];if(!m){d.warn("brushStackState is undefined");return}if(a=a===void 0?m.activeLabelmapIndex:a,!m.labelmaps3D[a]){d.warn("No labelmap3D of labelmap index ".concat(a," on stack."));return}var E=m.labelmaps3D[a],T=!E.segmentsHidden[l];return T}}}function o(s,l,a){if(l){var i=Object(r.default)(s);if(i){var h=Object(u.getToolState)(i,"stack"),g=h.data[0],c=g.imageIds[0],m=f.default.series[c];if(!m){d.warn("brushStackState is undefined");return}if(a=a===void 0?m.activeLabelmapIndex:a,!m.labelmaps3D[a]){d.warn("No labelmap3D of labelmap index ".concat(a," on stack."));return}var E=m.labelmaps3D[a],T=E.segmentsHidden;return T[l]=!T[l],!T[l]}}}},"./store/modules/segmentationModule/setLabelmap3D.js":function(H,n,e){e.r(n),e.d(n,"setLabelmap3DByFirstImageId",function(){return i}),e.d(n,"setLabelmap3DForElement",function(){return a});var r=e("./store/modules/segmentationModule/getElement.js"),u=e("./stateManagement/toolState.js"),f=e("./store/modules/segmentationModule/state.js"),v=e("./store/modules/segmentationModule/getSegmentsOnPixeldata.js"),d=e("./util/segmentation/index.js"),t=e("./store/modules/segmentationModule/arrayTypes.js"),o=e("./store/index.js"),s=t.default.UINT_16_ARRAY,l=t.default.FLOAT_32_ARRAY;function a(h,g,c){var m=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[],E=arguments.length>4?arguments[4]:void 0,T=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0,P=Object(r.default)(h);if(P){var M=Object(u.getToolState)(P,"stack"),C=M.data[0].imageIds.length,O=M.data[0].imageIds[0];i(O,g,c,m,C,E,T),Object(d.triggerLabelmapModifiedEvent)(P,c)}}function i(h,g,c){var m=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[],E=arguments.length>4?arguments[4]:void 0,T=arguments.length>5?arguments[5]:void 0,P=arguments.length>6&&arguments[6]!==void 0?arguments[6]:0,M=Object(o.getModule)("segmentation"),C=M.configuration,O=f.default.series[h];O||(f.default.series[h]={activeLabelmapIndex:c,labelmaps3D:[]},O=f.default.series[h]),O.labelmaps3D[c]={buffer:g,labelmaps2D:[],metadata:m,activeSegmentIndex:1,colorLUTIndex:P,segmentsHidden:[],undo:[],redo:[]};for(var I=O.labelmaps3D[c].labelmaps2D,_=g.byteLength/E,D=0;D<E;D++){var L=void 0;switch(C.arrayType){case s:L=new Uint16Array(g,_*D,_/2);break;case l:L=new Float32Array(g,_*D,_/4);break;default:throw new Error("Unsupported Array Type ".concat(C.arrayType))}var S=T?T[D]:Object(v.default)(L);S&&S.some(function(A){return A})&&(I[D]={pixelData:L,segmentsOnLabelmap:S})}}},"./store/modules/segmentationModule/setRadius.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return u});var r=e("./store/index.js");function u(f){var v=Object(r.getModule)("segmentation"),d=v.configuration;d.radius=Math.min(Math.max(f,d.minRadius),d.maxRadius)}},"./store/modules/segmentationModule/state.js":function(H,n,e){e.r(n);var r={series:{},colorLutTables:[]};n.default=r},"./store/removeTool.js":function(H,n,e){e.r(n),e.d(n,"removeTool",function(){return f}),e.d(n,"removeToolForElement",function(){return u});var r=e("./store/index.js"),u=function(t,o){var s=r.default.state.tools.findIndex(function(l){return l.element===t&&l.name===o});s>=0&&r.default.state.tools.splice(s,1)},f=function(t){v(t),r.default.state.enabledElements.forEach(function(o){u(o,t)})},v=function(t){var o=Object(r.getModule)("globalConfiguration"),s=o.configuration;s.globalToolSyncEnabled&&r.default.state.globalTools[t]&&delete r.default.state.globalTools[t]}},"./store/setToolCursor.js":function(H,n,e){e.r(n),e.d(n,"setToolCursor",function(){return f}),e.d(n,"resetToolCursor",function(){return v}),e.d(n,"hideToolCursor",function(){return d});var r=e("./store/index.js"),u=r.modules.globalConfiguration;function f(o,s){if(u.configuration.showSVGCursors){var l=s.getIconWithPointerSVG(),a=s.mousePoint,i=window.URL.createObjectURL(l);o.style.cursor="url('".concat(i,"') ").concat(a,", auto"),r.state.svgCursorUrl=i}}function v(o){t(o,"initial")}function d(o){u.configuration.showSVGCursors&&t(o,"none")}function t(o,s){r.state.svgCursorUrl&&window.URL.revokeObjectURL(r.state.svgCursorUrl),r.state.svgCursorUrl=null,o.style.cursor=s}},"./store/setToolMode.js":function(H,n,e){e.r(n),e.d(n,"setToolActive",function(){return i}),e.d(n,"setToolActiveForElement",function(){return l}),e.d(n,"setToolDisabled",function(){return g}),e.d(n,"setToolDisabledForElement",function(){return h}),e.d(n,"setToolEnabled",function(){return m}),e.d(n,"setToolEnabledForElement",function(){return c}),e.d(n,"setToolPassive",function(){return T}),e.d(n,"setToolPassiveForElement",function(){return E}),e.d(n,"setToolMode",function(){return M}),e.d(n,"setToolModeForElement",function(){return P}),e.d(n,"_getNormalizedOptions",function(){return U}),e.d(n,"_mergeMouseButtonMask",function(){return B});var r=e("./events.js"),u=e("./util/triggerEvent.js"),f=e("./store/getToolForElement.js"),v=e("./store/setToolCursor.js"),d=e("./util/logger.js"),t=e("./store/index.js"),o=Object(t.getModule)("globalConfiguration"),s=Object(d.getLogger)("store:setToolMode"),l=function(y,x,j,p){p===void 0&&Array.isArray(j)&&(p=j,j=null);var R=Object(f.default)(y,x);R&&(C(y,R,j,p),R.supportedInteractionTypes.forEach(function(W){p===void 0||p.includes(W)?j["is".concat(W,"Active")]=!0:j["is".concat(W,"Active")]=!1}),o.configuration.showSVGCursors&&R.supportedInteractionTypes.includes("Mouse")&&a(y,j,R)),P("active",null,y,x,j)};function a(b,y,x){var j;typeof y=="number"?j=[y]:j=y.mouseButtonMask,j.includes(1)&&(x.svgCursor?Object(v.setToolCursor)(x.element,x.svgCursor):x.hideDefaultCursor?Object(v.hideToolCursor)(b):Object(v.resetToolCursor)(b))}var i=function(y,x,j){L("active",y,x,j),t.default.state.enabledElements.forEach(function(p){l(p,y,x,j)})},h=P.bind(null,"disabled",null),g=M.bind(null,"disabled",null),c=P.bind(null,"enabled",null),m=M.bind(null,"enabled",null),E=P.bind(null,"passive",r.default.TOOL_DEACTIVATED),T=M.bind(null,"passive",r.default.TOOL_DEACTIVATED);function P(b,y,x,j,p){var R=Object(f.default)(x,j);if(!R){s.warn('Unable to find tool "%s" for enabledElement',j);return}if(p=U(p),Array.isArray(p.mouseButtonMask)&&p.mouseButtonMask.length!==0&&Array.isArray(R.options.mouseButtonMask)&&(p.mouseButtonMask=B(p.mouseButtonMask,R.options.mouseButtonMask)),R.mode=b,R.mergeOptions(p),R["".concat(b,"Callback")]&&R["".concat(b,"Callback")](x,p),y){var W={options:p,toolName:j,toolType:j,type:y};Object(u.default)(x,y,W)}}function M(b,y,x,j){L(b,x,j),t.default.state.enabledElements.forEach(function(p){P(b,y,p,x,j)})}function C(b,y,x,j){y.supportedInteractionTypes.forEach(function(R){if(j===void 0||j.includes(R)){var W=A[R];W?W(y,b,x):s.warn("Unable to resolve input conflicts for type %s",R)}});var p=t.default.state.tools.filter(function(R){return R.element===b&&R.mode==="active"&&R.supportedInteractionTypes.length>0});p.forEach(function(R){var W=!1;R.supportedInteractionTypes.forEach(function(K){R.options["is".concat(K,"Active")]&&(W=!0)}),W||(s.log("Setting tool %s's to PASSIVE",R.name),E(b,R.name))})}function O(b,y,x){var j=U(x).mouseButtonMask,p=Array.isArray(j)&&j.length>0;if(p){var R=t.default.state.tools.find(function(W){return W.element===y&&W.mode==="active"&&W.options.isMouseActive===!0&&Array.isArray(W.options.mouseButtonMask)&&W.options.mouseButtonMask.some(function(K){return j.includes(K)})});R&&(R.options.mouseButtonMask=R.options.mouseButtonMask.filter(function(W){return!j.includes(W)}),R.options.mouseButtonMask.length===0&&(R.options.isMouseActive=!1))}}function I(b,y){var x=t.default.state.tools.find(function(p){return p.element===y&&p.mode==="active"&&p.options.isTouchActive===!0}),j=t.default.state.tools.find(function(p){return p.element===y&&p.mode==="active"&&p.options.isMultiTouchActive===!0&&p.configuration.touchPointers===1});x&&(s.log("Setting tool %s's isTouchActive to false",x.name),x.options.isTouchActive=!1),j&&(s.log("Setting tool %s's isTouchActive to false",j.name),j.options.isMultiTouchActive=!1)}function _(b,y){var x=t.default.state.tools.find(function(p){return p.element===y&&p.mode==="active"&&p.options.isMultiTouchActive===!0&&p.configuration.touchPointers===b.configuration.touchPointers}),j;b.configuration.touchPointers===1&&(j=t.default.state.tools.find(function(p){return p.element===y&&p.mode==="active"&&p.options.isTouchActive===!0})),x&&(s.log("Setting tool %s's isMultiTouchActive to false",x.name),x.options.isMultiTouchActive=!1),j&&(s.log("Setting tool %s's isTouchActive to false",j.name),j.options.isTouchActive=!1)}function D(b,y,x){var j="is".concat(b,"Active"),p=t.default.state.tools.find(function(R){return R.element===x&&R.mode==="active"&&R.options[j]===!0});p&&(s.log("Setting tool %s's %s to false",p.name,j),p.options[j]=!1)}function L(b,y,x,j){if(o.configuration.globalToolSyncEnabled){var p={mode:b,args:[y,x]};j&&p.push(j),t.default.state.globalToolChangeHistory.push(p);var R=50;t.default.state.globalToolChangeHistory.length>R&&t.default.state.globalToolChangeHistory.shift();var W=t.default.state.globalTools[y];if(!W){s.warn("setToolMode call for tool not available globally: ".concat(y));return}if(b==="active"){var K=S(y,x,j);Object.keys(t.default.state.globalTools).forEach(function(N){var z=t.default.state.globalTools[N];z.activeBindings=z.activeBindings.filter(function(Y){return!K.includes(Y)})}),K.some(function(N){return N.includes("Mouse-DELETE")})&&(W.activeBindings=W.activeBindings.filter(function(N){return!N.includes("Mouse")}),K=K.filter(function(N){return!N.includes("Mouse")})),W.activeBindings=W.activeBindings.concat(K)}else W.activeBindings=[]}}function S(b,y,x){x===void 0&&Array.isArray(y)&&(x=y,y=null);var j=[],p=t.default.state.globalTools[b];if(p){var R=new p.tool(p.props);R.supportedInteractionTypes.forEach(function(W){if(x===void 0||x.includes(W))if(W==="Mouse"){var K=U(y).mouseButtonMask;Array.isArray(K)&&K.length>0?K.forEach(function(N){return j.push("".concat(W,"-").concat(N))}):Array.isArray(K)&&K.length===0&&j.push("".concat(W,"-DELETE"))}else W==="MultiTouch"?j.push("".concat(W,"-").concat(R.configuration.touchPointers)):j.push(W)})}return j}var A={Mouse:O,MouseWheel:D.bind(void 0,"MouseWheel"),Touch:I,TouchPinch:D.bind(void 0,"TouchPinch"),TouchRotate:D.bind(void 0,"TouchRotate"),DoubleTap:D.bind(void 0,"DoubleTap"),MultiTouch:_};function U(b){return Array.isArray(b)?b={mouseButtonMask:b}:b!==Object(b)&&(b={mouseButtonMask:[b]}),b.hasOwnProperty("mouseButtonMask")||(b.mouseButtonMask=[]),Array.isArray(b.mouseButtonMask)||(b.mouseButtonMask=[b.mouseButtonMask]),b.mouseButtonMask=b.mouseButtonMask.filter(function(y){return typeof y=="number"&&y!==0}),b}function B(b,y){return b.concat(y).reduce(function(x,j){return x.indexOf(j)===-1&&x.push(j),x},[])}},"./store/setToolOptions.js":function(H,n,e){e.r(n),e.d(n,"setToolOptions",function(){return v}),e.d(n,"setToolOptionsForElement",function(){return f});var r=e("./store/getToolForElement.js"),u=e("./store/index.js"),f=function(t,o,s){var l=Object(r.default)(t,o);l&&l.mergeOptions(s)},v=function(t,o){u.state.enabledElements.forEach(function(s){f(s,t,o)})}},"./synchronization/Synchronizer.js":function(H,n,e){e.r(n);var r=e("./externalModules.js"),u=e("./util/convertToVector3.js"),f=e("./toolOptions.js");function v(t){return t.filter(function(o,s,l){return l.indexOf(o)===s})}function d(t,o){r.default.cornerstone;var s=this,l=[],a=[],i=!1,h={},g=o;this.enabled=!0,this.setHandler=function(m){g=m},this.getHandler=function(){return g},this.getDistances=function(){if(!(!l.length||!a.length)){var m=r.default.cornerstone;h.distances={},h.imageIds={sourceElements:[],targetElements:[]},l.forEach(function(E){var T=m.getEnabledElement(E);if(!(!T||!T.image)){var P=T.image.imageId,M=m.metaData.get("imagePlaneModule",P);if(!(!M||!M.imagePositionPatient)){var C=Object(u.default)(M.imagePositionPatient);h.hasOwnProperty(T)||(h.distances[P]={},h.imageIds.sourceElements.push(P),a.forEach(function(O){var I=m.getEnabledElement(O);if(!(!I||!I.image)){var _=I.image.imageId;if(h.imageIds.targetElements.push(_),E!==O&&P!==_&&!h.distances[P].hasOwnProperty(_)){var D=m.metaData.get("imagePlaneModule",_);if(!(!D||!D.imagePositionPatient)){var L=Object(u.default)(D.imagePositionPatient);h.distances[P][_]=L.clone().sub(C)}}}}),Object.keys(h.distances[P]).length||delete h.distances[P])}}})}},this.fireEvent=function(m,E){var T=!s.enabled,P=!l.length||!a.length;T||P||(i=!0,a.forEach(function(M){var C=a.indexOf(M);if(C!==-1){var O=h.imageIds.targetElements[C],I=l.indexOf(m);if(I!==-1){var _=h.imageIds.sourceElements[I],D;_===O?D=0:h.distances[_]!==void 0&&(D=h.distances[_][O]),g(s,m,M,E,D)}}}),i=!1)},this.onEvent=function(m){var E=m.detail;i!==!0&&s.fireEvent(m.currentTarget,E)},this.addSource=function(m){var E=l.indexOf(m);E===-1&&(l.push(m),t.split(" ").forEach(function(T){m.addEventListener(T,s.onEvent)}),s.getDistances(),s.updateDisableHandlers())},this.addTarget=function(m){var E=a.indexOf(m);E===-1&&(a.push(m),s.getDistances(),g(s,m,m,0),s.updateDisableHandlers())},this.add=function(m){s.addSource(m),s.addTarget(m)},this.removeSource=function(m){var E=l.indexOf(m);E!==-1&&(l.splice(E,1),t.split(" ").forEach(function(T){m.removeEventListener(T,s.onEvent)}),s.getDistances(),s.fireEvent(m),s.updateDisableHandlers())},this.removeTarget=function(m){var E=a.indexOf(m);E!==-1&&(a.splice(E,1),s.getDistances(),g(s,m,m,0),s.updateDisableHandlers())},this.remove=function(m){s.removeTarget(m),s.removeSource(m)},this.getSourceElements=function(){return l},this.getTargetElements=function(){return a},this.displayImage=function(m,E,T){i=!0,r.default.cornerstone.displayImage(m,E,T),i=!1},this.setViewport=function(m,E){i=!0,r.default.cornerstone.setViewport(m,E),i=!1};function c(m){var E=m.detail.element;s.remove(E),Object(f.clearToolOptionsByElement)(E)}this.updateDisableHandlers=function(){var m=v(l.concat(a));m.forEach(function(E){E.removeEventListener(r.default.cornerstone.EVENTS.ELEMENT_DISABLED,c),E.addEventListener(r.default.cornerstone.EVENTS.ELEMENT_DISABLED,c)})},this.destroy=function(){var m=v(l.concat(a));m.forEach(function(E){s.remove(E)})}}n.default=d},"./synchronization/panZoomSynchronizer.js":function(H,n,e){e.r(n);var r=e("./externalModules.js");n.default=function(u,f,v){if(v!==f){var d=r.default.cornerstone,t=d.getViewport(f),o=d.getViewport(v);o.scale===t.scale&&o.translation.x===t.translation.x&&o.translation.y===t.translation.y||(o.scale=t.scale,o.translation.x=t.translation.x,o.translation.y=t.translation.y,u.setViewport(v,o))}}},"./synchronization/stackImageIndexSynchronizer.js":function(H,n,e){e.r(n);var r=e("./externalModules.js"),u=e("./stateManagement/toolState.js"),f=e("./stateManagement/loadHandlerManager.js"),v=e("./util/clip.js");n.default=function(d,t,o){if(o!==t){var s=r.default.cornerstone,l=Object(u.getToolState)(t,"stack"),a=l.data[0],i=Object(u.getToolState)(o,"stack"),h=i.data[0],g=a.currentImageIdIndex;if(g=Object(v.default)(g,0,h.imageIds.length-1),g!==h.currentImageIdIndex){var c=f.default.getStartLoadHandler(o),m=f.default.getEndLoadHandler(o),E=f.default.getErrorLoadingHandler(o);c&&c(o);var T;h.preventCache===!0?T=s.loadImage(h.imageIds[g]):T=s.loadAndCacheImage(h.imageIds[g]),T.then(function(P){var M=s.getViewport(o);h.currentImageIdIndex=g,d.displayImage(o,P,M),m&&m(o,P)},function(P){var M=h.imageIds[g];E&&E(o,M,P)})}}}},"./synchronization/stackImagePositionOffsetSynchronizer.js":function(H,n,e){e.r(n);var r=e("./externalModules.js"),u=e("./stateManagement/toolState.js"),f=e("./stateManagement/loadHandlerManager.js"),v=e("./util/convertToVector3.js");n.default=function(d,t,o,s,l){if(o!==t){var a=r.default.cornerstone,i=Object(u.getToolState)(t,"stack").data[0],h=i.imageIds[i.currentImageIdIndex],g=a.metaData.get("imagePlaneModule",h);if(!(g===void 0||g.imagePositionPatient===void 0)){var c=Object(v.default)(g.imagePositionPatient),m=Object(u.getToolState)(o,"stack"),E=m.data[0],T=Number.MAX_VALUE,P=-1;if(l){var M=c.clone().add(l);if(E.imageIds.forEach(function(L,S){var A=a.metaData.get("imagePlaneModule",L);if(!(A===void 0||A.imagePositionPatient===void 0)){var U=Object(v.default)(A.imagePositionPatient),B=M.distanceToSquared(U);B<T&&(T=B,P=S)}}),!(P===E.currentImageIdIndex||P===-1)){var C=f.default.getStartLoadHandler(o),O=f.default.getEndLoadHandler(o),I=f.default.getErrorLoadingHandler(o);E.currentImageIdIndex=P;var _=E.imageIds[P];C&&C(o);var D;E.preventCache===!0?D=a.loadImage(_):D=a.loadAndCacheImage(_),D.then(function(L){var S=a.getViewport(o);E.currentImageIdIndex===P&&(d.displayImage(o,L,S),O&&O(o,L))},function(L){var S=E.imageIds[P];I&&I(o,S,L)})}}}}}},"./synchronization/stackImagePositionSynchronizer.js":function(H,n,e){e.r(n);var r=e("./externalModules.js"),u=e("./stateManagement/toolState.js"),f=e("./stateManagement/loadHandlerManager.js"),v=e("./util/convertToVector3.js");n.default=function(d,t,o){if(o!==t){var s=r.default.cornerstone,l=Object(u.getToolState)(t,"stack").data[0],a=l.imageIds[l.currentImageIdIndex],i=s.metaData.get("imagePlaneModule",a);if(!(i===void 0||i.imagePositionPatient===void 0)){var h=Object(v.default)(i.imagePositionPatient),g=Object(u.getToolState)(o,"stack"),c=g.data[0],m=Number.MAX_VALUE,E=-1;if(c.imageIds.forEach(function(I,_){var D=s.metaData.get("imagePlaneModule",I);if(!(D===void 0||D.imagePositionPatient===void 0)){var L=Object(v.default)(D.imagePositionPatient),S=L.distanceToSquared(h);S<m&&(m=S,E=_)}}),E!==c.currentImageIdIndex){var T=f.default.getStartLoadHandler(o),P=f.default.getEndLoadHandler(o),M=f.default.getErrorLoadingHandler(o);c.currentImageIdIndex=E;var C=c.imageIds[E];if(T&&T(o),E!==-1){var O;c.preventCache===!0?O=s.loadImage(C):O=s.loadAndCacheImage(C),O.then(function(I){var _=s.getViewport(o);c.currentImageIdIndex===E&&(d.displayImage(o,I,_),P&&P(o,I))},function(I){var _=c.imageIds[E];M&&M(o,_,I)})}}}}}},"./synchronization/stackScrollSynchronizer.js":function(H,n,e){e.r(n);var r=e("./externalModules.js"),u=e("./stateManagement/toolState.js"),f=e("./stateManagement/loadHandlerManager.js"),v=e("./util/clip.js");n.default=function(d,t,o,s){if(t!==o&&!(!s||!s.direction)){var l=r.default.cornerstone,a=Object(u.getToolState)(o,"stack"),i=a.data[0],h=i.currentImageIdIndex+s.direction;if(h=Object(v.default)(h,0,i.imageIds.length-1),i.currentImageIdIndex!==h){var g=f.default.getStartLoadHandler(o),c=f.default.getEndLoadHandler(o),m=f.default.getErrorLoadingHandler(o);i.currentImageIdIndex=h;var E=i.imageIds[h];g&&g(o);var T;i.preventCache===!0?T=l.loadImage(E):T=l.loadAndCacheImage(E),T.then(function(P){var M=l.getViewport(o);i.currentImageIdIndex===h&&(d.displayImage(o,P,M),c&&c(o,P))},function(P){var M=i.imageIds[h];m&&m(o,M,P)})}}}},"./synchronization/updateImageSynchronizer.js":function(H,n,e){e.r(n);var r=e("./externalModules.js");n.default=function(u,f,v){v!==f&&r.default.cornerstone.updateImage(v)}},"./synchronization/wwwcSynchronizer.js":function(H,n,e){e.r(n);var r=e("./externalModules.js");n.default=function(u,f,v){if(v!==f){var d=r.default.cornerstone,t=d.getViewport(f),o=d.getViewport(v);o.voi.windowWidth===t.voi.windowWidth&&o.voi.windowCenter===t.voi.windowCenter&&o.invert===t.invert||(o.voi.windowWidth=t.voi.windowWidth,o.voi.windowCenter=t.voi.windowCenter,o.invert=t.invert,u.setViewport(v,o))}}},"./thirdParty/register.js":function(H,n,e){e.r(n);var r=e("../node_modules/@babel/runtime/helpers/typeof.js"),u=e.n(r),f=e("./thirdParty/registerModule.js"),v=e("./thirdParty/registerMixin.js"),d=e("./thirdParty/registerItem.js"),t=e("./util/logger.js"),o=Object(t.getLogger)("thirdParty:register");n.default=function(l,a,i){var h=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(s(l,a,i))switch(l){case"module":Object(f.default)(a,i,h);break;case"mixin":Object(v.default)(a,i,h);break;default:Object(d.default)(l,a,i,h)}};function s(l,a,i){return l?a?u()(i)!=="object"&&typeof i!="function"?(o.warn("The %s is a %s, it should be an Object or a function.",i,u()(i)),!1):!0:(o.warn("The %s must have a name in order to register.",l),!1):(o.warn("The type must be given in order to register."),!1)}},"./thirdParty/registerItem.js":function(H,n,e){e.r(n);var r=e("./lib.js"),u=e("./util/logger.js"),f=Object(u.getLogger)("thirdParty:registerType");n.default=function(d,t,o){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,l="".concat(d,"/").concat(t),a=v(l);if(a&&!s){f.warn("%s is already registered",l);return}a&&f.warn("Overwriting %s",l),r.lib[l]=o};function v(d){return r.lib[d]!==void 0}},"./thirdParty/registerMixin.js":function(H,n,e){e.r(n);var r=e("./lib.js"),u=e("./mixins/index.js"),f=e("./util/logger.js"),v=Object(f.getLogger)("thirdParty:registerMixin");n.default=function(t,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=d(t);if(l&&!s){v.warn("mixins/%s is already registered",t);return}l&&v.warn("Overwriting mixins/%s",t),u.default[t]=o,r.lib["mixins/".concat(t)]=u.default[t]};function d(t){return u.default[t]!==void 0}},"./thirdParty/registerModule.js":function(H,n,e){e.r(n);var r=e("./store/index.js"),u=e("./util/logger.js"),f=Object(u.getLogger)("thirdParty:registerModule");n.default=function(d,t){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=v(d);if(s&&!o){f.warn("A module with the name %s is already registered",d);return}s&&f.warn("Overwriting module %s",d),r.modules[d]=t,typeof r.modules[d].onRegisterCallback=="function"&&r.modules[d].onRegisterCallback()};function v(d){return r.modules[d]!==void 0}},"./thirdParty/registerSome.js":function(H,n,e){e.r(n);var r=e("./thirdParty/register.js");n.default=function(u){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;u.forEach(function(v){var d=v.type,t=v.name,o=v.item;Object(r.default)(d,t,o,f)})}},"./toolOptions.js":function(H,n,e){e.r(n),e.d(n,"getToolOptions",function(){return u}),e.d(n,"setToolOptions",function(){return f}),e.d(n,"clearToolOptions",function(){return v}),e.d(n,"clearToolOptionsByToolType",function(){return d}),e.d(n,"clearToolOptionsByToolName",function(){return t}),e.d(n,"clearToolOptionsByElement",function(){return o});var r={};function u(s,l){if(!r[s])return{};var a=r[s],i=a.find(function(h){return h.element===l});return i?i.options:{}}function f(s,l,a){if(!r[s]){r[s]=[{element:l,options:a}];return}var i=r[s],h=i.findIndex(function(c){return c.element===l});if(h===-1)r[s].push({element:l,options:a});else{var g=r[s][h].options||{};r[s][h].options=Object.assign(g,a)}}function v(s,l){var a=r[s];a&&(r[s]=a.filter(function(i){return i.element!==l}))}function d(s){return t(s)}function t(s){delete r[s]}function o(s){for(var l in r)r[l]=r[l].filter(function(a){return a.element!==s})}},"./tools/CrosshairsTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return O});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=e.n(o),l=e("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),a=e.n(l),i=e("../node_modules/@babel/runtime/helpers/inherits.js"),h=e.n(i),g=e("./tools/base/BaseTool.js"),c=e("./externalModules.js"),m=e("./stateManagement/loadHandlerManager.js"),E=e("./stateManagement/toolState.js"),T=e("./util/pointProjector.js"),P=e("./util/convertToVector3.js"),M=e("./toolOptions.js"),C=e("./tools/cursors/index.js"),O=function(I){h()(_,I);function _(){var D,L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u()(this,_);var S={name:"Crosshairs",supportedInteractionTypes:["Mouse","Touch"],svgCursor:C.crosshairsCursor};return D=t()(this,s()(_).call(this,L,S)),D.preMouseDownCallback=D._chooseLocation.bind(a()(D)),D.mouseDragCallback=D._chooseLocation.bind(a()(D)),D.touchDragCallback=D._chooseLocation.bind(a()(D)),D}return v()(_,[{key:"_chooseLocation",value:function(L){var S=L.detail,A=S.element;L.stopImmediatePropagation();var U=Object(E.getToolState)(A,this.name);if(U){var B=A,b=c.default.cornerstone.getEnabledElement(B),y=b.image.imageId,x=c.default.cornerstone.metaData.get("imagePlaneModule",y);if(x){var j=S.currentPoints.image,p=Object(T.imagePointToPatientPoint)(j,x),R=U.data[0].synchronizationContext,W=R.getSourceElements();W.forEach(function(K){if(K!==B){var N=Number.MAX_VALUE,z=-1,Y=Object(E.getToolState)(K,"stack");if(Y!==void 0){var $=Y.data[0];if($.imageIds.forEach(function(w,G){var Z=c.default.cornerstone.metaData.get("imagePlaneModule",w);if(!(!Z||!Z.imagePositionPatient||!Z.rowCosines||!Z.columnCosines)){var Q=Object(P.default)(Z.imagePositionPatient),k=Object(P.default)(Z.rowCosines),ae=Object(P.default)(Z.columnCosines),ee=ae.clone().cross(k.clone()),oe=Math.abs(ee.clone().dot(Q)-ee.clone().dot(p));oe<N&&(N=oe,z=G)}}),z!==$.currentImageIdIndex&&z!==-1&&$.imageIds[z]!==void 0){var J=m.default.getStartLoadHandler(K),te=m.default.getEndLoadHandler(K),ne=m.default.getErrorLoadingHandler(K);J&&J(K);var de;$.preventCache===!0?de=c.default.cornerstone.loadImage($.imageIds[z]):de=c.default.cornerstone.loadAndCacheImage($.imageIds[z]),de.then(function(w){var G=c.default.cornerstone.getViewport(K);$.currentImageIdIndex=z,c.default.cornerstone.displayImage(K,w,G),te&&te(K,w)},function(w){var G=$.imageIds[z];ne&&ne(K,G,w)})}}}})}}}},{key:"activeCallback",value:function(L,S){var A=S.mouseButtonMask,U=S.synchronizationContext;Object(M.setToolOptions)(this.name,L,{mouseButtonMask:A}),Object(E.clearToolState)(L,this.name),Object(E.addToolState)(L,this.name,{synchronizationContext:U})}}]),_}(g.default)},"./tools/DoubleTapFitToWindowTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return g});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=e.n(o),l=e("../node_modules/@babel/runtime/helpers/inherits.js"),a=e.n(l),i=e("./externalModules.js"),h=e("./tools/base/BaseTool.js"),g=function(c){a()(m,c);function m(){var E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u()(this,m);var T={name:"DoubleTapFitToWindow",supportedInteractionTypes:["DoubleTap"]};return t()(this,s()(m).call(this,E,T))}return v()(m,[{key:"doubleTapCallback",value:function(T){var P=T.detail;i.default.cornerstone.fitToWindow(P.element)}}]),m}(h.default)},"./tools/DragProbeTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return I});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=e.n(o),l=e("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),a=e.n(l),i=e("../node_modules/@babel/runtime/helpers/inherits.js"),h=e.n(i),g=e("./externalModules.js"),c=e("./tools/base/BaseTool.js"),m=e("./stateManagement/textStyle.js"),E=e("./stateManagement/toolColors.js"),T=e("./util/getRGBPixels.js"),P=e("./util/calculateSUV.js"),M=e("./drawing/index.js"),C=e("./drawing/drawTextBox.js"),O=e("./tools/cursors/index.js"),I=function(L){h()(S,L);function S(){var A,U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u()(this,S);var B={name:"DragProbe",strategies:{default:_,minimal:D},defaultStrategy:"default",supportedInteractionTypes:["Mouse","Touch"],svgCursor:O.probeCursor};return A=t()(this,s()(S).call(this,U,B)),A.touchDragCallback=A._movingEventCallback.bind(a()(A)),A.touchEndCallback=A._endMovingEventCallback.bind(a()(A)),A.mouseDragCallback=A._movingEventCallback.bind(a()(A)),A.mouseUpCallback=A._endMovingEventCallback.bind(a()(A)),A.dragEventData={},A}return v()(S,[{key:"_movingEventCallback",value:function(U){var B=U.detail,b=B.element;this.dragEventData=B,g.default.cornerstone.updateImage(b)}},{key:"_endMovingEventCallback",value:function(U){var B=U.detail,b=B.element;this.dragEventData={},g.default.cornerstone.updateImage(b)}},{key:"renderToolData",value:function(U){this.dragEventData.currentPoints&&U&&U.detail&&Object.keys(this.dragEventData.currentPoints).length&&(U.detail.currentPoints=this.dragEventData.currentPoints,this.applyActiveStrategy(U))}}]),S}(c.default);function _(L){var S=this.configuration,A=g.default.cornerstone,U=L.detail,B=U.element,b=U.image,y=U.currentPoints,x=U.canvasContext,j=Object(M.getNewContext)(x.canvas),p=E.default.getActiveColor(),R=m.default.getFontSize(),W=Math.round(y.image.x),K=Math.round(y.image.y);W<0||K<0||W>=b.columns||K>=b.rows||Object(M.draw)(j,function(N){Object(M.setShadow)(N,S);var z="".concat(W,", ").concat(K),Y,$;if(b.color)Y=Object(T.default)(B,W,K,1,1),$="R: ".concat(Y[0]," G: ").concat(Y[1]," B: ").concat(Y[2]," A: ").concat(Y[3]);else{Y=A.getStoredPixels(B,W,K,1,1);var J=Y[0],te=J*b.slope+b.intercept,ne=Object(P.default)(b,J);$="SP: ".concat(J," MO: ").concat(parseFloat(te.toFixed(3))),ne&&($+=" SUV: ".concat(parseFloat(ne.toFixed(3))))}var de={x:y.canvas.x+5,y:y.canvas.y-5};Object(C.default)(N,$,de.x,de.y+R+5,p),Object(C.default)(N,z,de.x,de.y,p)})}function D(L){var S=this.configuration,A=g.default.cornerstone,U=L.detail,B=U.element,b=U.image,y=U.currentPoints,x=U.canvasContext,j=U.isTouchEvent,p=Object(M.getNewContext)(x.canvas),R=E.default.getActiveColor(),W=y.page.y-m.default.getFontSize()/2;j&&(W=y.page.y-m.default.getFontSize()*4);var K=A.pageToPixel(B,y.page.x,W);K.x<0||K.y<0||K.x>=b.columns||K.y>=b.rows||Object(M.draw)(p,function(N){Object(M.setShadow)(N,S);var z=A.metaData.get("generalSeriesModule",b.imageId),Y=z&&z.modality,$,J="";if(b.color)$=Object(T.default)(B,K.x,K.y,1,1),J="R: ".concat($[0]," G: ").concat($[1]," B: ").concat($[2]);else{$=A.getStoredPixels(B,K.x,K.y,1,1);var te=$[0],ne=te*b.slope+b.intercept,de=parseFloat(ne.toFixed(2));if(Y==="CT")J+="HU: ".concat(de);else if(Y==="PT"){J+=de;var w=Object(P.default)(b,te);w&&(J+=" SUV: ".concat(parseFloat(w.toFixed(2))))}else J+=de}var G=A.pixelToCanvas(B,K),Z={x:12,y:-(m.default.getFontSize()+10)/2},Q=6,k=5,ae=Object(C.textBoxWidth)(N,J,k);j&&(Z={x:-ae/2,y:-m.default.getFontSize()-10-2*Q}),Object(M.drawCircle)(N,B,G,Q,{color:R},"canvas"),Object(C.default)(N,J,G.x+Z.x,G.y+Z.y,R)})}},"./tools/EraserTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return P});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=e.n(o),l=e("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),a=e.n(l),i=e("../node_modules/@babel/runtime/helpers/inherits.js"),h=e.n(i),g=e("./externalModules.js"),c=e("./tools/base/BaseTool.js"),m=e("./stateManagement/toolState.js"),E=e("./store/index.js"),T=e("./tools/cursors/index.js"),P=function(M){h()(C,M);function C(){var O,I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u()(this,C);var _={name:"Eraser",supportedInteractionTypes:["Mouse","Touch"],svgCursor:T.eraserCursor};return O=t()(this,s()(C).call(this,I,_)),O.preMouseDownCallback=O._deleteAllNearbyTools.bind(a()(O)),O.preTouchStartCallback=O._deleteAllNearbyTools.bind(a()(O)),O}return v()(C,[{key:"_deleteAllNearbyTools",value:function(I){var _=I.detail.currentPoints.canvas,D=I.detail.element;E.state.tools.forEach(function(S){var A=Object(m.getToolState)(D,S.name);A&&A.data.forEach(function(U){typeof S.pointNearTool=="function"&&S.pointNearTool(D,U,_)&&(Object(m.removeToolState)(D,S.name,U),g.default.cornerstone.updateImage(D))})});var L=!0;return L}}]),C}(c.default)},"./tools/FreehandRoiSculptorTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return S});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=e.n(o),l=e("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),a=e.n(l),i=e("../node_modules/@babel/runtime/helpers/inherits.js"),h=e.n(i),g=e("./events.js"),c=e("./externalModules.js"),m=e("./stateManagement/toolColors.js"),E=e("./drawing/drawHandles.js"),T=e("./store/index.js"),P=e("./stateManagement/toolState.js"),M=e("./util/clip.js"),C=e("./store/getToolForElement.js"),O=e("./tools/base/BaseTool.js"),I=e("./store/setToolCursor.js"),_=e("./tools/cursors/index.js"),D=e("./util/freehand/index.js"),L=D.default.FreehandHandleData,S=function(B){h()(b,B);function b(){var y,x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u()(this,b);var j={name:"FreehandRoiSculptor",referencedToolName:"FreehandRoi",supportedInteractionTypes:["Mouse","Touch","DoubleTap"],mixins:["activeOrDisabledBinaryTool"],configuration:A(),svgCursor:_.freehandRoiSculptorCursor};return y=t()(this,s()(b).call(this,x,j)),y.updateOnMouseMove=!0,y.isMultiPartTool=!0,y.referencedToolName=y.initialConfiguration.referencedToolName,y._active=!1,y.activeMouseUpCallback=y.activeMouseUpCallback.bind(a()(y)),y.activeTouchEndCallback=y.activeTouchEndCallback.bind(a()(y)),y.activeMouseDragCallback=y.activeMouseDragCallback.bind(a()(y)),y}return v()(b,[{key:"renderToolData",value:function(x){var j=x.detail;if(this.configuration.currentTool===null)return!1;var p=j.element,R=this.configuration,W=Object(P.getToolState)(p,this.referencedToolName),K=W.data[R.currentTool];if(!K)return!1;if(this._active){var N=j.canvasContext.canvas.getContext("2d"),z={color:this.configuration.dragColor,fill:null,handleRadius:this._toolSizeCanvas};Object(E.default)(N,j,this.configuration.mouseLocation.handles,z)}else this.configuration.showCursorOnHover&&!this._recentTouchEnd&&this._renderHoverCursor(x)}},{key:"doubleClickCallback",value:function(x){var j=x.detail;this._selectFreehandTool(j),c.default.cornerstone.updateImage(j.element)}},{key:"doubleTapCallback",value:function(x){var j=x.detail;this._selectFreehandTool(j),c.default.cornerstone.updateImage(j.element)}},{key:"preTouchStartCallback",value:function(x){return this._initialiseSculpting(x),!0}},{key:"preMouseDownCallback",value:function(x){if(this.options.mouseButtonMask.includes(x.detail.buttons))return this._initialiseSculpting(x),!0}},{key:"activeMouseDragCallback",value:function(x){var j=this.configuration;if(this._active){var p=x.detail,R=Object(P.getToolState)(p.element,this.referencedToolName);if(R){var W=R.data[j.currentTool].handles.points;this._getMouseLocation(p),this._sculpt(p,W),c.default.cornerstone.updateImage(p.element)}}}},{key:"activeMouseUpCallback",value:function(x){this._activeEnd(x)}},{key:"activeTouchEndCallback",value:function(x){this._activeEnd(x),this._deselectAllTools(x),this._recentTouchEnd=!0}},{key:"_activeEnd",value:function(x){var j=x.detail,p=j.element,R=this.configuration;this._active=!1,T.state.isMultiPartToolActive=!1,this._getMouseLocation(j),this._invalidateToolData(j),R.mouseUpRender=!0,this._deactivateSculpt(p),c.default.cornerstone.updateImage(j.element),U(x)}},{key:"_renderHoverCursor",value:function(x){var j=x.detail,p=j.element,R=j.canvasContext.canvas.getContext("2d"),W=Object(P.getToolState)(p,this.referencedToolName),K=W.data[this.configuration.currentTool];this._recentTouchEnd=!1;var N;this.configuration.mouseUpRender?(N=this.configuration.mouseLocation.handles.start,this.configuration.mouseUpRender=!1):N=T.state.mousePositionImage;var z=Object(C.default)(p,this.referencedToolName),Y=z.distanceFromPointCanvas(p,K,N);if(this.configuration.mouseLocation.handles.start.x=N.x,this.configuration.mouseLocation.handles.start.y=N.y,this.configuration.limitRadiusOutsideRegion){var $=Y;Y=this._limitCursorRadiusCanvas(j,Y),$>this.configuration.hoverCursorFadeDistance*Y&&(R.globalAlpha=this.configuration.hoverCursorFadeAlpha)}var J={fill:null,color:this.configuration.hoverColor,handleRadius:Y};Object(E.default)(R,j,this.configuration.mouseLocation.handles,J),this.configuration.limitRadiusOutsideRegion&&(R.globalAlpha=1)}},{key:"newImageCallback",value:function(x){this._deselectAllTools(x)}},{key:"enabledCallback",value:function(x){this._deselectAllTools(x)}},{key:"passiveCallback",value:function(x){this._deselectAllTools(x)}},{key:"disabledCallback",value:function(x){this._deselectAllTools(x)}},{key:"_selectFreehandTool",value:function(x){var j=this.configuration,p=x.element,R=this._getClosestFreehandToolOnElement(p,x);R!==void 0&&(j.currentTool=R,Object(I.hideToolCursor)(p))}},{key:"_activateFreehandTool",value:function(x,j){var p=Object(P.getToolState)(x,this.referencedToolName),R=p.data,W=this.configuration;W.currentTool=j;for(var K=0;K<R.length;K++)K===j?R[K].active=!0:R[K].active=!1}},{key:"_initialiseSculpting",value:function(x){var j=x.detail,p=this.configuration,R=j.element;p.currentTool===null&&(this._selectFreehandTool(j),p.currentTool===null)||(this._active=!0,T.state.isMultiPartToolActive=!0,this._configureToolSize(j),this._getMouseLocation(j),this._activateFreehandTool(R,p.currentTool),this._activateSculpt(R),c.default.cornerstone.updateImage(j.element))}},{key:"_sculpt",value:function(x,j){var p=this.configuration;this._sculptData={element:x.element,image:x.image,mousePoint:x.currentPoints.image,points:j,toolSize:this._toolSizeImage,minSpacing:p.minSpacing,maxSpacing:Math.max(this._toolSizeImage,p.minSpacing*2)};var R=this._pushHandles();R.first!==void 0&&(this._insertNewHandles(R),this._consolidateHandles())}},{key:"_pushHandles",value:function(){for(var x=this._sculptData,j=x.points,p=x.mousePoint,R=x.toolSize,W={},K=0;K<j.length;K++){var N=c.default.cornerstoneMath.point.distance(j[K],p);N>R||(this._pushOneHandle(K,N),W.first===void 0&&(W.first=K),W.last=K)}return W}},{key:"_pushOneHandle",value:function(x,j){var p=this._sculptData,R=p.points,W=p.mousePoint,K=p.toolSize,N=p.image,z=R[x],Y={x:(z.x-W.x)/j,y:(z.y-W.y)/j},$={x:W.x+K*Y.x,y:W.y+K*Y.y};Object(M.clipToBox)($,N),z.x=$.x,z.y=$.y;var J=this.constructor._getPreviousHandleIndex(x,R.length);R[J].lines.pop(),R[J].lines.push(z)}},{key:"_insertNewHandles",value:function(x){for(var j=this._findNewHandleIndicies(x),p=0,R=0;R<j.length;R++){var W=j[R]+1+p;this._insertHandleRadially(W),p++}}},{key:"_findNewHandleIndicies",value:function(x){for(var j=this._sculptData,p=j.points,R=j.maxSpacing,W=[],K=x.first;K<=x.last;K++)this._checkSpacing(K,p,W,R);var N=this.constructor._getNextHandleIndex(x.last,p.length);if(N!==x.first){this._checkSpacing(N,p,W,R);var z=this.constructor._getPreviousHandleIndex(x.first,p.length);z!==N&&this._checkSpacing(z,p,W,R)}return W}},{key:"_checkSpacing",value:function(x,j,p,R){var W=this.constructor._getNextHandleIndex(x,j.length),K=c.default.cornerstoneMath.point.distance(j[x],j[W]);K>R&&p.push(x)}},{key:"_insertHandleRadially",value:function(x){var j=this._sculptData.points,p=x-1,R=this.constructor._getNextHandleIndexBeforeInsert(x,j.length),W=this._getInsertPosition(x,p,R),K=new L(W);j.splice(x,0,K),j[p].lines.pop(),j[p].lines.push(j[x]),D.default.addLine(j,x)}},{key:"_consolidateHandles",value:function(){var x=this._sculptData.points;if(!(x.length<=3)){var j=this._findCloseHandlePairs();this._mergeCloseHandles(j)}}},{key:"_findCloseHandlePairs",value:function(){for(var x=this._sculptData,j=x.points,p=x.minSpacing,R=[],W=j.length,K=0;K<W;K++){var N=this.constructor._getNextHandleIndex(K,j.length),z=c.default.cornerstoneMath.point.distance(j[K],j[N]);if(z<p){var Y=[K,N];R.push(Y),K===0&&(W-=1),K++}}return R}},{key:"_mergeCloseHandles",value:function(x){for(var j=0,p=0;p<x.length;p++){var R=this.constructor._getCorrectedPair(x[p],j);this._combineHandles(R),j++}var W=this._findCloseHandlePairs();W.length&&this._mergeCloseHandles(W)}},{key:"_combineHandles",value:function(x){var j=this._sculptData,p=j.points,R=j.image,W={x:(p[x[0]].x+p[x[1]].x)/2,y:(p[x[0]].y+p[x[1]].y)/2};Object(M.clipToBox)(W,R),p[x[0]].x=W.x,p[x[0]].y=W.y;var K=this.constructor._getNextHandleIndex(x[1],p.length);p[x[0]].lines.pop(),p[x[0]].lines.push(p[K]),p.splice(x[1],1)}},{key:"_configureToolSize",value:function(x){var j=x.element,p=this.configuration,R=p.currentTool,W=x.currentPoints.image,K=Object(P.getToolState)(j,this.referencedToolName),N=K.data[R],z=Object(C.default)(j,this.referencedToolName),Y=z.distanceFromPoint(j,N,W),$=z.distanceFromPointCanvas(j,N,W);p.limitRadiusOutsideRegion&&(Y=this._limitCursorRadiusImage(x,Y),$=this._limitCursorRadiusCanvas(x,$)),this._toolSizeImage=Y,this._toolSizeCanvas=$}},{key:"_getMouseLocation",value:function(x){var j=this.configuration;j.mouseLocation.handles.start.x=x.currentPoints.image.x,j.mouseLocation.handles.start.y=x.currentPoints.image.y,Object(M.clipToBox)(j.mouseLocation.handles.start,x.image)}},{key:"_activateSculpt",value:function(x){this._deactivateSculpt(x),x.addEventListener(g.default.MOUSE_UP,this.activeMouseUpCallback),x.addEventListener(g.default.MOUSE_CLICK,this.activeMouseUpCallback),x.addEventListener(g.default.MOUSE_DRAG,this.activeMouseDragCallback),x.addEventListener(g.default.TOUCH_END,this.activeTouchEndCallback),x.addEventListener(g.default.TOUCH_TAP,this.activeTouchEndCallback),x.addEventListener(g.default.TOUCH_DRAG,this.activeMouseDragCallback),c.default.cornerstone.updateImage(x)}},{key:"_deactivateSculpt",value:function(x){x.removeEventListener(g.default.MOUSE_UP,this.activeMouseUpCallback),x.removeEventListener(g.default.MOUSE_CLICK,this.activeMouseUpCallback),x.removeEventListener(g.default.MOUSE_DRAG,this.activeMouseDragCallback),x.removeEventListener(g.default.TOUCH_END,this.activeTouchEndCallback),x.removeEventListener(g.default.TOUCH_TAP,this.activeTouchEndCallback),x.removeEventListener(g.default.TOUCH_DRAG,this.activeMouseDragCallback),c.default.cornerstone.updateImage(x)}},{key:"_invalidateToolData",value:function(x){var j=this.configuration,p=x.element,R=Object(P.getToolState)(p,this.referencedToolName),W=R.data[j.currentTool];W.invalidated=!0}},{key:"_deselectAllTools",value:function(x){var j=this.configuration,p=Object(P.getToolState)(this.element,this.referencedToolName);if(j.currentTool=null,p)for(var R=0;R<p.data.length;R++)p.data[R].active=!1;Object(I.setToolCursor)(this.element,this.svgCursor),c.default.cornerstone.updateImage(this.element)}},{key:"_limitCursorRadiusCanvas",value:function(x,j){return this._limitCursorRadius(x,j,!0)}},{key:"_limitCursorRadiusImage",value:function(x,j){return this._limitCursorRadius(x,j,!1)}},{key:"_limitCursorRadius",value:function(x,j){var p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,R=x.element,W=x.image,K=this.configuration,N=Object(P.getToolState)(R,this.referencedToolName),z=N.data[K.currentTool],Y=1;if(p){var $=c.default.cornerstone.pixelToCanvas(R,{x:0,y:0}),J=c.default.cornerstone.pixelToCanvas(R,{x:W.width,y:W.height}),te=(J.x-$.x)*(J.y-$.y);Y=te/(W.width*W.height)}var ne=z.area*Y,de=Math.pow(ne/Math.PI,.5);return Math.min(j,de)}},{key:"_getClosestFreehandToolOnElement",value:function(x,j){var p=Object(C.default)(x,this.referencedToolName),R=Object(P.getToolState)(x,this.referencedToolName);if(R){for(var W=R.data,K=j.currentPoints.image,N={distance:1/0,toolIndex:null},z=0;z<W.length;z++){var Y=p.distanceFromPoint(x,W[z],K);Y!==-1&&Y<N.distance&&(N.distance=Y,N.toolIndex=z)}return N.toolIndex}}},{key:"_getInsertPosition",value:function(x,j,p){var R=this._sculptData,W=R.points,K=R.toolSize,N=R.mousePoint,z=R.image,Y={x:(W[j].x+W[p].x)/2,y:(W[j].y+W[p].y)/2},$=c.default.cornerstoneMath.point.distance(N,Y),J;if($<K){var te={x:(Y.x-N.x)/$,y:(Y.y-N.y)/$};J={x:N.x+K*te.x,y:N.y+K*te.y}}else J=Y;return Object(M.clipToBox)(J,z),J}},{key:"minSpacing",get:function(){return this.configuration.minSpacing},set:function(x){if(typeof x!="number")throw new Error("Attempting to set freehandSculpter minSpacing to a value other than a number.");this.configuration.minSpacing=x}},{key:"maxSpacing",get:function(){return this.configuration.maxSpacing},set:function(x){if(typeof x!="number")throw new Error("Attempting to set freehandSculpter maxSpacing to a value other than a number.");this.configuration.maxSpacing=x}},{key:"showCursorOnHover",get:function(){return this.configuration.showCursorOnHover},set:function(x){if(typeof x!="boolean")throw new Error("Attempting to set freehandSculpter showCursorOnHover to a value other than a boolean.");this.configuration.showCursorOnHover=x,c.default.cornerstone.updateImage(this.element)}},{key:"limitRadiusOutsideRegion",get:function(){return this.configuration.limitRadiusOutsideRegion},set:function(x){if(typeof x!="boolean")throw new Error("Attempting to set freehandSculpter limitRadiusOutsideRegion to a value other than a boolean.");this.configuration.limitRadiusOutsideRegion=x,c.default.cornerstone.updateImage(this.element)}},{key:"hoverCursorFadeAlpha",get:function(){return this.configuration.hoverCursorFadeAlpha},set:function(x){if(typeof x!="number")throw new Error("Attempting to set freehandSculpter hoverCursorFadeAlpha to a value other than a number.");x=Math.max(Math.min(x,1),0),this.configuration.hoverCursorFadeAlpha=x,c.default.cornerstone.updateImage(this.element)}},{key:"hoverCursorFadeDistance",get:function(){return this.configuration.hoverCursorFadeDistance},set:function(x){if(typeof x!="number")throw new Error("Attempting to set freehandSculpter hoverCursorFadeDistance to a value other than a number.");x=Math.max(x,1),this.configuration.hoverCursorFadeDistance=x,c.default.cornerstone.updateImage(this.element)}}],[{key:"_getCorrectedPair",value:function(x,j){var p=[x[0]-j,x[1]-j];return p[1]<0&&(p[1]=0),p}},{key:"_getNextHandleIndex",value:function(x,j){return x===j-1?0:x+1}},{key:"_getPreviousHandleIndex",value:function(x,j){return x===0?j-1:x-1}},{key:"_getNextHandleIndexBeforeInsert",value:function(x,j){return x===j?0:x}}]),b}(O.default);function A(){return{mouseLocation:{handles:{start:{highlight:!0,active:!0}}},minSpacing:1,currentTool:null,dragColor:m.default.getActiveColor(),hoverColor:m.default.getToolColor(),showCursorOnHover:!0,limitRadiusOutsideRegion:!0,hoverCursorFadeAlpha:.5,hoverCursorFadeDistance:1.2}}function U(B){B.stopImmediatePropagation(),B.stopPropagation(),B.preventDefault()}},"./tools/MagnifyTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return P});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=e.n(o),l=e("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),a=e.n(l),i=e("../node_modules/@babel/runtime/helpers/inherits.js"),h=e.n(i),g=e("./externalModules.js"),c=e("./drawing/index.js"),m=e("./tools/base/BaseTool.js"),E=e("./store/setToolCursor.js"),T=e("./tools/cursors/index.js"),P=function(M){h()(C,M);function C(){var O,I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u()(this,C);var _={name:"Magnify",supportedInteractionTypes:["Mouse","Touch"],configuration:{magnifySize:300,magnificationLevel:2},svgCursor:T.magnifyCursor};return O=t()(this,s()(C).call(this,I,_)),O.zoomCanvas=void 0,O.zoomElement=void 0,O.activeCallback=O._createMagnificationCanvas.bind(a()(O)),O.enabledCallback=O._createMagnificationCanvas.bind(a()(O)),O.disabledCallback=O._destroyMagnificationCanvas.bind(a()(O)),O.postTouchStartCallback=O._addMagnifyingGlass.bind(a()(O)),O.touchDragCallback=O._updateMagnifyingGlass.bind(a()(O)),O.touchEndCallback=O._removeMagnifyingGlass.bind(a()(O)),O.touchDragEndCallback=O._removeMagnifyingGlass.bind(a()(O)),O.postMouseDownCallback=O._addMagnifyingGlass.bind(a()(O)),O.mouseDragCallback=O._updateMagnifyingGlass.bind(a()(O)),O.mouseUpCallback=O._removeMagnifyingGlass.bind(a()(O)),O.mouseClickCallback=O._removeMagnifyingGlass.bind(a()(O)),O.newImageCallback=O._drawMagnificationTool.bind(a()(O)),O}return v()(C,[{key:"_addMagnifyingGlass",value:function(I){var _=this;this._removeZoomElement(),this._drawZoomedElement(I),window.requestAnimationFrame(function(){return _._drawMagnificationTool(I)}),Object(E.hideToolCursor)(I.detail.element),I.preventDefault(),I.stopPropagation()}},{key:"_updateMagnifyingGlass",value:function(I){this._drawMagnificationTool(I),I.preventDefault(),I.stopPropagation()}},{key:"_removeMagnifyingGlass",value:function(I){var _=I.detail.element;Object(E.setToolCursor)(this.element,this.svgCursor),_.querySelector(".magnifyTool").style.display="none",this._removeZoomElement()}},{key:"_drawMagnificationTool",value:function(I){var _=I.detail.element,D=_.querySelector(".magnifyTool");if(D||this._createMagnificationCanvas(_),this.zoomCanvas!==void 0){var L=_.querySelector("canvas:not(.magnifyTool)"),S=Object(c.getNewContext)(D),A=g.default.cornerstone.pixelToCanvas(I.detail.element,I.detail.currentPoints.image),U=Math.min(this.configuration.magnifySize,L.width,L.height),B=this.configuration.magnificationLevel;D.width=U,D.height=U,A.x=Math.max(A.x,.5*U/B),A.x=Math.min(A.x,L.width-.5*U/B),A.y=Math.max(A.y,.5*U/B),A.y=Math.min(A.y,L.height-.5*U/B);var b={x:A.x*B-.5*U,y:A.y*B-.5*U};b.x=Math.max(b.x,0),b.y=Math.max(b.y,0),S.drawImage(this.zoomCanvas,b.x,b.y,U,U,0,0,U,U);var y=I.detail.isTouchEvent?120:0,x={top:Math.max(A.y-.5*U-y,0),left:Math.max(A.x-.5*U,0)},j=D.getBoundingClientRect();x.top=Math.min(x.top,L.height-j.height),x.left=Math.min(x.left,L.width-j.width),D.style.top="".concat(x.top,"px"),D.style.left="".concat(x.left,"px"),D.style.display="block"}}},{key:"_drawZoomedElement",value:function(I){var _=I.detail.element,D=I.detail.enabledElement;D===void 0&&(D=g.default.cornerstone.getEnabledElement(_));var L=this.configuration.magnificationLevel,S=D.canvas,A=D.image;this.zoomElement||(this.zoomElement=document.createElement("div"),this.zoomElement.width=S.width*L,this.zoomElement.height=S.height*L,g.default.cornerstone.enable(this.zoomElement,D.options));var U=g.default.cornerstone.getEnabledElement(this.zoomElement),B=g.default.cornerstone.getViewport(D.element);this.zoomCanvas=U.canvas,this.zoomCanvas.width=S.width*L,this.zoomCanvas.height=S.height*L,U.viewport=Object.assign({},B),B.scale*=L,g.default.cornerstone.displayImage(this.zoomElement,A),g.default.cornerstone.setViewport(this.zoomElement,B)}},{key:"_removeZoomElement",value:function(){this.zoomElement!==void 0&&(g.default.cornerstone.disable(this.zoomElement),this.zoomElement=void 0,this.zoomCanvas=void 0)}},{key:"_createMagnificationCanvas",value:function(I){if(I.querySelector(".magnifyTool")===null){var _=document.createElement("canvas");_.classList.add("magnifyTool"),_.width=this.configuration.magnifySize,_.height=this.configuration.magnifySize,_.style.position="absolute",_.style.display="none",I.appendChild(_)}}},{key:"_destroyMagnificationCanvas",value:function(I){var _=I.querySelector(".magnifyTool");_&&I.removeChild(_)}}]),C}(m.default)},"./tools/OrientationMarkersTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return T});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=e.n(o),l=e("../node_modules/@babel/runtime/helpers/inherits.js"),a=e.n(l),i=e("./externalModules.js"),h=e("./tools/base/BaseTool.js"),g=e("./orientation/index.js"),c=e("./drawing/index.js"),m=e("./stateManagement/toolColors.js"),E=e("./drawing/drawTextBox.js"),T=function(I){a()(_,I);function _(){var D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u()(this,_);var L={name:"OrientationMarkers",configuration:{drawAllMarkers:!0},mixins:["enabledOrDisabledBinaryTool"]};return t()(this,s()(_).call(this,D,L))}return v()(_,[{key:"enabledCallback",value:function(L){this.forceImageUpdate(L)}},{key:"disabledCallback",value:function(L){this.forceImageUpdate(L)}},{key:"forceImageUpdate",value:function(L){var S=i.default.cornerstone,A=S.getEnabledElement(L);A.image&&S.updateImage(L)}},{key:"renderToolData",value:function(L){var S=L.detail,A=Object(c.getNewContext)(S.canvasContext.canvas),U=S.element,B=C(U);if(B){var b=O(U),y=m.default.getToolColor(),x={top:Object(E.textBoxWidth)(A,B.top,0),left:Object(E.textBoxWidth)(A,B.left,0),right:Object(E.textBoxWidth)(A,B.right,0),bottom:Object(E.textBoxWidth)(A,B.bottom,0),height:Object(E.textBoxWidth)(A,"M",0)};P(A,B,b,x,y),this.configuration.drawAllMarkers&&M(A,B,b,x,y)}}}]),_}(h.default),P=function(_,D,L,S,A){Object(E.default)(_,D.top,L.top.x-S.top/2,L.top.y,A),Object(E.default)(_,D.left,L.left.x-S.left/2,L.left.y,A)},M=function(_,D,L,S,A){Object(E.default)(_,D.right,L.right.x-S.right,L.right.y,A),Object(E.default)(_,D.bottom,L.bottom.x-S.bottom/2,L.bottom.y-S.height,A)},C=function(_){var D=i.default.cornerstone,L=D.getEnabledElement(_),S=D.metaData.get("imagePlaneModule",L.image.imageId);if(!(!S||!S.rowCosines||!S.columnCosines)){var A=g.default.getOrientationString(S.rowCosines),U=g.default.getOrientationString(S.columnCosines),B=g.default.invertOrientationString(A),b=g.default.invertOrientationString(U);return{top:b,bottom:U,left:B,right:A}}},O=function(_){var D=i.default.cornerstone.getEnabledElement(_),L=i.default.cornerstone.pixelToCanvas(_,{x:D.image.width/2,y:5}),S=i.default.cornerstone.pixelToCanvas(_,{x:D.image.width/2,y:D.image.height-15}),A=i.default.cornerstone.pixelToCanvas(_,{x:5,y:D.image.height/2}),U=i.default.cornerstone.pixelToCanvas(_,{x:D.image.width-10,y:D.image.height/2});return{top:L,bottom:S,left:A,right:U}}},"./tools/OverlayTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return m});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=e.n(o),l=e("../node_modules/@babel/runtime/helpers/inherits.js"),a=e.n(l),i=e("./store/index.js"),h=e("./externalModules.js"),g=e("./tools/base/BaseTool.js"),c=i.modules.globalConfiguration,m=function(E){a()(T,E);function T(){var P,M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u()(this,T);var C={name:"Overlay",configuration:{},mixins:["enabledOrDisabledBinaryTool"]},O=Object.assign(C,M);return P=t()(this,s()(T).call(this,O)),P.initialConfiguration=O,P}return v()(T,[{key:"enabledCallback",value:function(M){this.forceImageUpdate(M)}},{key:"disabledCallback",value:function(M){this.forceImageUpdate(M)}},{key:"forceImageUpdate",value:function(M){var C=h.default.cornerstone.getEnabledElement(M);C.image&&h.default.cornerstone.updateImage(M)}},{key:"setupRender",value:function(M){if(M){var C=h.default.cornerstone.metaData.get("overlayPlaneModule",M.imageId);if(!(!C||!C.overlays||!C.overlays.length))return C}}},{key:"setupViewport",value:function(M){if(M.overlayColor===void 0&&(M.overlayColor=c.configuration.overlayColor||"white"),M.overlayColor!==!1)return!0}},{key:"renderToolData",value:function(M){var C=M.detail,O=C.enabledElement,I=C.image,_=C.viewport,D=C.canvasContext,L=this.setupRender(I);if(!(!C||!O||!L)&&this.setupViewport(_)){var S=I.columns,A=I.rows;L.overlays.forEach(function(U){if(U.visible!==!1){var B=document.createElement("canvas");B.width=S,B.height=A;var b=B.getContext("2d");b.fillStyle=U.fillStyle||_.overlayColor,U.type==="R"&&(b.fillRect(0,0,B.width,B.height),b.globalCompositeOperation="xor");for(var y=0,x=0;x<U.rows;x++)for(var j=0;j<U.columns;j++)U.pixelData[y++]>0&&b.fillRect(j,x,1,1);var p=!isNaN(parseFloat(U.x))&&isFinite(U.x)?U.x:0,R=!isNaN(parseFloat(U.y))&&isFinite(U.y)?U.y:0;D.drawImage(B,p,R)}})}}}]),T}(g.default)},"./tools/PanMultiTouchTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return m});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=e.n(o),l=e("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),a=e.n(l),i=e("../node_modules/@babel/runtime/helpers/inherits.js"),h=e.n(i),g=e("./externalModules.js"),c=e("./tools/base/BaseTool.js"),m=function(E){h()(T,E);function T(){var P,M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u()(this,T);var C={name:"PanMultiTouch",supportedInteractionTypes:["MultiTouch"],configuration:{touchPointers:2}};return P=t()(this,s()(T).call(this,M,C)),P.multiTouchDragCallback=P._dragCallback.bind(a()(P)),P}return v()(T,[{key:"_dragCallback",value:function(M){var C=M.detail,O=C.element,I=C.viewport;if(C.numPointers===this.configuration.touchPointers){var _=this._getTranslation(C);this._applyTranslation(I,_),g.default.cornerstone.setViewport(O,I)}}},{key:"_getTranslation",value:function(M){var C=M.viewport,O=M.image,I=M.deltaPoints,_=C.scale,D=C.scale;return O.rowPixelSpacing<O.columnPixelSpacing?_*=O.columnPixelSpacing/O.rowPixelSpacing:O.columnPixelSpacing<O.rowPixelSpacing&&(D*=O.rowPixelSpacing/O.columnPixelSpacing),{x:I.page.x/_,y:I.page.y/D}}},{key:"_applyTranslation",value:function(M,C){M.translation.x+=C.x,M.translation.y+=C.y}}]),T}(c.default)},"./tools/PanTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return E});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=e.n(o),l=e("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),a=e.n(l),i=e("../node_modules/@babel/runtime/helpers/inherits.js"),h=e.n(i),g=e("./externalModules.js"),c=e("./tools/base/BaseTool.js"),m=e("./tools/cursors/index.js"),E=function(T){h()(P,T);function P(){var M,C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u()(this,P);var O={name:"Pan",supportedInteractionTypes:["Mouse","Touch"],svgCursor:m.panCursor};return M=t()(this,s()(P).call(this,C,O)),M.touchDragCallback=M._dragCallback.bind(a()(M)),M.mouseDragCallback=M._dragCallback.bind(a()(M)),M}return v()(P,[{key:"_dragCallback",value:function(C){var O=C.detail,I=O.element,_=O.viewport,D=this._getTranslation(O);this._applyTranslation(_,D),g.default.cornerstone.setViewport(I,_)}},{key:"_getTranslation",value:function(C){var O=C.viewport,I=C.image,_=C.deltaPoints,D=O.scale,L=O.scale;return I.rowPixelSpacing<I.columnPixelSpacing?D*=I.columnPixelSpacing/I.rowPixelSpacing:I.columnPixelSpacing<I.rowPixelSpacing&&(L*=I.rowPixelSpacing/I.columnPixelSpacing),{x:_.page.x/D,y:_.page.y/L}}},{key:"_applyTranslation",value:function(C,O){C.translation.x+=O.x,C.translation.y+=O.y}}]),P}(c.default)},"./tools/ReferenceLinesTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return I});var r=e("../node_modules/@babel/runtime/regenerator/index.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/asyncToGenerator.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/createClass.js"),s=e.n(o),l=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),a=e.n(l),i=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),h=e.n(i),g=e("../node_modules/@babel/runtime/helpers/inherits.js"),c=e.n(g),m=e("./externalModules.js"),E=e("./tools/base/BaseTool.js"),T=e("./drawing/index.js"),P=e("./tools/referenceLines/renderActiveReferenceLine.js"),M=e("./util/wait.js"),C=e("./util/logger.js"),O=Object(C.getLogger)("tools:ReferenceLinesTool"),I=function(_){c()(D,_);function D(){var L,S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};t()(this,D);var A={name:"ReferenceLines",mixins:["enabledOrDisabledBinaryTool"],configuration:{renderer:P.default}};return L=a()(this,h()(D).call(this,S,A)),L.renderer=null,L.synchronizationContext=null,L}return s()(D,[{key:"enabledCallback",value:function(){var L=v()(u.a.mark(function A(U){var B,b,y,x,j=arguments;return u.a.wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return B=j.length>1&&j[1]!==void 0?j[1]:{},b=B.synchronizationContext,y=this.configuration.renderer,R.next=4,Object(M.waitForEnabledElementImageToLoad)(U);case 4:if(x=R.sent,!(!x||!y||!b)){R.next=8;break}return O.warn("Unable to enable ".concat(this.name,". Exiting enable callback. Tool will be enabled, but will not render.")),R.abrupt("return");case 8:this.renderer=y,this.synchronizationContext=b,this.forceImageUpdate(U);case 11:case"end":return R.stop()}},A,this)}));function S(A){return L.apply(this,arguments)}return S}()},{key:"disabledCallback",value:function(S){this.forceImageUpdate(S)}},{key:"forceImageUpdate",value:function(S){var A=m.default.cornerstone.getEnabledElement(S);A.image&&m.default.cornerstone.updateImage(S)}},{key:"renderToolData",value:function(S){var A=this,U=S.detail;if(!(!this.renderer||!this.synchronizationContext)){var B=this.synchronizationContext.getSourceElements(),b=Object(T.getNewContext)(U.canvasContext.canvas);m.default.cornerstone.setToPixelCoordinateSystem(U.enabledElement,b),B.forEach(function(y){y!==S.currentTarget&&A.renderer(b,U,S.currentTarget,y)})}}}]),D}(E.default)},"./tools/RotateTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return m});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=e.n(o),l=e("../node_modules/@babel/runtime/helpers/inherits.js"),a=e.n(l),i=e("./externalModules.js"),h=e("./tools/base/BaseTool.js"),g=e("./util/angleBetweenPoints.js"),c=e("./tools/cursors/index.js"),m=function(M){a()(C,M);function C(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u()(this,C);var I={name:"Rotate",strategies:{default:E,horizontal:T,vertical:P},defaultStrategy:"default",supportedInteractionTypes:["Mouse","Touch"],configuration:{roundAngles:!1,flipHorizontal:!1,flipVertical:!1,rotateScale:1},svgCursor:c.rotateCursor};return t()(this,s()(C).call(this,O,I))}return v()(C,[{key:"touchDragCallback",value:function(I){this.dragCallback(I)}},{key:"mouseDragCallback",value:function(I){this.dragCallback(I)}},{key:"postMouseDownCallback",value:function(I){this.initialRotation=I.detail.viewport.rotation}},{key:"dragCallback",value:function(I){I.detail.viewport.initialRotation=this.initialRotation,this.applyActiveStrategy(I),i.default.cornerstone.setViewport(I.detail.element,I.detail.viewport)}}]),C}(h.default);function E(M){var C=this.configuration,O=C.roundAngles,I=C.rotateScale,_=M.detail,D=_.element,L=_.viewport,S=_.startPoints,A=_.currentPoints,U=L.initialRotation?L.initialRotation:L.rotation,B=D.getBoundingClientRect(D),b=D.clientWidth,y=D.clientHeight,x=L.scale,j=L.translation,p={x:B.left+b/2+j.x*x,y:B.top+y/2+j.y*x},R=Object(g.default)(p,S.client,A.client);R.angle*=I,O&&(R.angle=Math.ceil(R.angle)),R.direction<0&&(R.angle=-R.angle),L.rotation=U+R.angle}function T(M){var C=this.configuration,O=C.roundAngles,I=C.flipHorizontal,_=C.rotateScale,D=M.detail,L=D.viewport,S=D.startPoints,A=D.currentPoints,U=L.initialRotation,B=S.client.x,b=A.client.x,y=(b-B)*_;O&&(y=Math.round(Math.abs(y))*(y>0?1:-1)),I&&(y=-y),L.rotation=U+y}function P(M){var C=this.configuration,O=C.roundAngles,I=C.flipVertical,_=C.rotateScale,D=M.detail,L=D.viewport,S=D.startPoints,A=D.currentPoints,U=L.initialRotation,B=S.client.y,b=A.client.y,y=(b-B)*_;O&&(y=Math.round(Math.abs(y))*(y>0?1:-1)),I&&(y=-y),L.rotation=U+y}},"./tools/RotateTouchTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return g});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=e.n(o),l=e("../node_modules/@babel/runtime/helpers/inherits.js"),a=e.n(l),i=e("./externalModules.js"),h=e("./tools/base/BaseTool.js"),g=function(c){a()(m,c);function m(){var E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u()(this,m);var T={name:"RotateTouch",supportedInteractionTypes:["TouchRotate"]};return t()(this,s()(m).call(this,E,T))}return v()(m,[{key:"touchRotateCallback",value:function(T){var P=T.detail,M=P.element,C=P.viewport,O=P.rotation;C.rotation+=O,i.default.cornerstone.setViewport(M,C)}}]),m}(h.default)},"./tools/ScaleOverlayTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return P});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=e.n(o),l=e("../node_modules/@babel/runtime/helpers/inherits.js"),a=e.n(l),i=e("./externalModules.js"),h=e("./tools/base/BaseTool.js"),g=e("./drawing/index.js"),c=e("./stateManagement/toolStyle.js"),m=e("./stateManagement/toolColors.js"),E=e("./util/logger.js"),T=Object(E.getLogger)("tools:ScaleOverlayTool"),P=function(I){a()(_,I);function _(){var D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u()(this,_);var L={name:"ScaleOverlay",configuration:{minorTickLength:12.5,majorTickLength:25},mixins:["enabledOrDisabledBinaryTool"]};return t()(this,s()(_).call(this,D,L))}return v()(_,[{key:"enabledCallback",value:function(L){this.forceImageUpdate(L)}},{key:"disabledCallback",value:function(L){this.forceImageUpdate(L)}},{key:"forceImageUpdate",value:function(L){var S=i.default.cornerstone.getEnabledElement(L);S.image&&i.default.cornerstone.updateImage(L)}},{key:"renderToolData",value:function(L){var S=L.detail,A=Object(g.getNewContext)(S.canvasContext.canvas),U=S.image,B=S.viewport,b=S.element,y=U.rowPixelSpacing,x=U.columnPixelSpacing,j=i.default.cornerstone.metaData.get("imagePlaneModule",U.imageId);if(j&&(y=j.rowPixelSpacing||j.rowImagePixelSpacing,x=j.columnPixelSpacing||j.colImagePixelSpacing),!y||!x){T.warn("unable to define rowPixelSpacing or colPixelSpacing from data on ".concat(this.name,"'s renderToolData"));return}var p={width:A.canvas.width,height:A.canvas.height},R=10/y*B.scale,W=10/x*B.scale,K=M(p,.25,.05),N=M(p,.05,.15);if(!(!p.width||!p.height||!K||!N)){var z=m.default.getToolColor(),Y=c.default.getToolWidth(),$=Object.assign({},{hscaleBounds:K,vscaleBounds:N,verticalMinorTick:R,horizontalMinorTick:W,verticalLine:{start:{x:N.bottomRight.x,y:N.topLeft.y},end:{x:N.bottomRight.x,y:N.bottomRight.y}},horizontalLine:{start:{x:K.topLeft.x,y:K.bottomRight.y},end:{x:K.bottomRight.x,y:K.bottomRight.y}},color:z,lineWidth:Y},this.configuration);Object(g.draw)(A,function(J){Object(g.setShadow)(J,$),Object(g.drawLine)(J,b,$.verticalLine.start,$.verticalLine.end,{color:$.color,lineWidth:$.lineWidth},"canvas"),C(J,b,$),Object(g.drawLine)(J,b,$.horizontalLine.start,$.horizontalLine.end,{color:$.color,lineWidth:$.lineWidth},"canvas"),O(J,b,$)})}}}]),_}(h.default),M=function(_,D,L){var S=D*Math.min(1e3,_.width),A=L*Math.min(1e3,_.height),U={left:S,top:A,width:_.width-2*S,height:_.height-2*A};return{topLeft:{x:U.left,y:U.top},bottomRight:{x:U.left+U.width,y:U.top+U.height}}},C=function(_,D,L){for(var S=0;L.verticalLine.start.y+S*L.verticalMinorTick<=L.vscaleBounds.bottomRight.y;){var A=L.color,U=L.lineWidth,B={x:L.verticalLine.start.x,y:L.verticalLine.start.y+S*L.verticalMinorTick},b={x:0,y:L.verticalLine.start.y+S*L.verticalMinorTick};S%5===0?b.x=L.verticalLine.start.x-L.majorTickLength:b.x=L.verticalLine.start.x-L.minorTickLength,Object(g.drawLine)(_,D,B,b,{color:A,lineWidth:U},"canvas"),S++}},O=function(_,D,L){for(var S=0;L.horizontalLine.start.x+S*L.horizontalMinorTick<=L.hscaleBounds.bottomRight.x;){var A=L.color,U=L.lineWidth,B={x:L.horizontalLine.start.x+S*L.horizontalMinorTick,y:L.horizontalLine.start.y},b={x:L.horizontalLine.start.x+S*L.horizontalMinorTick,y:0};S%5===0?b.y=L.horizontalLine.start.y-L.majorTickLength:b.y=L.horizontalLine.start.y-L.minorTickLength,Object(g.drawLine)(_,D,B,b,{color:A,lineWidth:U},"canvas"),S++}}},"./tools/StackScrollMouseWheelTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return g});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=e.n(o),l=e("../node_modules/@babel/runtime/helpers/inherits.js"),a=e.n(l),i=e("./tools/base/BaseTool.js"),h=e("./util/scroll.js"),g=function(c){a()(m,c);function m(){var E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u()(this,m);var T={name:"StackScrollMouseWheel",supportedInteractionTypes:["MouseWheel"],configuration:{loop:!1,allowSkipping:!0,invert:!1}};return t()(this,s()(m).call(this,E,T))}return v()(m,[{key:"mouseWheelCallback",value:function(T){var P=T.detail,M=P.direction,C=P.element,O=this.configuration,I=O.loop,_=O.allowSkipping,D=O.invert,L=D?-M:M;Object(h.default)(C,L,I,_)}}]),m}(i.default)},"./tools/StackScrollMultiTouchTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return T});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=e.n(o),l=e("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),a=e.n(l),i=e("../node_modules/@babel/runtime/helpers/inherits.js"),h=e.n(i),g=e("./tools/base/BaseTool.js"),c=e("./util/scroll.js"),m=e("./stateManagement/toolState.js"),E=e("./toolOptions.js"),T=function(P){h()(M,P);function M(){var C,O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u()(this,M);var I={name:"StackScrollMultiTouch",supportedInteractionTypes:["MultiTouch"],configuration:{loop:!1,allowSkipping:!0,touchPointers:3}};return C=t()(this,s()(M).call(this,O,I)),C.multiTouchDragCallback=C._dragCallback.bind(a()(C)),C}return v()(M,[{key:"_dragCallback",value:function(O){var I=O.detail;if(I.numPointers===this.configuration.touchPointers){var _=I.element,D=I.deltaPoints,L=this.configuration,S=L.loop,A=L.allowSkipping,U=Object(E.getToolOptions)(this.name,_),B=this._getPixelPerImage(_),b=this._getDeltaY(_,D.page.y);if(!B)return;if(Math.abs(b)>=B){var y=Math.round(b/B);Object(c.default)(_,y,S,A),U.deltaY=b%B}else U.deltaY=b;Object(E.setToolOptions)(this.name,_,U)}}},{key:"_getDeltaY",value:function(O,I){var _=Object(E.getToolOptions)(this.name,O),D=_.deltaY||0;return D+I}},{key:"_getPixelPerImage",value:function(O){var I=Object(m.getToolState)(O,"stack");if(!(!I||!I.data||!I.data.length)){var _=I.data[0],D=this.configuration.stackScrollSpeed;return D||Math.max(2,O.offsetHeight/Math.max(_.imageIds.length,8))}}}]),M}(g.default)},"./tools/StackScrollTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return P});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=e.n(o),l=e("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),a=e.n(l),i=e("../node_modules/@babel/runtime/helpers/inherits.js"),h=e.n(i),g=e("./tools/base/BaseTool.js"),c=e("./util/scroll.js"),m=e("./stateManagement/toolState.js"),E=e("./toolOptions.js"),T=e("./tools/cursors/index.js"),P=function(M){h()(C,M);function C(){var O,I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u()(this,C);var _={name:"StackScroll",supportedInteractionTypes:["Mouse","Touch"],configuration:{loop:!1,allowSkipping:!0},svgCursor:T.stackScrollCursor};return O=t()(this,s()(C).call(this,I,_)),O.mouseDragCallback=O._dragCallback.bind(a()(O)),O.touchDragCallback=O._dragCallback.bind(a()(O)),O}return v()(C,[{key:"_dragCallback",value:function(I){var _=I.detail,D=_.element,L=_.deltaPoints,S=this.configuration,A=S.loop,U=S.allowSkipping,B=Object(E.getToolOptions)(this.name,D),b=this._getPixelPerImage(D),y=this._getDeltaY(D,L.page.y);if(b){if(Math.abs(y)>=b){var x=Math.round(y/b);Object(c.default)(D,x,A,U),B.deltaY=y%b}else B.deltaY=y;Object(E.setToolOptions)(this.name,D,B)}}},{key:"_getDeltaY",value:function(I,_){var D=Object(E.getToolOptions)(this.name,I),L=D.deltaY||0;return L+_}},{key:"_getPixelPerImage",value:function(I){var _=Object(m.getToolState)(I,"stack");if(!(!_||!_.data||!_.data.length)){var D=_.data[0],L=this.configuration.stackScrollSpeed;return L||Math.max(2,I.offsetHeight/Math.max(D.imageIds.length,8))}}}]),C}(g.default)},"./tools/WwwcRegionTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return C});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=e.n(o),l=e("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),a=e.n(l),i=e("../node_modules/@babel/runtime/helpers/inherits.js"),h=e.n(i),g=e("./externalModules.js"),c=e("./tools/base/BaseTool.js"),m=e("./drawing/index.js"),E=e("./util/clip.js"),T=e("./util/getLuminance.js"),P=e("./stateManagement/toolColors.js"),M=e("./tools/cursors/index.js"),C=function(D){h()(L,D);function L(){var S,A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u()(this,L);var U={name:"WwwcRegion",supportedInteractionTypes:["Mouse","Touch"],configuration:{minWindowWidth:10},svgCursor:M.wwwcRegionCursor};return S=t()(this,s()(L).call(this,A,U)),S._resetHandles(),S.postTouchStartCallback=S._startOutliningRegion.bind(a()(S)),S.touchDragCallback=S._setHandlesAndUpdate.bind(a()(S)),S.touchEndCallback=S._applyStrategy.bind(a()(S)),S.postMouseDownCallback=S._startOutliningRegion.bind(a()(S)),S.mouseClickCallback=S._startOutliningRegion.bind(a()(S)),S.mouseDragCallback=S._setHandlesAndUpdate.bind(a()(S)),S.mouseMoveCallback=S._setHandlesAndUpdate.bind(a()(S)),S.mouseUpCallback=S._applyStrategy.bind(a()(S)),S}return v()(L,[{key:"renderToolData",value:function(A){var U=this,B=A.detail,b=B.element,y=P.default.getColorIfActive({active:!0}),x=Object(m.getNewContext)(B.canvasContext.canvas);Object(m.draw)(x,function(j){Object(m.drawRect)(j,b,U.handles.start,U.handles.end,{color:y})})}},{key:"_startOutliningRegion",value:function(A){var U=!0,B=A.detail.element,b=A.detail.currentPoints.image;return O(this.handles.start)?this.handles.start=b:(this.handles.end=b,this._applyStrategy(A)),g.default.cornerstone.updateImage(B),U}},{key:"_setHandlesAndUpdate",value:function(A){var U=A.detail.element,B=A.detail.currentPoints.image;this.handles.end=B,g.default.cornerstone.updateImage(U)}},{key:"_applyStrategy",value:function(A){O(this.handles.start)||O(this.handles.end)||(A.detail.handles=this.handles,I(A,this.configuration),this._resetHandles())}},{key:"_resetHandles",value:function(){this.handles={start:{},end:{}}}}]),L}(c.default),O=function(L){return Object.keys(L).length===0&&L.constructor===Object},I=function(L,S){var A=L.detail,U=A.image,B=A.element,b=L.detail.handles,y=b.start,x=b.end,j=Math.min(y.x,x.x),p=Math.min(y.y,x.y),R=Math.abs(y.x-x.x),W=Math.abs(y.y-x.y);j=Object(E.default)(j,0,U.width),p=Object(E.default)(p,0,U.height),R=Math.floor(Math.min(R,Math.abs(U.width-j))),W=Math.floor(Math.min(W,Math.abs(U.height-p)));var K=Object(T.default)(B,j,p,R,W),N=_(K,U.minPixelValue,U.maxPixelValue),z=A.viewport;S.minWindowWidth===void 0&&(S.minWindowWidth=10),z.voi.windowWidth=Math.max(Math.abs(N.max-N.min),S.minWindowWidth),z.voi.windowCenter=N.mean,z.voiLUT=void 0,g.default.cornerstone.setViewport(B,z),g.default.cornerstone.updateImage(B)},_=function(L,S,A){var U=L.length,B=A,b=S,y=0;if(U<2)return{min:B,max:b,mean:(S+A)/2};for(var x=0;x<U;x++){var j=L[x];B=Math.min(B,j),b=Math.max(b,j),y+=j}return{min:B,max:b,mean:y/U}}},"./tools/WwwcTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return c});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=e.n(o),l=e("../node_modules/@babel/runtime/helpers/inherits.js"),a=e.n(l),i=e("./externalModules.js"),h=e("./tools/base/BaseTool.js"),g=e("./tools/cursors/index.js"),c=function(E){a()(T,E);function T(){var P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u()(this,T);var M={name:"Wwwc",strategies:{basicLevelingStrategy:m},supportedInteractionTypes:["Mouse","Touch"],configuration:{orientation:0},svgCursor:g.wwwcCursor};return t()(this,s()(T).call(this,P,M))}return v()(T,[{key:"mouseDragCallback",value:function(M){this.applyActiveStrategy(M),i.default.cornerstone.setViewport(M.detail.element,M.detail.viewport)}},{key:"touchDragCallback",value:function(M){M.stopImmediatePropagation(),this.applyActiveStrategy(M),i.default.cornerstone.setViewport(M.detail.element,M.detail.viewport)}}]),T}(h.default);function m(E){var T=this.configuration.orientation,P=E.detail,M=P.image.maxPixelValue*P.image.slope+P.image.intercept,C=P.image.minPixelValue*P.image.slope+P.image.intercept,O=M-C,I=O/1024,_=P.deltaPoints.page.x*I,D=P.deltaPoints.page.y*I;T===0?(P.viewport.voi.windowWidth+=_,P.viewport.voi.windowCenter+=D):(P.viewport.voi.windowWidth+=D,P.viewport.voi.windowCenter+=_),P.viewport.voiLUT=void 0}},"./tools/ZoomMouseWheelTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return c});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=e.n(o),l=e("../node_modules/@babel/runtime/helpers/inherits.js"),a=e.n(l),i=e("./externalModules.js"),h=e("./tools/base/BaseTool.js"),g=e("./util/zoom/index.js"),c=function(m){a()(E,m);function E(){var T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u()(this,E);var P={name:"ZoomMouseWheel",supportedInteractionTypes:["MouseWheel"],configuration:{minScale:.25,maxScale:20,invert:!1}};return t()(this,s()(E).call(this,T,P))}return v()(E,[{key:"mouseWheelCallback",value:function(P){var M=P.detail,C=M.element,O=M.viewport,I=M.spinY,_=this.configuration,D=_.invert,L=_.maxScale,S=_.minScale,A=D?I/4:-I/4,U=Object(g.changeViewportScale)(O,A,{maxScale:L,minScale:S});i.default.cornerstone.setViewport(C,U)}}]),E}(h.default)},"./tools/ZoomTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return P});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=e.n(o),l=e("../node_modules/@babel/runtime/helpers/inherits.js"),a=e.n(l),i=e("./externalModules.js"),h=e("./tools/base/BaseTool.js"),g=e("./util/clip.js"),c=e("./util/zoom/index.js"),m=e("./tools/cursors/index.js"),E=c.default.correctShift,T=c.default.changeViewportScale,P=function(_){a()(D,_);function D(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u()(this,D);var S={name:"Zoom",strategies:{default:C,translate:O,zoomToCenter:I},defaultStrategy:"default",supportedInteractionTypes:["Mouse","Touch"],configuration:{invert:!1,preventZoomOutsideImage:!1,minScale:.25,maxScale:20},svgCursor:m.zoomCursor};return t()(this,s()(D).call(this,L,S))}return v()(D,[{key:"touchDragCallback",value:function(S){M.call(this,S)}},{key:"mouseDragCallback",value:function(S){M.call(this,S)}}]),D}(h.default),M=function(D){var L=D.detail.deltaPoints.page.y;if(!L)return!1;this.applyActiveStrategy(D,this.configuration),i.default.cornerstone.setViewport(D.detail.element,D.detail.viewport)};function C(_){var D=this.configuration,L=D.invert,S=D.maxScale,A=D.minScale,U=_.detail.deltaPoints.page.y,B=L?-U/100:U/100,b=_.detail,y=b.element,x=b.viewport,j=[_.detail.startPoints.page.x,_.detail.startPoints.page.y,_.detail.startPoints.image.x,_.detail.startPoints.image.y],p=j[0],R=j[1],W=j[2],K=j[3],N=T(x,B,{maxScale:S,minScale:A});i.default.cornerstone.setViewport(y,N);var z=i.default.cornerstone.pageToPixel(y,p,R),Y={x:W-z.x,y:K-z.y};Y=E(Y,N),x.translation.x-=Y.x,x.translation.y-=Y.y}function O(_){var D=this.configuration,L=D.invert,S=D.preventZoomOutsideImage,A=D.maxScale,U=D.minScale,B=_.detail.deltaPoints.page.y,b=L?-B/100:B/100,y=_.detail.image,x=_.detail.viewport,j=[_.detail.startPoints.image.x,_.detail.startPoints.image.y],p=j[0],R=j[1],W=T(x,b,{maxScale:A,minScale:U}),K={x:0,y:0},N=8,z=3,Y=.01;if(b<0)W.scale<z&&(Math.abs(W.translation.x)<Y?W.translation.x=0:K.x=W.translation.x/N,Math.abs(W.translation.y)<Y?W.translation.y=0:K.y=W.translation.y/N);else{S&&Object(g.clipToBox)(_.detail.startPoints.image,y);var $={x:y.width/2-p,y:y.height/2-R};$=E($,W);var J={x:W.translation.x-$.x,y:W.translation.y-$.y};Math.abs(J.x)<Y?W.translation.x=$.x:K.x=J.x/N,Math.abs(J.y)<Y?W.translation.y=$.y:K.y=J.y/N}W.translation.x-=K.x,W.translation.y-=K.y}function I(_){var D=this.configuration,L=D.invert,S=D.maxScale,A=D.minScale,U=_.detail.deltaPoints.page.y,B=L?-U/100:U/100,b=_.detail.viewport;T(b,B,{maxScale:S,minScale:A})}},"./tools/ZoomTouchPinchTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return m});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=e.n(o),l=e("../node_modules/@babel/runtime/helpers/inherits.js"),a=e.n(l),i=e("./externalModules.js"),h=e("./tools/base/BaseTool.js"),g=e("./util/zoom/index.js"),c=g.default.correctShift,m=function(E){a()(T,E);function T(){var P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u()(this,T);var M={name:"ZoomTouchPinch",supportedInteractionTypes:["TouchPinch"],configuration:{minScale:.25,maxScale:20}};return t()(this,s()(T).call(this,P,M))}return v()(T,[{key:"touchPinchCallback",value:function(M){var C=M.detail,O=C.element,I=C.viewport,_=C.scaleChange,D=[M.detail.startPoints.page.x,M.detail.startPoints.page.y,M.detail.startPoints.image.x,M.detail.startPoints.image.y],L=D[0],S=D[1],A=D[2],U=D[3],B=this.configuration,b=B.maxScale,y=B.minScale;I.scale+=_*I.scale,b&&I.scale>b?I.scale=b:y&&I.scale<y&&(I.scale=y),i.default.cornerstone.setViewport(O,I);var x=i.default.cornerstone.pageToPixel(O,L,S),j={x:A-x.x,y:U-x.y};j=c(j,I),I.translation.x-=j.x,I.translation.y-=j.y,i.default.cornerstone.setViewport(O,I)}}]),T}(h.default)},"./tools/annotation/AngleTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return B});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=e.n(o),l=e("../node_modules/@babel/runtime/helpers/inherits.js"),a=e.n(l),i=e("./externalModules.js"),h=e("./tools/base/BaseAnnotationTool.js"),g=e("./stateManagement/toolState.js"),c=e("./stateManagement/toolStyle.js"),m=e("./stateManagement/toolColors.js"),E=e("./manipulators/index.js"),T=e("./drawing/index.js"),P=e("./drawing/drawLinkedTextBox.js"),M=e("./drawing/drawTextBox.js"),C=e("./drawing/drawHandles.js"),O=e("./util/lineSegDistance.js"),I=e("./util/roundToDecimal.js"),_=e("./tools/cursors/index.js"),D=e("./util/triggerEvent.js"),L=e("./events.js"),S=e("./util/getPixelSpacing.js"),A=e("./util/throttle.js"),U=e("./store/index.js"),B=function(x){a()(j,x);function j(){var p,R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u()(this,j);var W={name:"Angle",supportedInteractionTypes:["Mouse","Touch"],svgCursor:_.angleCursor,configuration:{drawHandles:!0,drawHandlesOnHover:!1,hideHandlesIfMoving:!1,renderDashed:!1}};return p=t()(this,s()(j).call(this,R,W)),p.preventNewMeasurement=!1,p.throttledUpdateCachedStats=Object(A.default)(p.updateCachedStats,110),p}return v()(j,[{key:"createNewMeasurement",value:function(R){return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{start:{x:R.currentPoints.image.x,y:R.currentPoints.image.y,highlight:!0,active:!1},middle:{x:R.currentPoints.image.x,y:R.currentPoints.image.y,highlight:!0,active:!0},end:{x:R.currentPoints.image.x,y:R.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}},{key:"pointNearTool",value:function(R,W,K){return W.visible===!1?!1:Object(O.default)(R,W.handles.start,W.handles.middle,K)<25||Object(O.default)(R,W.handles.middle,W.handles.end,K)<25}},{key:"updateCachedStats",value:function(R,W,K){var N=y(R,K.handles.middle,K.handles.start),z=y(R,K.handles.end,K.handles.middle),Y=y(R,K.handles.end,K.handles.start),$=b(N),J=b(z),te=b(Y),ne=Math.acos((Math.pow($,2)+Math.pow(J,2)-Math.pow(te,2))/(2*$*J));ne*=180/Math.PI,K.rAngle=Object(I.default)(ne,2),K.invalidated=!1}},{key:"renderToolData",value:function(R){var W=this,K=R.detail,N=K.enabledElement,z=this.configuration,Y=z.handleRadius,$=z.drawHandlesOnHover,J=z.hideHandlesIfMoving,te=z.renderDashed,ne=Object(g.getToolState)(R.currentTarget,this.name),de=Object(U.getModule)("globalConfiguration").configuration.lineDash;if(!ne)return;for(var w=Object(T.getNewContext)(K.canvasContext.canvas),G=K.image,Z=K.element,Q=Object(S.default)(G),k=Q.rowPixelSpacing,ae=Q.colPixelSpacing,ee=c.default.getToolWidth(),oe=function(ge){var ie=ne.data[ge];if(ie.visible===!1)return"continue";Object(T.draw)(w,function(ve){Object(T.setShadow)(ve,W.configuration);var Me=m.default.getColorIfActive(ie),me=i.default.cornerstone.pixelToCanvas(K.element,ie.handles.start),De=i.default.cornerstone.pixelToCanvas(K.element,ie.handles.middle),Te={color:Me};te&&(Te.lineDash=de),Object(T.drawJoinedLines)(ve,K.element,ie.handles.start,[ie.handles.middle,ie.handles.end],Te);var Ce={color:Me,handleRadius:Y,drawHandlesIfActive:$,hideHandlesIfMoving:J};if(W.configuration.drawHandles&&Object(C.default)(ve,K,ie.handles,Ce),ie.invalidated===!0&&(ie.rAngle?W.throttledUpdateCachedStats(G,Z,ie):W.updateCachedStats(G,Z,ie)),ie.rAngle){var Ee=ce(ie,k,ae),Oe=15,_e;if(!ie.handles.textBox.hasMoved){_e={x:De.x,y:De.y};var je=5,Ie=Object(M.textBoxWidth)(ve,Ee,je);De.x<me.x?_e.x-=Oe+Ie+10:_e.x+=Oe;var xe=i.default.cornerstone.internal.getTransform(N);xe.invert();var Se=xe.transformPoint(_e.x,_e.y);ie.handles.textBox.x=Se.x,ie.handles.textBox.y=Se.y}Object(P.default)(ve,K.element,ie.handles.textBox,Ee,ie.handles,le,Me,ee,0,!0)}})},se=0;se<ne.data.length;se++)var re=oe(se);function ce(fe,ge,ie){var ve=!ge||!ie?" (isotropic)":"",Me="00B0";return fe.rAngle.toString()+String.fromCharCode(parseInt(Me,16))+ve}function le(fe){return[fe.start,fe.middle,fe.end]}}},{key:"addNewMeasurement",value:function(R,W){var K=this;if(!this.preventNewMeasurement){this.preventNewMeasurement=!0,R.preventDefault(),R.stopPropagation();var N=R.detail,z=this.createNewMeasurement(N),Y=R.detail.element;Object(g.addToolState)(Y,this.name,z),i.default.cornerstone.updateImage(Y),Object(E.moveNewHandle)(N,this.name,z,z.handles.middle,this.options,W,function($){if(z.active=!1,!$){Object(g.removeToolState)(Y,K.name,z),K.preventNewMeasurement=!1;return}z.handles.end.active=!0,i.default.cornerstone.updateImage(Y),Object(E.moveNewHandle)(N,K.name,z,z.handles.end,K.options,W,function(J){J?(z.active=!1,i.default.cornerstone.updateImage(Y)):Object(g.removeToolState)(Y,K.name,z),K.preventNewMeasurement=!1,i.default.cornerstone.updateImage(Y);var te={toolName:K.name,toolType:K.name,element:Y,measurementData:z};Object(D.default)(Y,L.default.MEASUREMENT_COMPLETED,te)})})}}}]),j}(h.default);function b(x){return Math.sqrt(Math.pow(x.x,2)+Math.pow(x.y,2))}function y(x,j,p){var R=Object(S.default)(x),W=R.rowPixelSpacing,K=R.colPixelSpacing;return{x:(j.x-p.x)*(K||1),y:(j.y-p.y)*(W||1)}}},"./tools/annotation/ArrowAnnotateTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return B});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=e.n(o),l=e("../node_modules/@babel/runtime/helpers/inherits.js"),a=e.n(l),i=e("./externalModules.js"),h=e("./tools/base/BaseAnnotationTool.js"),g=e("./events.js"),c=e("./stateManagement/toolStyle.js"),m=e("./stateManagement/textStyle.js"),E=e("./stateManagement/toolColors.js"),T=e("./manipulators/index.js"),P=e("./util/pointInsideBoundingBox.js"),M=e("./util/lineSegDistance.js"),C=e("./util/triggerEvent.js"),O=e("./stateManagement/toolState.js"),I=e("./drawing/drawLinkedTextBox.js"),_=e("./drawing/index.js"),D=e("./drawing/drawArrow.js"),L=e("./drawing/drawHandles.js"),S=e("./drawing/drawTextBox.js"),A=e("./tools/cursors/index.js"),U=e("./store/index.js"),B=function(x){a()(j,x);function j(){var p,R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u()(this,j);var W={name:"ArrowAnnotate",supportedInteractionTypes:["Mouse","Touch"],configuration:{getTextCallback:b,changeTextCallback:y,drawHandles:!0,drawHandlesOnHover:!1,hideHandlesIfMoving:!1,arrowFirst:!0,renderDashed:!1,allowEmptyLabel:!1},svgCursor:A.arrowAnnotateCursor};return p=t()(this,s()(j).call(this,R,W)),p.preventNewMeasurement=!1,p}return v()(j,[{key:"createNewMeasurement",value:function(R){return{visible:!0,active:!0,color:void 0,handles:{start:{x:R.detail.currentPoints.image.x,y:R.detail.currentPoints.image.y,highlight:!0,active:!1},end:{x:R.detail.currentPoints.image.x,y:R.detail.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}},{key:"pointNearTool",value:function(R,W,K){return W.visible===!1?!1:Object(M.default)(R,W.handles.start,W.handles.end,K)<25}},{key:"updateCachedStats",value:function(){}},{key:"renderToolData",value:function(R){var W=this,K=R.detail,N=K.element,z=K.enabledElement,Y=this.configuration,$=Y.handleRadius,J=Y.drawHandlesOnHover,te=Y.hideHandlesIfMoving,ne=Y.renderDashed,de=Object(O.getToolState)(N,this.name);if(!de)return;var w=R.detail.canvasContext.canvas,G=Object(_.getNewContext)(w),Z=c.default.getToolWidth(),Q;ne&&(Q=Object(U.getModule)("globalConfiguration").configuration.lineDash);for(var k=function(ce){var le=de.data[ce];if(le.visible===!1)return"continue";Object(_.draw)(G,function(fe){Object(_.setShadow)(fe,W.configuration);var ge=E.default.getColorIfActive(le),ie=i.default.cornerstone.pixelToCanvas(N,le.handles.start),ve=i.default.cornerstone.pixelToCanvas(N,le.handles.end);W.configuration.arrowFirst?Object(D.default)(fe,ve,ie,ge,Z,Q):Object(D.default)(fe,ie,ve,ge,Z,Q);var Me={color:ge,handleRadius:$,drawHandlesIfActive:J,hideHandlesIfMoving:te};W.configuration.drawHandles&&Object(L.default)(fe,R.detail,le.handles,Me);var me=oe(le);if(me&&me!==""){var De=5,Te=Object(S.textBoxWidth)(fe,me,De),Ce=m.default.getFontSize()+10,Ee=Math.max(Te,Ce)/2+5;if(ve.x<ie.x&&(Ee=-Ee),!le.handles.textBox.hasMoved){var Oe;W.configuration.arrowFirst?Oe={x:ve.x-Te/2+Ee,y:ve.y-Ce/2}:Oe={x:ie.x-Te/2-Ee,y:ie.y-Ce/2};var _e=i.default.cornerstone.internal.getTransform(z);_e.invert();var je=_e.transformPoint(Oe.x,Oe.y);le.handles.textBox.x=je.x,le.handles.textBox.y=je.y}Object(I.default)(fe,N,le.handles.textBox,me,le.handles,se,ge,Z,0,!1)}})},ae=0;ae<de.data.length;ae++)var ee=k(ae);function oe(re){return re.text}function se(re){var ce={x:(re.start.x+re.end.x)/2,y:(re.start.y+re.end.y)/2};return[re.start,ce,re.end]}}},{key:"addNewMeasurement",value:function(R,W){var K=this,N=R.detail.element,z=this.createNewMeasurement(R),Y=this.configuration.allowEmptyLabel;Object(O.addToolState)(N,this.name,z),i.default.cornerstone.updateImage(N),Object(T.moveNewHandle)(R.detail,this.name,z,z.handles.end,this.options,W,function($){$?z.text===void 0&&K.configuration.getTextCallback(function(J){if(J||Y){z.text=J,z.active=!1;var te={toolName:K.name,toolType:K.name,element:N,measurementData:z};i.default.cornerstone.updateImage(N),Object(C.default)(N,g.default.MEASUREMENT_COMPLETED,te)}else Object(O.removeToolState)(N,K.name,z)},R.detail):Object(O.removeToolState)(N,K.name,z),i.default.cornerstone.updateImage(N)})}},{key:"doubleClickCallback",value:function(R){return this._updateTextForNearbyAnnotation(R)}},{key:"touchPressCallback",value:function(R){return this._updateTextForNearbyAnnotation(R)}},{key:"_updateTextForNearbyAnnotation",value:function(R){var W=R.detail.element,K=R.detail.currentPoints.canvas,N=Object(O.getToolState)(W,this.name);if(!N)return!1;for(var z=0;z<N.data.length;z++){var Y=N.data[z];if(this.pointNearTool(W,Y,K)||Object(P.default)(Y.handles.textBox,K))return Y.active=!0,i.default.cornerstone.updateImage(W),this.configuration.changeTextCallback(Y,R.detail,this._doneChangingTextCallback.bind(this,W,Y)),R.stopImmediatePropagation(),R.preventDefault(),R.stopPropagation(),!0}}},{key:"_doneChangingTextCallback",value:function(R,W,K,N){N===!0?Object(O.removeToolState)(R,this.name,W):W.text=K,W.active=!1,i.default.cornerstone.updateImage(R),Object(C.default)(R,g.default.MEASUREMENT_MODIFIED,{toolName:this.name,toolType:this.name,element:R,measurementData:W})}}]),j}(h.default);function b(x){x(prompt("Enter your annotation:"))}function y(x,j,p){p(prompt("Change your annotation:"))}},"./tools/annotation/BidirectionalTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return A});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=e.n(o),l=e("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),a=e.n(l),i=e("../node_modules/@babel/runtime/helpers/inherits.js"),h=e.n(i),g=e("./tools/base/BaseAnnotationTool.js"),c=e("./tools/annotation/bidirectionalTool/createNewMeasurement.js"),m=e("./tools/annotation/bidirectionalTool/pointNearTool.js"),E=e("./tools/annotation/bidirectionalTool/renderToolData.js"),T=e("./tools/annotation/bidirectionalTool/addNewMeasurement.js"),P=e("./tools/annotation/bidirectionalTool/mouseMoveCallback.js"),M=e("./tools/annotation/bidirectionalTool/handleSelectedCallback.js"),C=e("./tools/annotation/bidirectionalTool/handleSelectedMouseCallback.js"),O=e("./tools/annotation/bidirectionalTool/handleSelectedTouchCallback.js"),I=e("./tools/cursors/index.js"),_=e("./util/throttle.js"),D=e("./util/getPixelSpacing.js"),L=e("./tools/annotation/bidirectionalTool/utils/calculateLongestAndShortestDiameters.js"),S=function(B,b,y){return y()},A=function(U){h()(B,U);function B(b){var y;u()(this,B);var x={name:"Bidirectional",supportedInteractionTypes:["Mouse","Touch"],configuration:{changeMeasurementLocationCallback:S,getMeasurementLocationCallback:S,textBox:"",shadow:"",drawHandles:!0,drawHandlesOnHover:!0,hideHandlesIfMoving:!1,renderDashed:!1,additionalData:[]},svgCursor:I.bidirectionalCursor};return y=t()(this,s()(B).call(this,b,x)),y.throttledUpdateCachedStats=Object(_.default)(y.updateCachedStats,110),y.createNewMeasurement=c.default.bind(a()(y)),y.pointNearTool=m.default.bind(a()(y)),y.renderToolData=E.default.bind(a()(y)),y.addNewMeasurement=T.default.bind(a()(y)),y._moveCallback=P.default.bind(a()(y)),y.handleSelectedCallback=M.default.bind(a()(y)),y.handleSelectedMouseCallback=C.default.bind(a()(y)),y.handleSelectedTouchCallback=O.default.bind(a()(y)),y}return v()(B,[{key:"updateCachedStats",value:function(y,x,j){if(j.toolName===this.name){var p=Object(D.default)(y),R=Object(L.default)(j,p),W=R.longestDiameter,K=R.shortestDiameter;j.longestDiameter=W,j.shortestDiameter=K,j.invalidated=!1}}}]),B}(g.default)},"./tools/annotation/CircleRoiTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return U});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=e.n(o),l=e("../node_modules/@babel/runtime/helpers/inherits.js"),a=e.n(l),i=e("./externalModules.js"),h=e("./tools/base/BaseAnnotationTool.js"),g=e("./stateManagement/toolState.js"),c=e("./stateManagement/toolStyle.js"),m=e("./stateManagement/toolColors.js"),E=e("./store/index.js"),T=e("./drawing/index.js"),P=e("./util/calculateSUV.js"),M=e("./util/ellipse/index.js"),C=e("./util/getROITextBoxCoords.js"),O=e("./util/numbersWithCommas.js"),I=e("./util/throttle.js"),_=e("./util/logger.js"),D=e("./util/getPixelSpacing.js"),L=e("./tools/cursors/index.js"),S=e("./util/getCircleCoords.js"),A=Object(_.getLogger)("tools:annotation:CircleRoiTool"),U=function(R){a()(W,R);function W(){var K,N=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u()(this,W);var z={name:"CircleRoi",supportedInteractionTypes:["Mouse","Touch"],svgCursor:L.circleRoiCursor,configuration:{centerPointRadius:0,renderDashed:!1,hideHandlesIfMoving:!1}};return K=t()(this,s()(W).call(this,N,z)),K.throttledUpdateCachedStats=Object(I.default)(K.updateCachedStats,110),K}return v()(W,[{key:"createNewMeasurement",value:function(N){var z=N&&N.currentPoints&&N.currentPoints.image;if(!z){A.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"));return}return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{start:{x:N.currentPoints.image.x,y:N.currentPoints.image.y,highlight:!0,active:!1},end:{x:N.currentPoints.image.x,y:N.currentPoints.image.y,highlight:!0,active:!0},initialRotation:N.viewport.rotation,textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}},{key:"pointNearTool",value:function(N,z,Y,$){var J=z&&z.handles&&z.handles.start&&z.handles.end,te=i.default.cornerstoneMath.point.distance;if(J||A.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool")),!J||z.visible===!1)return!1;var ne=$==="mouse"?15:25,de=i.default.cornerstone.pixelToCanvas(N,z.handles.start),w=i.default.cornerstone.pixelToCanvas(N,z.handles.end),G=te(de,Y),Z=te(de,w);return G>Z-ne/2&&G<Z+ne/2}},{key:"updateCachedStats",value:function(N,z,Y){var $=i.default.cornerstone.metaData.get("generalSeriesModule",N.imageId)||{},J=$.modality,te=Object(D.default)(N),ne=p(N,z,Y.handles,J,te);Y.cachedStats=ne,Y.invalidated=!1}},{key:"renderToolData",value:function(N){var z=this,Y=Object(g.getToolState)(N.currentTarget,this.name);if(Y){var $=i.default.cornerstoneMath.point.distance,J=N.detail,te=J.image,ne=J.element,de=J.canvasContext,w=c.default.getToolWidth(),G=this.configuration,Z=G.handleRadius,Q=G.drawHandlesOnHover,k=G.hideHandlesIfMoving,ae=G.renderDashed,ee=G.centerPointRadius,oe=Object(T.getNewContext)(de.canvas),se=Object(D.default)(te),re=se.rowPixelSpacing,ce=se.colPixelSpacing,le=Object(E.getModule)("globalConfiguration").configuration.lineDash,fe=i.default.cornerstone.metaData.get("generalSeriesModule",te.imageId)||{},ge=fe.modality,ie=re&&ce;Object(T.draw)(oe,function(ve){for(var Me=0;Me<Y.data.length;Me++){var me=Y.data[Me];if(me.visible!==!1){var De=m.default.getColorIfActive(me),Te={color:De,handleRadius:Z,drawHandlesIfActive:Q,hideHandlesIfMoving:k};Object(T.setShadow)(ve,z.configuration);var Ce=i.default.cornerstone.pixelToCanvas(ne,me.handles.start),Ee=i.default.cornerstone.pixelToCanvas(ne,me.handles.end),Oe=$(Ce,Ee),_e={color:De};if(ae&&(_e.lineDash=le),Object(T.drawCircle)(ve,ne,me.handles.start,Oe,_e,"pixel"),ee&&Oe>3*ee&&Object(T.drawCircle)(ve,ne,me.handles.start,ee,_e,"pixel"),me.handles&&(me.handles.start.drawnIndependently=!0,me.handles.end.drawnIndependently=!0),Object(T.drawHandles)(ve,J,me.handles,Te),me.invalidated===!0&&(me.cachedStats?z.throttledUpdateCachedStats(te,ne,me):z.updateCachedStats(te,ne,me)),!me.handles.textBox.hasMoved){var je=Object(C.default)(J.viewport,me.handles);Object.assign(me.handles.textBox,je)}var Ie=function(Ue){return B(Ue.start,Ue.end)},xe=y(ve,te.color,me.cachedStats,ge,ie,z.configuration);me.unit=b(ge,z.configuration.showHounsfieldUnits),Object(T.drawLinkedTextBox)(ve,ne,me.handles.textBox,xe,me.handles,Ie,De,w,10,!0)}}})}}}]),W}(h.default);function B(R,W){var K=Object(S.default)(R,W),N=K.left,z=K.top,Y=K.width,$=K.height;return[{x:N+Y/2,y:z},{x:N,y:z+$/2},{x:N+Y/2,y:z+$},{x:N+Y,y:z+$/2}]}function b(R,W){return R==="CT"&&W!==!1?"HU":""}function y(R,W){var K=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},N=K.area,z=N===void 0?0:N,Y=K.radius,$=Y===void 0?0:Y,J=K.perimeter,te=J===void 0?0:J,ne=K.mean,de=ne===void 0?0:ne,w=K.stdDev,G=w===void 0?0:w,Z=K.min,Q=Z===void 0?0:Z,k=K.max,ae=k===void 0?0:k,ee=K.meanStdDevSUV,oe=ee===void 0?0:ee,se=arguments.length>3?arguments[3]:void 0,re=arguments.length>4?arguments[4]:void 0,ce=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},le=ce.showMinMax||!1,fe=[],ge=[];if(!W){var ie=oe&&oe.mean!==0,ve=b(se,ce.showHounsfieldUnits),Me="Mean: ".concat(Object(O.default)(de.toFixed(2))," ").concat(ve),me="Std Dev: ".concat(Object(O.default)(G.toFixed(2))," ").concat(ve);if(ie){for(var De=" SUV: ",Te="".concat(De).concat(Object(O.default)(oe.mean.toFixed(2))),Ce="".concat(De).concat(Object(O.default)(oe.stdDev.toFixed(2))),Ee=Math.floor(R.measureText("".concat(me,"     ")).width);R.measureText(Me).width<Ee;)Me+=" ";ge.push("".concat(Me).concat(Te)),ge.push("".concat(me,"     ").concat(Ce))}else ge.push("".concat(Me,"     ").concat(me));if(le){for(var Oe="Min: ".concat(Q," ").concat(ve),_e="Max: ".concat(ae," ").concat(ve),je=Math.floor(ie?R.measureText("".concat(me,"     ")).width:R.measureText("".concat(Me,"     ")).width);R.measureText(Oe).width<je;)Oe+=" ";ge.push("".concat(Oe).concat(_e))}}return fe.push(x(z,re)),$&&fe.push(j($,"Radius",re)),te&&fe.push(j(te,"Perimeter",re)),ge.forEach(function(Ie){return fe.push(Ie)}),fe}function x(R,W){var K=W?" mm".concat(""):" px".concat("");return"Area: ".concat(Object(O.default)(R.toFixed(2))).concat(K)}function j(R,W,K){if(!R)return"";var N=K?" mm":" px";return"".concat(W,": ").concat(Object(O.default)(R.toFixed(1))).concat(N)}function p(R,W,K,N,z){var Y=Object(S.default)(K.start,K.end),$=i.default.cornerstone.getPixels(W,Y.left,Y.top,Y.width,Y.height),J=Object(M.calculateEllipseStatistics)($,Y),te;N==="PT"&&(te={mean:Object(P.default)(R,J.mean,!0)||0,stdDev:Object(P.default)(R,J.stdDev,!0)||0});var ne=Y.width*(z&&z.colPixelSpacing||1)/2,de=2*Math.PI*ne,w=Math.PI*(Y.width*(z&&z.colPixelSpacing||1)/2)*(Y.height*(z&&z.rowPixelSpacing||1)/2);return{area:w||0,radius:ne||0,perimeter:de||0,count:J.count||0,mean:J.mean||0,variance:J.variance||0,stdDev:J.stdDev||0,min:J.min||0,max:J.max||0,meanStdDevSUV:te}}},"./tools/annotation/CobbAngleTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return B});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=e.n(o),l=e("../node_modules/@babel/runtime/helpers/inherits.js"),a=e.n(l),i=e("./externalModules.js"),h=e("./tools/base/BaseAnnotationTool.js"),g=e("./stateManagement/textStyle.js"),c=e("./stateManagement/toolState.js"),m=e("./stateManagement/toolStyle.js"),E=e("./stateManagement/toolColors.js"),T=e("./manipulators/index.js"),P=e("./drawing/index.js"),M=e("./drawing/drawHandles.js"),C=e("./drawing/drawLinkedTextBox.js"),O=e("./util/lineSegDistance.js"),I=e("./util/roundToDecimal.js"),_=e("./events.js"),D=e("./tools/cursors/index.js"),L=e("./util/triggerEvent.js"),S=e("./util/throttle.js"),A=e("./util/getPixelSpacing.js"),U=e("./store/index.js"),B=function(b){a()(y,b);function y(){var x,j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u()(this,y);var p={name:"CobbAngle",supportedInteractionTypes:["Mouse","Touch"],svgCursor:D.cobbAngleCursor,configuration:{drawHandles:!0,drawHandlesOnHover:!1,hideHandlesIfMoving:!1,renderDashed:!1}};return x=t()(this,s()(y).call(this,j,p)),x.hasIncomplete=!1,x.throttledUpdateCachedStats=Object(S.default)(x.updateCachedStats,110),x}return v()(y,[{key:"createNewMeasurement",value:function(j){return this.hasIncomplete=!0,{visible:!0,active:!0,color:void 0,invalidated:!0,complete:!1,value:"",handles:{start:{x:j.currentPoints.image.x,y:j.currentPoints.image.y,highlight:!0,active:!1},end:{x:j.currentPoints.image.x,y:j.currentPoints.image.y,highlight:!0,active:!0},start2:{x:j.currentPoints.image.x,y:j.currentPoints.image.y,highlight:!0,active:!1,drawnIndependently:!0},end2:{x:j.currentPoints.image.x+1,y:j.currentPoints.image.y,highlight:!0,active:!1,drawnIndependently:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}},{key:"pointNearTool",value:function(j,p,R){if(p.visible===!1||this.hasIncomplete)return!1;var W=Object(O.default)(j,p.handles.start,p.handles.end,R)<25,K=Object(O.default)(j,p.handles.start2,p.handles.end2,R)<25;return W||K}},{key:"updateCachedStats",value:function(j,p,R){var W=Object(A.default)(j),K=W.rowPixelSpacing,N=W.colPixelSpacing,z=(Math.ceil(R.handles.start.x)-Math.ceil(R.handles.end.x))*(N||1),Y=(Math.ceil(R.handles.start.y)-Math.ceil(R.handles.end.y))*(K||1),$=(Math.ceil(R.handles.start2.x)-Math.ceil(R.handles.end2.x))*(N||1),J=(Math.ceil(R.handles.start2.y)-Math.ceil(R.handles.end2.y))*(K||1),te=Math.acos(Math.abs((z*$+Y*J)/(Math.sqrt(z*z+Y*Y)*Math.sqrt($*$+J*J))));te*=180/Math.PI,R.rAngle=Object(I.default)(te,2),R.invalidated=!1}},{key:"renderToolData",value:function(j){var p=this,R=j.detail,W=this.configuration,K=W.handleRadius,N=W.drawHandlesOnHover,z=W.hideHandlesIfMoving,Y=W.renderDashed,$=Object(c.getToolState)(j.currentTarget,this.name);if(!$)return;for(var J=Object(P.getNewContext)(R.canvasContext.canvas),te=m.default.getToolWidth(),ne=Object(U.getModule)("globalConfiguration").configuration.lineDash,de=g.default.getFont(),w=j.detail.element,G=i.default.cornerstone.getEnabledElement(w).image,Z=Object(A.default)(G),Q=Z.rowPixelSpacing,k=Z.colPixelSpacing,ae=function(ce){var le=$.data[ce];if(le.visible===!1)return"continue";le.value||(le.value=p.textBoxText(le,Q,k)),Object(P.draw)(J,function(fe){Object(P.setShadow)(fe,p.configuration);var ge=E.default.getColorIfActive(le),ie={color:ge};Y&&(ie.lineDash=ne),Object(P.drawLine)(fe,R.element,le.handles.start,le.handles.end,ie),le.complete&&Object(P.drawLine)(fe,R.element,le.handles.start2,le.handles.end2,ie);var ve={color:ge,handleRadius:K,drawHandlesIfActive:N,hideHandlesIfMoving:z};p.configuration.drawHandles&&Object(M.default)(fe,R,le.handles,ve),fe.fillStyle=ge;var Me=le.value;if(!le.handles.textBox.hasMoved){var me={x:(le.handles.start.x+le.handles.end.x)/2,y:(le.handles.start.y+le.handles.end.y)/2-10};fe.font=de,le.handles.textBox.x=me.x,le.handles.textBox.y=me.y}Object(C.default)(fe,R.element,le.handles.textBox,Me,le.handles,se,ge,te,0,!0)})},ee=0;ee<$.data.length;ee++)var oe=ae(ee);function se(re){return[re.start,re.start2,re.end,re.end2]}}},{key:"getIncomplete",value:function(j){var p=Object(c.getToolState)(j,this.name);if(p&&Array.isArray(p.data))return p.data.find(function(R){var W=R.complete;return W===!1})}},{key:"addNewMeasurement",value:function(j,p){var R=this;j.preventDefault(),j.stopPropagation();var W=j.detail,K,N,z=function(te){if(!te){Object(c.removeToolState)(Y,R.name,K);return}var ne=_.default.MEASUREMENT_COMPLETED,de={toolName:R.name,toolType:R.name,element:Y,measurementData:K};Object(L.default)(Y,ne,de)},Y=j.detail.element,$=this.getIncomplete(Y);$?(K=$,K.complete=!0,K.handles.start2={x:W.currentPoints.image.x,y:W.currentPoints.image.y,drawnIndependently:!1,highlight:!0,active:!1},K.handles.end2={x:W.currentPoints.image.x,y:W.currentPoints.image.y,drawnIndependently:!1,highlight:!0,active:!0},N=K.handles.end2,this.hasIncomplete=!1,z=function(te){if(!te){Object(c.removeToolState)(Y,R.name,K);return}var ne=_.default.MEASUREMENT_COMPLETED,de={toolName:R.name,toolType:R.name,element:Y,measurementData:K};Object(L.default)(Y,ne,de)}):(K=this.createNewMeasurement(W),Object(c.addToolState)(Y,this.name,K),N=K.handles.end),i.default.cornerstone.updateImage(Y),Object(T.moveNewHandle)(W,this.name,K,N,this.options,p,z)}},{key:"onMeasureModified",value:function(j){var p=j.detail.element,R=i.default.cornerstone.getEnabledElement(p).image,W=Object(A.default)(R),K=W.rowPixelSpacing,N=W.colPixelSpacing;if(j.detail.toolName===this.name){var z=j.detail.measurementData;z.invalidated===!0&&(z.rAngle?this.throttledUpdateCachedStats(R,p,z):this.updateCachedStats(R,p,z)),z.value=this.textBoxText(z,K,N)}}},{key:"textBoxText",value:function(j,p,R){var W=j.rAngle;if(W===void 0||Number.isNaN(W))return"";var K=!p||!R?" (isotropic)":"";return"".concat(W,"").concat(K)}},{key:"activeCallback",value:function(j){this.onMeasureModified=this.onMeasureModified.bind(this),j.addEventListener(_.default.MEASUREMENT_MODIFIED,this.onMeasureModified)}},{key:"passiveCallback",value:function(j){this.onMeasureModified=this.onMeasureModified.bind(this),j.addEventListener(_.default.MEASUREMENT_MODIFIED,this.onMeasureModified)}},{key:"enabledCallback",value:function(j){j.removeEventListener(_.default.MEASUREMENT_MODIFIED,this.onMeasureModified)}},{key:"disabledCallback",value:function(j){j.removeEventListener(_.default.MEASUREMENT_MODIFIED,this.onMeasureModified)}}]),y}(h.default)},"./tools/annotation/EllipticalRoiTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return U});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=e.n(o),l=e("../node_modules/@babel/runtime/helpers/inherits.js"),a=e.n(l),i=e("./externalModules.js"),h=e("./tools/base/BaseAnnotationTool.js"),g=e("./stateManagement/toolState.js"),c=e("./stateManagement/toolStyle.js"),m=e("./stateManagement/toolColors.js"),E=e("./manipulators/getHandleNearImagePoint.js"),T=e("./drawing/index.js"),P=e("./util/calculateSUV.js"),M=e("./util/ellipse/index.js"),C=e("./util/getROITextBoxCoords.js"),O=e("./util/numbersWithCommas.js"),I=e("./util/throttle.js"),_=e("./tools/cursors/index.js"),D=e("./util/logger.js"),L=e("./util/getPixelSpacing.js"),S=e("./store/index.js"),A=Object(D.getLogger)("tools:annotation:EllipticalRoiTool"),U=function(R){a()(W,R);function W(){var K,N=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u()(this,W);var z={name:"EllipticalRoi",supportedInteractionTypes:["Mouse","Touch"],configuration:{drawHandlesOnHover:!1,hideHandlesIfMoving:!1,renderDashed:!1},svgCursor:_.ellipticalRoiCursor};return K=t()(this,s()(W).call(this,N,z)),K.throttledUpdateCachedStats=Object(I.default)(K.updateCachedStats,110),K}return v()(W,[{key:"createNewMeasurement",value:function(N){var z=N&&N.currentPoints&&N.currentPoints.image;if(!z){A.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"));return}return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{start:{x:N.currentPoints.image.x,y:N.currentPoints.image.y,highlight:!0,active:!1},end:{x:N.currentPoints.image.x,y:N.currentPoints.image.y,highlight:!0,active:!0},initialRotation:N.viewport.rotation,textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}},{key:"pointNearTool",value:function(N,z,Y,$){var J=z&&z.handles&&z.handles.start&&z.handles.end,te=J;if(te||A.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool")),!te||z.visible===!1)return!1;var ne=Object(E.default)(N,z.handles,Y,6);if(ne)return!0;var de=$==="mouse"?15:25,w=i.default.cornerstone.pixelToCanvas(N,z.handles.start),G=i.default.cornerstone.pixelToCanvas(N,z.handles.end),Z={left:Math.min(w.x,G.x)+de/2,top:Math.min(w.y,G.y)+de/2,width:Math.abs(w.x-G.x)-de,height:Math.abs(w.y-G.y)-de},Q={left:Math.min(w.x,G.x)-de/2,top:Math.min(w.y,G.y)-de/2,width:Math.abs(w.x-G.x)+de,height:Math.abs(w.y-G.y)+de},k=Object(M.pointInEllipse)(Z,Y),ae=Object(M.pointInEllipse)(Q,Y);return!!(ae&&!k)}},{key:"updateCachedStats",value:function(N,z,Y){var $=i.default.cornerstone.metaData.get("generalSeriesModule",N.imageId)||{},J=$.modality,te=Object(L.default)(N),ne=j(N,z,Y.handles,J,te);Y.cachedStats=ne,Y.invalidated=!1}},{key:"renderToolData",value:function(N){var z=this,Y=Object(g.getToolState)(N.currentTarget,this.name);if(Y){var $=N.detail,J=$.image,te=$.element,ne=c.default.getToolWidth(),de=Object(S.getModule)("globalConfiguration").configuration.lineDash,w=this.configuration,G=w.handleRadius,Z=w.drawHandlesOnHover,Q=w.hideHandlesIfMoving,k=w.renderDashed,ae=Object(T.getNewContext)($.canvasContext.canvas),ee=Object(L.default)(J),oe=ee.rowPixelSpacing,se=ee.colPixelSpacing,re=i.default.cornerstone.metaData.get("generalSeriesModule",J.imageId)||{},ce=re.modality,le=oe&&se;Object(T.draw)(ae,function(fe){for(var ge=0;ge<Y.data.length;ge++){var ie=Y.data[ge];if(ie.visible!==!1){var ve=m.default.getColorIfActive(ie),Me={color:ve,handleRadius:G,drawHandlesIfActive:Z,hideHandlesIfMoving:Q};Object(T.setShadow)(fe,z.configuration);var me={color:ve};if(k&&(me.lineDash=de),Object(T.drawEllipse)(fe,te,ie.handles.start,ie.handles.end,me,"pixel",ie.handles.initialRotation),Object(T.drawHandles)(fe,$,ie.handles,Me),ie.invalidated===!0&&(ie.cachedStats?z.throttledUpdateCachedStats(J,te,ie):z.updateCachedStats(J,te,ie)),!ie.handles.textBox.hasMoved){var De=Object(C.default)($.viewport,ie.handles);Object.assign(ie.handles.textBox,De)}var Te=function(Oe){return B(Oe.start,Oe.end)},Ce=y(fe,J.color,ie.cachedStats,ce,le,z.configuration);ie.unit=b(ce,z.configuration.showHounsfieldUnits),Object(T.drawLinkedTextBox)(fe,te,ie.handles.textBox,Ce,ie.handles,Te,ve,ne,10,!0)}}})}}}]),W}(h.default);function B(R,W){var K=p(R,W),N=K.left,z=K.top,Y=K.width,$=K.height;return[{x:N+Y/2,y:z},{x:N,y:z+$/2},{x:N+Y/2,y:z+$},{x:N+Y,y:z+$/2}]}function b(R,W){return R==="CT"&&W!==!1?"HU":""}function y(R,W){var K=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},N=K.area,z=N===void 0?0:N,Y=K.mean,$=Y===void 0?0:Y,J=K.stdDev,te=J===void 0?0:J,ne=K.min,de=ne===void 0?0:ne,w=K.max,G=w===void 0?0:w,Z=K.meanStdDevSUV,Q=Z===void 0?0:Z,k=arguments.length>3?arguments[3]:void 0,ae=arguments.length>4?arguments[4]:void 0,ee=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},oe=ee.showMinMax||!1,se=[],re=[];if(!W){var ce=Q&&Q.mean!==0,le=b(k,ee.showHounsfieldUnits),fe="Mean: ".concat(Object(O.default)($.toFixed(2))," ").concat(le),ge="Std Dev: ".concat(Object(O.default)(te.toFixed(2))," ").concat(le);if(ce){for(var ie=" SUV: ",ve="".concat(ie).concat(Object(O.default)(Q.mean.toFixed(2))),Me="".concat(ie).concat(Object(O.default)(Q.stdDev.toFixed(2))),me=Math.floor(R.measureText("".concat(ge,"     ")).width);R.measureText(fe).width<me;)fe+=" ";re.push("".concat(fe).concat(ve)),re.push("".concat(ge,"     ").concat(Me))}else re.push("".concat(fe)),re.push("".concat(ge));if(oe){for(var De="Min: ".concat(de," ").concat(le),Te="Max: ".concat(G," ").concat(le),Ce=Math.floor(ce?R.measureText("".concat(ge,"     ")).width:R.measureText("".concat(fe,"     ")).width);R.measureText(De).width<Ce;)De+=" ";re.push("".concat(De).concat(Te))}}return se.push(x(z,ae)),re.forEach(function(Ee){return se.push(Ee)}),se}function x(R,W){var K=W?" mm".concat(""):" px".concat("");return"Area: ".concat(Object(O.default)(R.toFixed(2))).concat(K)}function j(R,W,K,N,z){var Y=p(K.start,K.end),$=i.default.cornerstone.getPixels(W,Y.left,Y.top,Y.width,Y.height),J=Object(M.calculateEllipseStatistics)($,Y),te;N==="PT"&&(te={mean:Object(P.default)(R,J.mean,!0)||0,stdDev:Object(P.default)(R,J.stdDev,!0)||0});var ne=Math.PI*(Y.width*(z.colPixelSpacing||1)/2)*(Y.height*(z.rowPixelSpacing||1)/2);return{area:ne||0,count:J.count||0,mean:J.mean||0,variance:J.variance||0,stdDev:J.stdDev||0,min:J.min||0,max:J.max||0,meanStdDevSUV:te}}function p(R,W){return{left:Math.round(Math.min(R.x,W.x)),top:Math.round(Math.min(R.y,W.y)),width:Math.round(Math.abs(R.x-W.x)),height:Math.round(Math.abs(R.y-W.y))}}},"./tools/annotation/FreehandRoiTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return $});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=e.n(o),l=e("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),a=e.n(l),i=e("../node_modules/@babel/runtime/helpers/inherits.js"),h=e.n(i),g=e("./events.js"),c=e("./externalModules.js"),m=e("./tools/base/BaseAnnotationTool.js"),E=e("./stateManagement/toolState.js"),T=e("./stateManagement/toolStyle.js"),P=e("./stateManagement/toolColors.js"),M=e("./store/index.js"),C=e("./util/triggerEvent.js"),O=e("./util/findAndMoveHelpers.js"),I=e("./util/pointInsideBoundingBox.js"),_=e("./util/calculateSUV.js"),D=e("./util/numbersWithCommas.js"),L=e("./util/getPixelSpacing.js"),S=e("./drawing/index.js"),A=e("./drawing/drawLinkedTextBox.js"),U=e("./drawing/drawHandles.js"),B=e("./util/clip.js"),b=e("./store/setToolCursor.js"),y=e("./tools/cursors/index.js"),x=e("./util/freehand/index.js"),j=e("./util/logger.js"),p=e("./util/throttle.js"),R=Object(j.getLogger)("tools:annotation:FreehandRoiTool"),W=x.default.insertOrDelete,K=x.default.freehandArea,N=x.default.calculateFreehandStatistics,z=x.default.freehandIntersect,Y=x.default.FreehandHandleData,$=function(ne){h()(de,ne);function de(){var w,G=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u()(this,de);var Z={name:"FreehandRoi",supportedInteractionTypes:["Mouse","Touch"],configuration:J(),svgCursor:y.freehandRoiCursor};return w=t()(this,s()(de).call(this,G,Z)),w.isMultiPartTool=!0,w._drawing=!1,w._dragging=!1,w._modifying=!1,w._drawingMouseDownCallback=w._drawingMouseDownCallback.bind(a()(w)),w._drawingMouseMoveCallback=w._drawingMouseMoveCallback.bind(a()(w)),w._drawingMouseDragCallback=w._drawingMouseDragCallback.bind(a()(w)),w._drawingMouseUpCallback=w._drawingMouseUpCallback.bind(a()(w)),w._drawingMouseDoubleClickCallback=w._drawingMouseDoubleClickCallback.bind(a()(w)),w._editMouseUpCallback=w._editMouseUpCallback.bind(a()(w)),w._editMouseDragCallback=w._editMouseDragCallback.bind(a()(w)),w._drawingTouchStartCallback=w._drawingTouchStartCallback.bind(a()(w)),w._drawingTouchDragCallback=w._drawingTouchDragCallback.bind(a()(w)),w._drawingDoubleTapClickCallback=w._drawingDoubleTapClickCallback.bind(a()(w)),w._editTouchDragCallback=w._editTouchDragCallback.bind(a()(w)),w.throttledUpdateCachedStats=Object(p.default)(w.updateCachedStats,110),w}return v()(de,[{key:"createNewMeasurement",value:function(G){var Z=G&&G.currentPoints&&G.currentPoints.image;if(!Z){R.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"));return}var Q={visible:!0,active:!0,invalidated:!0,color:void 0,handles:{points:[]}};return Q.handles.textBox={active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0},Q}},{key:"pointNearTool",value:function(G,Z,Q){var k=Z&&Z.handles&&Z.handles.points;if(!k)throw new Error("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool"));if(!k||Z.visible===!1)return!1;var ae=this._pointNearHandle(G,Z,Q);return ae!==void 0}},{key:"distanceFromPoint",value:function(G,Z,Q){for(var k=1/0,ae=0;ae<Z.handles.points.length;ae++){var ee=c.default.cornerstoneMath.point.distance(Z.handles.points[ae],Q);k=Math.min(k,ee)}return k===1/0?-1:k}},{key:"distanceFromPointCanvas",value:function(G,Z,Q){var k=1/0;if(!Z)return-1;for(var ae=c.default.cornerstone.pixelToCanvas(G,Q),ee=Z.handles.points,oe=0;oe<ee.length;oe++){var se=c.default.cornerstone.pixelToCanvas(G,ee[oe]),re=c.default.cornerstoneMath.point.distance(se,ae);k=Math.min(k,re)}return k===1/0?-1:k}},{key:"updateCachedStats",value:function(G,Z,Q){for(var k,ae,ee=c.default.cornerstone.metaData.get("generalSeriesModule",G.imageId),oe=ee?ee.modality:null,se=Q.handles.points,re={left:se[0].x,right:se[0].x,bottom:se[0].y,top:se[0].x},ce=0;ce<se.length;ce++)re.left=Math.min(re.left,se[ce].x),re.right=Math.max(re.right,se[ce].x),re.bottom=Math.min(re.bottom,se[ce].y),re.top=Math.max(re.top,se[ce].y);var le={left:re.left,top:re.bottom,width:Math.abs(re.right-re.left),height:Math.abs(re.top-re.bottom)};if(Q.polyBoundingBox=le,!G.color){var fe=c.default.cornerstone.getPixels(Z,le.left,le.top,le.width,le.height);k=N.call(this,fe,le,Q.handles.points),oe==="PT"&&(ae={mean:Object(_.default)(G,(k.mean-G.intercept)/G.slope),stdDev:Object(_.default)(G,(k.stdDev-G.intercept)/G.slope)}),k&&!isNaN(k.mean)&&(Q.meanStdDev=k,Q.meanStdDevSUV=ae)}var ge=Object(L.default)(G),ie=ge.colPixelSpacing,ve=ge.rowPixelSpacing,Me=(ie||1)*(ve||1),me=K(Q.handles.points,Me);isNaN(me)||(Q.area=me),Q.invalidated=!1}},{key:"renderToolData",value:function(G){var Z=this,Q=G.detail,k=Object(E.getToolState)(G.currentTarget,this.name);if(!k)return;for(var ae=Q.image,ee=Q.element,oe=this.configuration,se=c.default.cornerstone.metaData.get("generalSeriesModule",ae.imageId),re=se?se.modality:null,ce=Object(S.getNewContext)(Q.canvasContext.canvas),le=T.default.getToolWidth(),fe=oe.renderDashed,ge=Object(M.getModule)("globalConfiguration").configuration.lineDash,ie=function(Ce){var Ee=k.data[Ce];if(Ee.visible===!1)return"continue";Object(S.draw)(ce,function(Oe){var _e=P.default.getColorIfActive(Ee),je;Ee.active?Ee.handles.invalidHandlePlacement?(_e=oe.invalidColor,je=oe.invalidColor):(_e=P.default.getColorIfActive(Ee),je=P.default.getFillColor()):je=P.default.getToolColor();var Ie={color:_e};if(fe&&(Ie.lineDash=ge),Ee.handles.points.length){var xe=Ee.handles.points;Object(S.drawJoinedLines)(Oe,ee,xe[0],xe,Ie),Ee.polyBoundingBox?Object(S.drawJoinedLines)(Oe,ee,xe[xe.length-1],[xe[0]],Ie):Object(S.drawJoinedLines)(Oe,ee,xe[xe.length-1],[oe.mouseLocation.handles.start],Ie)}if(Ie={color:_e,fill:je},(oe.alwaysShowHandles||Ee.active&&Ee.polyBoundingBox)&&(Ie.handleRadius=oe.activeHandleRadius,Z.configuration.drawHandles&&Object(U.default)(Oe,Q,Ee.handles.points,Ie)),Ee.canComplete){Ie.handleRadius=oe.completeHandleRadius;var Se=Ee.handles.points[0];Z.configuration.drawHandles&&Object(U.default)(Oe,Q,[Se],Ie)}if(Ee.active&&!Ee.polyBoundingBox){Ie.handleRadius=oe.activeHandleRadius,Z.configuration.drawHandles&&Object(U.default)(Oe,Q,oe.mouseLocation.handles,Ie);var Ue=Ee.handles.points[0];Z.configuration.drawHandles&&Object(U.default)(Oe,Q,[Ue],Ie)}if(Ee.invalidated===!0&&!Ee.active&&(Ee.meanStdDev&&Ee.meanStdDevSUV&&Ee.area?Z.throttledUpdateCachedStats(ae,ee,Ee):Z.updateCachedStats(ae,ee,Ee)),Ee.polyBoundingBox&&!Ee.handles.textBox.freehand){Ee.handles.textBox.hasMoved||(Ee.handles.textBox.x=Ee.polyBoundingBox.left+Ee.polyBoundingBox.width,Ee.handles.textBox.y=Ee.polyBoundingBox.top+Ee.polyBoundingBox.height/2);var ze=me.call(Z,Ee);Object(A.default)(Oe,ee,Ee.handles.textBox,ze,Ee.handles.points,De,_e,le,0,!0)}})},ve=0;ve<k.data.length;ve++)var Me=ie(ve);function me(Te){var Ce=Te.meanStdDev,Ee=Te.meanStdDevSUV,Oe=Te.area,_e=[];if(Ce&&Ce.mean!==void 0){var je="";re==="CT"&&(je="HU"),Te.unit=je;var Ie="Mean: ".concat(Object(D.default)(Ce.mean.toFixed(2))," ").concat(je),xe="StdDev: ".concat(Object(D.default)(Ce.stdDev.toFixed(2))," ").concat(je);if(Ee&&Ee.mean!==void 0){var Se=" SUV: ";Ie+=Se+Object(D.default)(Ee.mean.toFixed(2)),xe+=Se+Object(D.default)(Ee.stdDev.toFixed(2))}_e.push(Ie),_e.push(xe)}if(Oe){var Ue=" mm".concat(""),ze=Object(L.default)(ae),rt=ze.rowPixelSpacing,lt=ze.colPixelSpacing;(!rt||!lt)&&(Ue=" pixels".concat(""));var it="Area: ".concat(Object(D.default)(Oe.toFixed(2))).concat(Ue);_e.push(it)}return _e}function De(Te){return Te}}},{key:"addNewMeasurement",value:function(G){var Z=G.detail;this._startDrawing(G),this._addPoint(Z),te(G)}},{key:"preMouseDownCallback",value:function(G){var Z=G.detail,Q=this._pointNearHandleAllTools(Z);return Z.event.ctrlKey?(Q!==void 0&&Q.handleNearby.hasBoundingBox||W.call(this,G,Q),te(G),!0):!1}},{key:"handleSelectedCallback",value:function(G,Z,Q){var k=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"mouse",ae=G.detail.element,ee=Object(E.getToolState)(ae,this.name);if(Q.hasBoundingBox){Object(O.moveHandleNearImagePoint)(G,this,Z,Q,k);return}var oe=this.configuration;oe.dragOrigin={x:Q.x,y:Q.y};for(var se=0;se<ee.data.length;se++)for(var re=ee.data[se].handles.points,ce=0;ce<re.length;ce++)re[ce]===Q&&(oe.currentHandle=ce,oe.currentTool=se);this._modifying=!0,this._activateModify(ae),te(G)}},{key:"_drawingMouseMoveCallback",value:function(G){var Z=G.detail,Q=Z.currentPoints,k=Z.element,ae=Object(E.getToolState)(k,this.name),ee=this.configuration,oe=ee.currentTool,se=ae.data[oe],re=Q.canvas;this._getMouseLocation(Z),this._checkInvalidHandleLocation(se,Z);var ce=this._pointNearHandle(k,se,re),le=se.handles.points;ce!==void 0&&!ce.hasBoundingBox&&ce<le.length-1&&(ee.mouseLocation.handles.start.x=le[ce].x,ee.mouseLocation.handles.start.y=le[ce].y),c.default.cornerstone.updateImage(k)}},{key:"_drawingMouseDragCallback",value:function(G){this.options.mouseButtonMask.includes(G.detail.buttons)&&this._drawingDrag(G)}},{key:"_drawingTouchDragCallback",value:function(G){this._drawingDrag(G)}},{key:"_drawingDrag",value:function(G){var Z=G.detail,Q=Z.element,k=Object(E.getToolState)(Q,this.name),ae=this.configuration,ee=ae.currentTool,oe=k.data[ee];this._getMouseLocation(Z),this._checkInvalidHandleLocation(oe,Z),this._addPointPencilMode(Z,oe.handles.points),this._dragging=!0,c.default.cornerstone.updateImage(Q)}},{key:"_drawingMouseUpCallback",value:function(G){var Z=G.detail.element;if(this._dragging){this._dragging=!1;var Q=this.configuration,k=Q.currentTool,ae=Object(E.getToolState)(Z,this.name),ee=ae.data[k];if(!z.end(ee.handles.points)&&ee.canComplete){var oe=Q.currentHandle;this._endDrawing(Z,oe)}te(G)}}},{key:"_drawingMouseDownCallback",value:function(G){var Z=G.detail,Q=Z.buttons,k=Z.currentPoints,ae=Z.element;if(this.options.mouseButtonMask.includes(Q)){var ee=k.canvas,oe=this.configuration,se=oe.currentTool,re=Object(E.getToolState)(ae,this.name),ce=re.data[se],le=this._pointNearHandle(ae,ce,ee);if(!z.end(ce.handles.points)&&ce.canComplete){var fe=oe.currentHandle;this._endDrawing(ae,fe)}else le===void 0&&this._addPoint(Z);te(G)}}},{key:"_drawingTouchStartCallback",value:function(G){var Z=G.detail,Q=Z.currentPoints,k=Z.element,ae=Q.canvas,ee=this.configuration,oe=ee.currentTool,se=Object(E.getToolState)(k,this.name),re=se.data[oe],ce=this._pointNearHandle(k,re,ae);if(!z.end(re.handles.points)&&re.canComplete){var le=ee.currentHandle;this._endDrawing(k,le)}else ce===void 0&&this._addPoint(Z);te(G)}},{key:"completeDrawing",value:function(G){if(this._drawing){var Z=Object(E.getToolState)(G,this.name),Q=this.configuration,k=Z.data[Q.currentTool];if(!z.end(k.handles.points)&&k.handles.points.length>=2){var ae=Q.currentHandle;k.polyBoundingBox={},this._endDrawing(G,ae)}}}},{key:"_drawingMouseDoubleClickCallback",value:function(G){var Z=G.detail.element;this.completeDrawing(Z),te(G)}},{key:"_drawingDoubleTapClickCallback",value:function(G){var Z=G.detail.element;this.completeDrawing(Z),te(G)}},{key:"_editMouseDragCallback",value:function(G){var Z=G.detail,Q=Z.element,k=Z.buttons;if(this.options.mouseButtonMask.includes(k)){var ae=Object(E.getToolState)(Q,this.name),ee=this.configuration,oe=ae.data[ee.currentTool],se=ee.currentHandle,re=oe.handles.points,ce=-1;if(this._getMouseLocation(Z),oe.handles.invalidHandlePlacement=z.modify(re,se),oe.active=!0,oe.highlight=!0,re[se].x=ee.mouseLocation.handles.start.x,re[se].y=ee.mouseLocation.handles.start.y,ce=this._getPrevHandleIndex(se,re),se>=0){var le=re[ce].lines.length-1,fe=re[ce].lines[le];fe.x=ee.mouseLocation.handles.start.x,fe.y=ee.mouseLocation.handles.start.y}c.default.cornerstone.updateImage(Q)}}},{key:"_editTouchDragCallback",value:function(G){var Z=G.detail,Q=Z.element,k=Object(E.getToolState)(Q,this.name),ae=this.configuration,ee=k.data[ae.currentTool],oe=ae.currentHandle,se=ee.handles.points,re=-1;if(this._getMouseLocation(Z),ee.handles.invalidHandlePlacement=z.modify(se,oe),ee.active=!0,ee.highlight=!0,se[oe].x=ae.mouseLocation.handles.start.x,se[oe].y=ae.mouseLocation.handles.start.y,re=this._getPrevHandleIndex(oe,se),oe>=0){var ce=se[re].lines.length-1,le=se[re].lines[ce];le.x=ae.mouseLocation.handles.start.x,le.y=ae.mouseLocation.handles.start.y}c.default.cornerstone.updateImage(Q)}},{key:"_getPrevHandleIndex",value:function(G,Z){return G===0?Z.length-1:G-1}},{key:"_editMouseUpCallback",value:function(G){var Z=G.detail,Q=Z.element,k=Object(E.getToolState)(Q,this.name);this._deactivateModify(Q),this._dropHandle(Z,k),this._endDrawing(Q),c.default.cornerstone.updateImage(Q)}},{key:"_dropHandle",value:function(G,Z){var Q=this.configuration,k=Q.currentTool,ae=Z.data[k].handles,ee=ae.points;if(ae.invalidHandlePlacement){var oe=Q.currentHandle,se=ee[oe],re;if(oe===0){var ce=ee.length-1;re=ee[ce]}else re=ee[oe-1];se.x=Q.dragOrigin.x,se.y=Q.dragOrigin.y,re.lines[0]=se,ae.invalidHandlePlacement=!1}}},{key:"_startDrawing",value:function(G){var Z=G.detail,Q=this.createNewMeasurement(Z),k=Z.element,ae=this.configuration,ee;G.type===g.default.MOUSE_DOWN_ACTIVATE?ee="Mouse":G.type===g.default.TOUCH_START_ACTIVE&&(ee="Touch"),this._activateDraw(k,ee),this._getMouseLocation(Z),Object(E.addToolState)(k,this.name,Q);var oe=Object(E.getToolState)(k,this.name);ae.currentTool=oe.data.length-1,this._activeDrawingToolReference=oe.data[ae.currentTool]}},{key:"_addPoint",value:function(G){var Z=G.currentPoints,Q=G.element,k=Object(E.getToolState)(Q,this.name),ae=this.configuration,ee=k.data[ae.currentTool];if(!ee.handles.invalidHandlePlacement){var oe=new Y(Z.image);ee.handles.points.length&&ee.handles.points[ae.currentHandle-1].lines.push(Z.image),ee.handles.points.push(oe),ae.currentHandle+=1,c.default.cornerstone.updateImage(Q),this.fireModifiedEvent(Q,ee)}}},{key:"_addPointPencilMode",value:function(G,Z){var Q=this,k=this.configuration,ae=G.element,ee=k.mouseLocation.handles.start,oe=function(re){return Q._isDistanceLargerThanSpacing(ae,re,ee)};Z.every(oe)&&this._addPoint(G)}},{key:"_endDrawing",value:function(G,Z){var Q=Object(E.getToolState)(G,this.name),k=this.configuration,ae=Q.data[k.currentTool];if(ae.active=!1,ae.highlight=!1,ae.handles.invalidHandlePlacement=!1,Z!==void 0){var ee=ae.handles.points;ee[k.currentHandle-1].lines.push(ee[0])}this._modifying&&(this._modifying=!1,ae.invalidated=!0),k.currentHandle=0,k.currentTool=-1,ae.canComplete=!1,this._drawing&&this._deactivateDraw(G),c.default.cornerstone.updateImage(G),this.fireModifiedEvent(G,ae),this.fireCompletedEvent(G,ae)}},{key:"_pointNearHandle",value:function(G,Z,Q){if(!(Z.handles===void 0||Z.handles.points===void 0)&&Z.visible!==!1){for(var k=0;k<Z.handles.points.length;k++){var ae=c.default.cornerstone.pixelToCanvas(G,Z.handles.points[k]);if(c.default.cornerstoneMath.point.distance(ae,Q)<6)return k}if(Z.handles.textBox&&Object(I.default)(Z.handles.textBox,Q))return Z.handles.textBox}}},{key:"_pointNearHandleAllTools",value:function(G){var Z=G.currentPoints,Q=G.element,k=Z.canvas,ae=Object(E.getToolState)(Q,this.name);if(ae){for(var ee,oe=0;oe<ae.data.length;oe++)if(ee=this._pointNearHandle(Q,ae.data[oe],k),ee!==void 0)return{handleNearby:ee,toolIndex:oe}}}},{key:"_getMouseLocation",value:function(G){var Z=G.currentPoints,Q=G.image,k=this.configuration;k.mouseLocation.handles.start.x=Z.image.x,k.mouseLocation.handles.start.y=Z.image.y,Object(B.clipToBox)(k.mouseLocation.handles.start,Q)}},{key:"_checkInvalidHandleLocation",value:function(G,Z){if(G.handles.points.length<2)return!0;var Q;this._dragging?Q=this._checkHandlesPencilMode(G,Z):Q=this._checkHandlesPolygonMode(G,Z),G.handles.invalidHandlePlacement=Q}},{key:"_checkHandlesPolygonMode",value:function(G,Z){var Q=this.configuration,k=Z.element,ae=Q.mouseLocation.handles.start,ee=G.handles.points,oe=!1;G.canComplete=!1;var se=this._isDistanceSmallerThanCompleteSpacingCanvas(k,ee[0],ae);return se&&!z.end(ee)&&ee.length>2?(G.canComplete=!0,oe=!1):oe=z.newHandle(ae,ee),oe}},{key:"_checkHandlesPencilMode",value:function(G,Z){var Q=this.configuration,k=Q.mouseLocation.handles.start,ae=G.handles.points,ee=z.newHandle(k,ae);return ee===!1&&(ee=this._invalidHandlePencilMode(G,Z)),ee}},{key:"_invalidHandlePencilMode",value:function(G,Z){var Q=this.configuration,k=Z.element,ae=Q.mouseLocation.handles.start,ee=G.handles.points,oe=this._isDistanceSmallerThanCompleteSpacingCanvas(k,ee[0],ae);if(oe)return G.canComplete=!0,!1;G.canComplete=!1;for(var se=1;se<ee.length-1;se++)if(this._isDistanceSmallerThanSpacing(k,ee[se],ae))return!0;return!1}},{key:"_isDistanceSmallerThanCompleteSpacingCanvas",value:function(G,Z,Q){var k=c.default.cornerstone.pixelToCanvas(G,Z),ae=c.default.cornerstone.pixelToCanvas(G,Q),ee;return this._drawingInteractionType==="Mouse"?ee=this.configuration.completeHandleRadius:this._drawingInteractionType==="Touch"&&(ee=this.configuration.completeHandleRadiusTouch),this._compareDistanceToSpacing(G,k,ae,"<",ee)}},{key:"_isDistanceSmallerThanSpacing",value:function(G,Z,Q){return this._compareDistanceToSpacing(G,Z,Q,"<")}},{key:"_isDistanceLargerThanSpacing",value:function(G,Z,Q){return this._compareDistanceToSpacing(G,Z,Q,">")}},{key:"_compareDistanceToSpacing",value:function(G,Z,Q){var k=arguments.length>3&&arguments[3]!==void 0?arguments[3]:">",ae=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.configuration.spacing;return k===">"?c.default.cornerstoneMath.point.distance(Z,Q)>ae:c.default.cornerstoneMath.point.distance(Z,Q)<ae}},{key:"_activateDraw",value:function(G){var Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Mouse";this._drawing=!0,this._drawingInteractionType=Z,M.state.isMultiPartToolActive=!0,Object(b.hideToolCursor)(this.element),G.addEventListener(g.default.MOUSE_DOWN,this._drawingMouseDownCallback),G.addEventListener(g.default.MOUSE_MOVE,this._drawingMouseMoveCallback),G.addEventListener(g.default.MOUSE_DOUBLE_CLICK,this._drawingMouseDoubleClickCallback),G.addEventListener(g.default.MOUSE_DRAG,this._drawingMouseDragCallback),G.addEventListener(g.default.MOUSE_UP,this._drawingMouseUpCallback),G.addEventListener(g.default.TOUCH_START,this._drawingMouseMoveCallback),G.addEventListener(g.default.TOUCH_START,this._drawingTouchStartCallback),G.addEventListener(g.default.TOUCH_DRAG,this._drawingTouchDragCallback),G.addEventListener(g.default.TOUCH_END,this._drawingMouseUpCallback),G.addEventListener(g.default.DOUBLE_TAP,this._drawingDoubleTapClickCallback),c.default.cornerstone.updateImage(G)}},{key:"_deactivateDraw",value:function(G){this._drawing=!1,M.state.isMultiPartToolActive=!1,this._activeDrawingToolReference=null,this._drawingInteractionType=null,Object(b.setToolCursor)(this.element,this.svgCursor),G.removeEventListener(g.default.MOUSE_DOWN,this._drawingMouseDownCallback),G.removeEventListener(g.default.MOUSE_MOVE,this._drawingMouseMoveCallback),G.removeEventListener(g.default.MOUSE_DOUBLE_CLICK,this._drawingMouseDoubleClickCallback),G.removeEventListener(g.default.MOUSE_DRAG,this._drawingMouseDragCallback),G.removeEventListener(g.default.MOUSE_UP,this._drawingMouseUpCallback),G.removeEventListener(g.default.TOUCH_START,this._drawingTouchStartCallback),G.removeEventListener(g.default.TOUCH_DRAG,this._drawingTouchDragCallback),G.removeEventListener(g.default.TOUCH_START,this._drawingMouseMoveCallback),G.removeEventListener(g.default.TOUCH_END,this._drawingMouseUpCallback),c.default.cornerstone.updateImage(G)}},{key:"_activateModify",value:function(G){M.state.isToolLocked=!0,G.addEventListener(g.default.MOUSE_UP,this._editMouseUpCallback),G.addEventListener(g.default.MOUSE_DRAG,this._editMouseDragCallback),G.addEventListener(g.default.MOUSE_CLICK,this._editMouseUpCallback),G.addEventListener(g.default.TOUCH_END,this._editMouseUpCallback),G.addEventListener(g.default.TOUCH_DRAG,this._editTouchDragCallback),c.default.cornerstone.updateImage(G)}},{key:"_deactivateModify",value:function(G){M.state.isToolLocked=!1,G.removeEventListener(g.default.MOUSE_UP,this._editMouseUpCallback),G.removeEventListener(g.default.MOUSE_DRAG,this._editMouseDragCallback),G.removeEventListener(g.default.MOUSE_CLICK,this._editMouseUpCallback),G.removeEventListener(g.default.TOUCH_END,this._editMouseUpCallback),G.removeEventListener(g.default.TOUCH_DRAG,this._editTouchDragCallback),c.default.cornerstone.updateImage(G)}},{key:"passiveCallback",value:function(G){this._closeToolIfDrawing(G)}},{key:"enabledCallback",value:function(G){this._closeToolIfDrawing(G)}},{key:"disabledCallback",value:function(G){this._closeToolIfDrawing(G)}},{key:"_closeToolIfDrawing",value:function(G){if(this._drawing){var Z=this.configuration,Q=Z.currentHandle;this._endDrawing(G,Q),c.default.cornerstone.updateImage(G)}}},{key:"fireModifiedEvent",value:function(G,Z){var Q=g.default.MEASUREMENT_MODIFIED,k={toolName:this.name,toolType:this.name,element:G,measurementData:Z};Object(C.default)(G,Q,k)}},{key:"fireCompletedEvent",value:function(G,Z){var Q=g.default.MEASUREMENT_COMPLETED,k={toolName:this.name,toolType:this.name,element:G,measurementData:Z};Object(C.default)(G,Q,k)}},{key:"cancelDrawing",value:function(G){if(this._drawing){var Z=Object(E.getToolState)(G,this.name),Q=this.configuration,k=Z.data[Q.currentTool];k.active=!1,k.highlight=!1,k.handles.invalidHandlePlacement=!1,Q.currentHandle=0,Q.currentTool=-1,k.canComplete=!1,Object(E.removeToolState)(G,this.name,k),this._deactivateDraw(G),c.default.cornerstone.updateImage(G)}}},{key:"newImageCallback",value:function(G){var Z=this.configuration;if(this._drawing&&this._activeDrawingToolReference){var Q=G.detail.element,k=this._activeDrawingToolReference;k.active=!1,k.highlight=!1,k.handles.invalidHandlePlacement=!1;var ae=k.handles.points;ae[Z.currentHandle-1].lines.push(ae[0]),Z.currentHandle=0,Z.currentTool=-1,k.canComplete=!1,this._deactivateDraw(Q),c.default.cornerstone.updateImage(Q)}}},{key:"spacing",get:function(){return this.configuration.spacing},set:function(G){if(typeof G!="number")throw new Error("Attempting to set freehand spacing to a value other than a number.");this.configuration.spacing=G,c.default.cornerstone.updateImage(this.element)}},{key:"activeHandleRadius",get:function(){return this.configuration.activeHandleRadius},set:function(G){if(typeof G!="number")throw new Error("Attempting to set freehand activeHandleRadius to a value other than a number.");this.configuration.activeHandleRadius=G,c.default.cornerstone.updateImage(this.element)}},{key:"completeHandleRadius",get:function(){return this.configuration.completeHandleRadius},set:function(G){if(typeof G!="number")throw new Error("Attempting to set freehand completeHandleRadius to a value other than a number.");this.configuration.completeHandleRadius=G,c.default.cornerstone.updateImage(this.element)}},{key:"alwaysShowHandles",get:function(){return this.configuration.alwaysShowHandles},set:function(G){if(typeof G!="boolean")throw new Error("Attempting to set freehand alwaysShowHandles to a value other than a boolean.");this.configuration.alwaysShowHandles=G,c.default.cornerstone.updateImage(this.element)}},{key:"invalidColor",get:function(){return this.configuration.invalidColor},set:function(G){this.configuration.invalidColor=G,c.default.cornerstone.updateImage(this.element)}}]),de}(m.default);function J(){return{mouseLocation:{handles:{start:{highlight:!0,active:!0}}},spacing:1,activeHandleRadius:3,completeHandleRadius:6,completeHandleRadiusTouch:28,alwaysShowHandles:!1,invalidColor:"crimson",currentHandle:0,currentTool:-1,drawHandles:!0,renderDashed:!1}}function te(ne){ne.stopImmediatePropagation(),ne.stopPropagation(),ne.preventDefault()}},"./tools/annotation/LengthTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return L});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=e.n(o),l=e("../node_modules/@babel/runtime/helpers/inherits.js"),a=e.n(l),i=e("./tools/base/BaseAnnotationTool.js"),h=e("./stateManagement/toolState.js"),g=e("./stateManagement/toolStyle.js"),c=e("./stateManagement/toolColors.js"),m=e("./drawing/index.js"),E=e("./drawing/drawLinkedTextBox.js"),T=e("./drawing/drawHandles.js"),P=e("./util/lineSegDistance.js"),M=e("./tools/cursors/index.js"),C=e("./util/logger.js"),O=e("./util/getPixelSpacing.js"),I=e("./util/throttle.js"),_=e("./store/index.js"),D=Object(C.getLogger)("tools:annotation:LengthTool"),L=function(A){a()(U,A);function U(){var B,b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u()(this,U);var y={name:"Length",supportedInteractionTypes:["Mouse","Touch"],svgCursor:M.lengthCursor,configuration:{drawHandles:!0,drawHandlesOnHover:!1,hideHandlesIfMoving:!1,renderDashed:!1,digits:2}};return B=t()(this,s()(U).call(this,b,y)),B.throttledUpdateCachedStats=Object(I.default)(B.updateCachedStats,110),B}return v()(U,[{key:"createNewMeasurement",value:function(b){var y=b&&b.currentPoints&&b.currentPoints.image;if(!y){D.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"));return}var x=b.currentPoints.image,j=x.x,p=x.y;return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{start:{x:j,y:p,highlight:!0,active:!1},end:{x:j,y:p,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}},{key:"pointNearTool",value:function(b,y,x){var j=y&&y.handles&&y.handles.start&&y.handles.end,p=j;return p?y.visible===!1?!1:Object(P.default)(b,y.handles.start,y.handles.end,x)<25:(D.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool")),!1)}},{key:"updateCachedStats",value:function(b,y,x){var j=Object(O.default)(b),p=j.rowPixelSpacing,R=j.colPixelSpacing,W=(x.handles.end.x-x.handles.start.x)*(R||1),K=(x.handles.end.y-x.handles.start.y)*(p||1),N=Math.sqrt(W*W+K*K);x.length=N,x.invalidated=!1}},{key:"renderToolData",value:function(b){var y=this,x=b.detail,j=this.configuration,p=j.handleRadius,R=j.drawHandlesOnHover,W=j.hideHandlesIfMoving,K=j.renderDashed,N=j.digits,z=Object(h.getToolState)(b.currentTarget,this.name);if(!z)return;for(var Y=Object(m.getNewContext)(x.canvasContext.canvas),$=x.image,J=x.element,te=Object(O.default)($),ne=te.rowPixelSpacing,de=te.colPixelSpacing,w=g.default.getToolWidth(),G=Object(_.getModule)("globalConfiguration").configuration.lineDash,Z=function(se){var re=z.data[se];if(re.visible===!1)return"continue";Object(m.draw)(Y,function(ce){Object(m.setShadow)(ce,y.configuration);var le=c.default.getColorIfActive(re),fe={color:le};K&&(fe.lineDash=G),Object(m.drawLine)(ce,J,re.handles.start,re.handles.end,fe);var ge={color:le,handleRadius:p,drawHandlesIfActive:R,hideHandlesIfMoving:W};if(y.configuration.drawHandles&&Object(T.default)(ce,x,re.handles,ge),!re.handles.textBox.hasMoved){var ie={x:Math.max(re.handles.start.x,re.handles.end.x)};ie.x===re.handles.start.x?ie.y=re.handles.start.y:ie.y=re.handles.end.y,re.handles.textBox.x=ie.x,re.handles.textBox.y=ie.y}var ve=10;re.invalidated===!0&&(re.length?y.throttledUpdateCachedStats($,J,re):y.updateCachedStats($,J,re));var Me=ae(re,ne,de);Object(E.default)(ce,J,re.handles.textBox,Me,re.handles,ee,le,w,ve,!0)})},Q=0;Q<z.data.length;Q++)var k=Z(Q);function ae(oe,se,re){var ce=S(oe.length);if(!ce)return"";var le="mm";return(!se||!re)&&(le="pixels"),oe.unit=le,"".concat(ce.toFixed(N)," ").concat(le)}function ee(oe){var se={x:(oe.start.x+oe.end.x)/2,y:(oe.start.y+oe.end.y)/2};return[oe.start,se,oe.end]}}}]),U}(i.default);function S(A){var U=Number(A),B=!isNaN(U);return B?U:void 0}},"./tools/annotation/ProbeTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return S});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=e.n(o),l=e("../node_modules/@babel/runtime/helpers/inherits.js"),a=e.n(l),i=e("./externalModules.js"),h=e("./tools/base/BaseAnnotationTool.js"),g=e("./stateManagement/toolState.js"),c=e("./stateManagement/textStyle.js"),m=e("./stateManagement/toolColors.js"),E=e("./drawing/index.js"),T=e("./drawing/drawTextBox.js"),P=e("./drawing/drawHandles.js"),M=e("./util/getRGBPixels.js"),C=e("./util/calculateSUV.js"),O=e("./tools/cursors/index.js"),I=e("./util/logger.js"),_=e("./util/throttle.js"),D=e("./store/index.js"),L=Object(I.getLogger)("tools:annotation:ProbeTool"),S=function(A){a()(U,A);function U(){var B,b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u()(this,U);var y={name:"Probe",supportedInteractionTypes:["Mouse","Touch"],svgCursor:O.probeCursor,configuration:{drawHandles:!0,renderDashed:!1}};return B=t()(this,s()(U).call(this,b,y)),B.throttledUpdateCachedStats=Object(_.default)(B.updateCachedStats,110),B}return v()(U,[{key:"createNewMeasurement",value:function(b){var y=b&&b.currentPoints&&b.currentPoints.image;if(!y){L.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"));return}return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{end:{x:b.currentPoints.image.x,y:b.currentPoints.image.y,highlight:!0,active:!0}}}}},{key:"pointNearTool",value:function(b,y,x){var j=y&&y.handles&&y.handles.end,p=j;if(p||L.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool")),!p||y.visible===!1)return!1;var R=i.default.cornerstone.pixelToCanvas(b,y.handles.end);return i.default.cornerstoneMath.point.distance(R,x)<5}},{key:"updateCachedStats",value:function(b,y,x){var j=Math.round(x.handles.end.x),p=Math.round(x.handles.end.y),R={};j>=0&&p>=0&&j<b.columns&&p<b.rows&&(R.x=j,R.y=p,b.color?R.storedPixels=Object(M.default)(y,j,p,1,1):(R.storedPixels=i.default.cornerstone.getStoredPixels(y,j,p,1,1),R.sp=R.storedPixels[0],R.mo=R.sp*b.slope+b.intercept,R.suv=Object(C.default)(b,R.sp))),x.cachedStats=R,x.invalidated=!1}},{key:"renderToolData",value:function(b){var y=this,x=b.detail,j=this.configuration,p=j.handleRadius,R=j.renderDashed,W=Object(g.getToolState)(b.currentTarget,this.name);if(W)for(var K=Object(E.getNewContext)(x.canvasContext.canvas),N=x.image,z=x.element,Y=c.default.getFontSize(),$=Object(D.getModule)("globalConfiguration").configuration.lineDash,J=function(w){var G=W.data[w];if(G.visible===!1)return"continue";Object(E.draw)(K,function(Z){var Q=m.default.getColorIfActive(G);if(y.configuration.drawHandles){var k={handleRadius:p,color:Q};R&&(k.lineDash=$),Object(P.default)(Z,x,G.handles,k)}G.invalidated===!0&&(G.cachedStats?y.throttledUpdateCachedStats(N,z,G):y.updateCachedStats(N,z,G));var ae,ee,oe=G.cachedStats,se=oe.x,re=oe.y,ce=oe.storedPixels,le=oe.sp,fe=oe.mo,ge=oe.suv;if(se>=0&&re>=0&&se<N.columns&&re<N.rows){ae="".concat(se,", ").concat(re),N.color?ee="R: ".concat(ce[0]," G: ").concat(ce[1]," B: ").concat(ce[2]):(ee="SP: ".concat(le," MO: ").concat(parseFloat(fe.toFixed(3))),ge&&(ee+=" SUV: ".concat(parseFloat(ge.toFixed(3)))));var ie={x:G.handles.end.x+3,y:G.handles.end.y-3},ve=i.default.cornerstone.pixelToCanvas(x.element,ie);Object(T.default)(Z,ee,ve.x,ve.y+Y+5,Q),Object(T.default)(Z,ae,ve.x,ve.y,Q)}})},te=0;te<W.data.length;te++)var ne=J(te)}}]),U}(h.default)},"./tools/annotation/RectangleRoiTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return S});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=e.n(o),l=e("../node_modules/@babel/runtime/helpers/inherits.js"),a=e.n(l),i=e("./externalModules.js"),h=e("./tools/base/BaseAnnotationTool.js"),g=e("./stateManagement/toolState.js"),c=e("./stateManagement/toolStyle.js"),m=e("./stateManagement/toolColors.js"),E=e("./drawing/index.js"),T=e("./util/calculateSUV.js"),P=e("./util/getROITextBoxCoords.js"),M=e("./util/numbersWithCommas.js"),C=e("./util/throttle.js"),O=e("./tools/cursors/index.js"),I=e("./util/logger.js"),_=e("./util/getPixelSpacing.js"),D=e("./store/index.js"),L=Object(I.getLogger)("tools:annotation:RectangleRoiTool"),S=function(p){a()(R,p);function R(){var W,K=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u()(this,R);var N={name:"RectangleRoi",supportedInteractionTypes:["Mouse","Touch"],configuration:{drawHandles:!0,drawHandlesOnHover:!1,hideHandlesIfMoving:!1,renderDashed:!1},svgCursor:O.rectangleRoiCursor};return W=t()(this,s()(R).call(this,K,N)),W.throttledUpdateCachedStats=Object(C.default)(W.updateCachedStats,110),W}return v()(R,[{key:"createNewMeasurement",value:function(K){var N=K&&K.currentPoints&&K.currentPoints.image;if(!N){L.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"));return}return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{start:{x:K.currentPoints.image.x,y:K.currentPoints.image.y,highlight:!0,active:!1},end:{x:K.currentPoints.image.x,y:K.currentPoints.image.y,highlight:!0,active:!0},initialRotation:K.viewport.rotation,textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}},{key:"pointNearTool",value:function(K,N,z,Y){var $=N&&N.handles&&N.handles.start&&N.handles.end,J=$;if(J||L.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool")),!J||N.visible===!1)return!1;var te=Y==="mouse"?15:25,ne=i.default.cornerstone.pixelToCanvas(K,N.handles.start),de=i.default.cornerstone.pixelToCanvas(K,N.handles.end),w={left:Math.min(ne.x,de.x),top:Math.min(ne.y,de.y),width:Math.abs(ne.x-de.x),height:Math.abs(ne.y-de.y)},G=i.default.cornerstoneMath.rect.distanceToPoint(w,z);return G<te}},{key:"updateCachedStats",value:function(K,N,z){var Y=i.default.cornerstone.metaData.get("generalSeriesModule",K.imageId)||{},$=Y.modality,J=Object(_.default)(K),te=U(K,N,z.handles,$,J);z.cachedStats=te,z.invalidated=!1}},{key:"renderToolData",value:function(K){var N=this,z=Object(g.getToolState)(K.currentTarget,this.name);if(z){var Y=K.detail,$=Y.image,J=Y.element,te=c.default.getToolWidth(),ne=Object(D.getModule)("globalConfiguration").configuration.lineDash,de=this.configuration,w=de.handleRadius,G=de.drawHandlesOnHover,Z=de.hideHandlesIfMoving,Q=de.renderDashed,k=Object(E.getNewContext)(Y.canvasContext.canvas),ae=Object(_.default)($),ee=ae.rowPixelSpacing,oe=ae.colPixelSpacing,se=i.default.cornerstone.metaData.get("generalSeriesModule",$.imageId)||{},re=se.modality,ce=ee&&oe;Object(E.draw)(k,function(le){for(var fe=0;fe<z.data.length;fe++){var ge=z.data[fe];if(ge.visible!==!1){var ie=m.default.getColorIfActive(ge),ve={color:ie,handleRadius:w,drawHandlesIfActive:G,hideHandlesIfMoving:Z};Object(E.setShadow)(le,N.configuration);var Me={color:ie};if(Q&&(Me.lineDash=ne),Object(E.drawRect)(le,J,ge.handles.start,ge.handles.end,Me,"pixel",ge.handles.initialRotation),N.configuration.drawHandles&&Object(E.drawHandles)(le,Y,ge.handles,ve),ge.invalidated===!0&&(ge.cachedStats?N.throttledUpdateCachedStats($,J,ge):N.updateCachedStats($,J,ge)),!ge.handles.textBox.hasMoved){var me=Object(P.default)(Y.viewport,ge.handles);Object.assign(ge.handles.textBox,me)}var De=function(Ee){return b(Ee.start,Ee.end)},Te=j(le,$.color,ge.cachedStats,re,ce,N.configuration);ge.unit=x(re,N.configuration.showHounsfieldUnits),Object(E.drawLinkedTextBox)(le,J,ge.handles.textBox,Te,ge.handles,De,ie,te,10,!0)}}})}}}]),R}(h.default);function A(p,R){return{left:Math.min(p.x,R.x),top:Math.min(p.y,R.y),width:Math.abs(p.x-R.x),height:Math.abs(p.y-R.y)}}function U(p,R,W,K,N){var z=A(W.start,W.end),Y=i.default.cornerstone.getPixels(R,z.left,z.top,z.width,z.height),$=B(Y,z),J;K==="PT"&&(J={mean:Object(T.default)(p,$.mean,!0)||0,stdDev:Object(T.default)(p,$.stdDev,!0)||0});var te=z.width*(N.colPixelSpacing||1)*(z.height*(N.rowPixelSpacing||1)),ne=z.width*2*(N.colPixelSpacing||1)+z.height*2*(N.rowPixelSpacing||1);return{area:te||0,perimeter:ne,count:$.count||0,mean:$.mean||0,variance:$.variance||0,stdDev:$.stdDev||0,min:$.min||0,max:$.max||0,meanStdDevSUV:J}}function B(p,R){for(var W=0,K=0,N=0,z=0,Y=p?p[0]:null,$=p?p[0]:null,J=R.top;J<R.top+R.height;J++)for(var te=R.left;te<R.left+R.width;te++)W+=p[z],K+=p[z]*p[z],Y=Math.min(Y,p[z]),$=Math.max($,p[z]),N++,z++;if(N===0)return{count:N,mean:0,variance:0,stdDev:0,min:0,max:0};var ne=W/N,de=K/N-ne*ne;return{count:N,mean:ne,variance:de,stdDev:Math.sqrt(de),min:Y,max:$}}function b(p,R){var W=A(p,R),K=W.left,N=W.top,z=W.width,Y=W.height;return[{x:K+z/2,y:N},{x:K,y:N+Y/2},{x:K+z/2,y:N+Y},{x:K+z,y:N+Y/2}]}function y(p,R){var W=R?" mm".concat(""):" px".concat("");return"Area: ".concat(Object(M.default)(p.toFixed(2))).concat(W)}function x(p,R){return p==="CT"&&R!==!1?"HU":""}function j(p,R){var W=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},K=W.area,N=K===void 0?0:K,z=W.mean,Y=z===void 0?0:z,$=W.stdDev,J=$===void 0?0:$,te=W.min,ne=te===void 0?0:te,de=W.max,w=de===void 0?0:de,G=W.meanStdDevSUV,Z=G===void 0?0:G,Q=arguments.length>3?arguments[3]:void 0,k=arguments.length>4?arguments[4]:void 0,ae=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},ee=ae.showMinMax||!1,oe=[],se=[];if(!R){var re=Z&&Z.mean!==0,ce=x(Q,ae.showHounsfieldUnits),le="Mean: ".concat(Object(M.default)(Y.toFixed(2))," ").concat(ce),fe="Std Dev: ".concat(Object(M.default)(J.toFixed(2))," ").concat(ce);if(re){for(var ge=" SUV: ",ie="".concat(ge).concat(Object(M.default)(Z.mean.toFixed(2))),ve="".concat(ge).concat(Object(M.default)(Z.stdDev.toFixed(2))),Me=Math.floor(p.measureText("".concat(fe,"     ")).width);p.measureText(le).width<Me;)le+=" ";se.push("".concat(le).concat(ie)),se.push("".concat(fe,"     ").concat(ve))}else se.push("".concat(le)),se.push("".concat(fe));if(ee){for(var me="Min: ".concat(ne," ").concat(ce),De="Max: ".concat(w," ").concat(ce),Te=Math.floor(re?p.measureText("".concat(fe,"     ")).width:p.measureText("".concat(le,"     ")).width);p.measureText(me).width<Te;)me+=" ";se.push("".concat(me).concat(De))}}return oe.push(y(N,k)),se.forEach(function(Ce){return oe.push(Ce)}),oe}},"./tools/annotation/TextMarkerTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return O});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=e.n(o),l=e("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),a=e.n(l),i=e("../node_modules/@babel/runtime/helpers/inherits.js"),h=e.n(i),g=e("./tools/base/BaseAnnotationTool.js"),c=e("./externalModules.js"),m=e("./util/pointInsideBoundingBox.js"),E=e("./stateManagement/toolColors.js"),T=e("./drawing/index.js"),P=e("./drawing/drawTextBox.js"),M=e("./stateManagement/toolState.js"),C=e("./tools/cursors/index.js"),O=function(_){h()(D,_);function D(){var L,S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u()(this,D);var A={name:"TextMarker",supportedInteractionTypes:["Mouse","Touch"],configuration:{markers:[],current:"",ascending:!0,loop:!1,changeTextCallback:I},svgCursor:C.textMarkerCursor};return L=t()(this,s()(D).call(this,S,A)),L.touchPressCallback=L._changeText.bind(a()(L)),L.doubleClickCallback=L._changeText.bind(a()(L)),L}return v()(D,[{key:"createNewMeasurement",value:function(S){var A=this.configuration;if(A.current){var U={visible:!0,active:!0,text:A.current,color:void 0,handles:{end:{x:S.currentPoints.image.x,y:S.currentPoints.image.y,highlight:!0,active:!0,hasBoundingBox:!0}}},B={left:0,top:0,width:S.image.width,height:S.image.height};if(c.default.cornerstoneMath.point.insideRect(U.handles.end,B)){var b=A.markers.indexOf(A.current),y=A.ascending?1:-1;return b+=y,b>=A.markers.length?b=A.loop?0:-1:b<0&&(b=A.loop?A.markers.length:-1),A.current=A.markers[b],U}}}},{key:"pointNearTool",value:function(S,A,U){if(A.visible===!1)return!1;if(A.handles.end.boundingBox){var B=c.default.cornerstoneMath.rect.distanceToPoint(A.handles.end.boundingBox,U),b=Object(m.default)(A.handles.end,U);return B<10||b}}},{key:"updateCachedStats",value:function(){}},{key:"renderToolData",value:function(S){var A=S.detail,U=this.configuration,B=Object(M.getToolState)(A.element,this.name);if(B)for(var b=Object(T.getNewContext)(A.canvasContext.canvas),y=function(R){var W=B.data[R];if(W.visible===!1)return"continue";var K=E.default.getColorIfActive(W);Object(T.draw)(b,function(N){Object(T.setShadow)(N,U);var z=c.default.cornerstone.pixelToCanvas(A.element,W.handles.end),Y={centering:{x:!0,y:!0}};W.handles.end.boundingBox=Object(P.default)(N,W.text,z.x,z.y-10,K,Y)})},x=0;x<B.data.length;x++)var j=y(x)}},{key:"_changeText",value:function(S){var A=S.detail,U=A.element,B=A.currentPoints,b;function y(W,K,N){N===!0?Object(M.removeToolState)(U,this.name,W):W.text=K,W.active=!1,c.default.cornerstone.updateImage(U)}var x=this.configuration,j=B.canvas,p=Object(M.getToolState)(U,this.name);if(p){for(var R=0;R<p.data.length;R++)if(b=p.data[R],this.pointNearTool(U,b,j)){b.active=!0,c.default.cornerstone.updateImage(U),x.changeTextCallback(b,A,y),S.stopImmediatePropagation(),S.preventDefault(),S.stopPropagation();return}}}}]),D}(g.default),I=function(D,L,S){S(D,prompt("Change your annotation:"))}},"./tools/annotation/bidirectionalTool/addNewMeasurement.js":function(H,n,e){e.r(n);var r=e("./externalModules.js"),u=e("./events.js"),f=e("./manipulators/index.js"),v=e("./manipulators/anyHandlesOutsideImage.js"),d=e("./stateManagement/toolState.js"),t=e("./util/triggerEvent.js"),o=e("./util/getActiveTool.js"),s=e("./tools/annotation/BidirectionalTool.js"),l=e("./tools/annotation/bidirectionalTool/utils/updatePerpendicularLineHandles.js");n.default=function(i,h){var g=this,c=i.detail,m=c.element,E=c.image,T=c.buttons,P=this.configuration;if(!a(E)){var M=this.createNewMeasurement(c),C=function(){M.active=!1,r.default.cornerstone.updateImage(m)};Object(d.addToolState)(m,this.name,M),r.default.cornerstone.updateImage(m);var O=new Date().getTime(),I=M.handles,_=I.end,D=I.perpendicularStart;Object(f.moveNewHandle)(c,this.name,M,_,{},h,function(L){if(!L){Object(d.removeToolState)(m,g.name,M);return}var S=M.handles,A=M.longestDiameter,U=M.shortestDiameter,B=Object(v.default)(c,S),b=parseFloat(A)||0,y=parseFloat(U)||0,x=b<1||y<1,j=new Date().getTime()-O<150;B||x||j?(M.cancelled=!0,Object(d.removeToolState)(m,g.name,M)):P.getMeasurementLocationCallback(M,c,C),Object(l.default)(c,M),D.locked=!1,M.invalidated=!0,r.default.cornerstone.updateImage(m);var p=Object(o.default)(m,T,h);p instanceof s.default&&p.updateCachedStats(E,m,M);var R={toolName:g.name,toolType:g.name,element:m,measurementData:M};Object(t.default)(m,u.default.MEASUREMENT_MODIFIED,R),Object(t.default)(m,u.default.MEASUREMENT_COMPLETED,R)})}};var a=function(h){var g=r.default.cornerstone.metaData.get("imagePlaneModule",h.imageId),c=h.rowPixelSpacing,m=h.columnPixelSpacing;return g&&(c=g.rowPixelSpacing||g.rowImagePixelSpacing,m=g.columnPixelSpacing||g.colImagePixelSpacing),!c||!m}},"./tools/annotation/bidirectionalTool/createNewMeasurement.js":function(H,n,e){e.r(n);var r=function(f,v,d){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return Object.assign({x:f,y:v,index:d,drawnIndependently:!1,allowedOutsideImage:!1,highlight:!0,active:!1},t)};n.default=function(u){var f=u.currentPoints.image,v=f.x,d=f.y,t={toolName:this.name,toolType:this.name,isCreating:!0,visible:!0,active:!0,invalidated:!0,handles:{start:r(v,d,0),end:r(v,d,1,{active:!0}),perpendicularStart:r(v,d,2,{locked:!0}),perpendicularEnd:r(v,d,3),textBox:r(v-50,d-70,null,{highlight:!1,hasMoved:!0,active:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0})},longestDiameter:0,shortestDiameter:0};return t}},"./tools/annotation/bidirectionalTool/handleSelectedCallback.js":function(H,n,e){e.r(n),n.default=function(r,u,f){var v=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"mouse";v==="touch"?this.handleSelectedTouchCallback(r):this.handleSelectedMouseCallback(r)}},"./tools/annotation/bidirectionalTool/handleSelectedMouseCallback.js":function(H,n,e){e.r(n);var r=e("../node_modules/@babel/runtime/helpers/typeof.js"),u=e.n(r),f=e("./externalModules.js"),v=e("./events.js"),d=e("./stateManagement/toolState.js"),t=e("./manipulators/anyHandlesOutsideImage.js"),o=e("./manipulators/getHandleNearImagePoint.js"),s=e("./manipulators/index.js"),l=e("./tools/annotation/bidirectionalTool/moveHandle/moveHandle.js"),a=e("./tools/annotation/bidirectionalTool/invertHandles.js"),i=e("./store/setToolCursor.js"),h=e("./util/getProximityThreshold.js");n.default=function(E){var T=this,P=E.detail,M=P.element,C,O=Object(h.default)("mouse",this.name),I=function(y){C.invalidated=!0,Object(t.default)(P,C.handles)&&Object(d.removeToolState)(M,T.name,C),y&&(y.moving=!1,y.selected=!0),Object(i.setToolCursor)(T.element,T.svgCursor),f.default.cornerstone.updateImage(M),M.addEventListener(v.default.MOUSE_MOVE,T._moveCallback),M.addEventListener(v.default.TOUCH_START,T._moveCallback)},_=P.startPoints.canvas,D=Object(d.getToolState)(E.currentTarget,this.name);if(D){for(var L=function(y){C=D.data[y];var x=[M,C.handles,_,O],j=o.default.apply(void 0,x);if(j)return M.removeEventListener(v.default.MOUSE_MOVE,T._moveCallback),M.removeEventListener(v.default.TOUCH_START,T._moveCallback),C.active=!0,g(C.handles),j.moving=!0,j=Object(a.default)(P,C,j),j.hasBoundingBox||Object(i.hideToolCursor)(T.element),Object(l.default)(P,T.name,C,j,function(){return I(j)}),m(E),{v:!0}},S=0;S<D.data.length;S++){var A=L(S);if(u()(A)==="object")return A.v}for(var U=function(y){return function(){c(y,!1),I()}},S=0;S<D.data.length;S++)if(C=D.data[S],this.pointNearTool(M,C,_,"mouse")){M.removeEventListener(v.default.MOUSE_MOVE,this._moveCallback),M.removeEventListener(v.default.TOUCH_START,this._moveCallback),C.active=!0,g(C.handles),c(C.handles,!0);var B=U(C.handles);return Object(s.moveAllHandles)(P,this.name,C,null,{deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:!1},"mouse",B),m(E),!0}}};var g=function(T){var P=!1;return Object.keys(T).forEach(function(M){M!=="textBox"&&(T[M].selected=!1,P=T[M].active||P,T[M].active=!1)}),P},c=function(T,P){Object.keys(T).forEach(function(M){M!=="textBox"&&(T[M].moving=P)})},m=function(T){T.stopImmediatePropagation(),T.stopPropagation(),T.preventDefault()}},"./tools/annotation/bidirectionalTool/handleSelectedTouchCallback.js":function(H,n,e){e.r(n);var r=e("../node_modules/@babel/runtime/helpers/typeof.js"),u=e.n(r),f=e("./externalModules.js"),v=e("./store/index.js"),d=e("./events.js"),t=e("./stateManagement/toolState.js"),o=e("./manipulators/anyHandlesOutsideImage.js"),s=e("./manipulators/getHandleNearImagePoint.js"),l=e("./manipulators/index.js"),a=e("./tools/annotation/bidirectionalTool/moveHandle/touchMoveHandle.js");n.default=function(c){var m=this,E=c.detail,T=E.element,P,M=v.state.touchProximity,C=function(B){P.invalidated=!0,Object(o.default)(E,P.handles)&&Object(t.removeToolState)(T,m.name,P),B&&(B.moving=!1,B.selected=!0),f.default.cornerstone.updateImage(T),T.addEventListener(d.default.TOUCH_DRAG,m._moveCallback)},O=E.startPoints.canvas,I=Object(t.getToolState)(c.currentTarget,this.name);if(I){for(var _=function(B){P=I.data[B];var b=[T,P.handles,O,M],y=s.default.apply(void 0,b);if(y)return T.removeEventListener(d.default.TOUCH_DRAG,m._moveCallback),P.active=!0,i(P.handles),y.moving=!0,Object(a.default)(E,m.name,P,y,function(){return C(y)}),g(c),{v:!0}},D=0;D<I.data.length;D++){var L=_(D);if(u()(L)==="object")return L.v}for(var S=function(B){return function(){h(B,!1),C()}},D=0;D<I.data.length;D++)if(P=I.data[D],this.pointNearTool(T,P,O,"touch")){T.removeEventListener(d.default.TOUCH_DRAG,this._moveCallback),P.active=!0,i(P.handles),h(P.handles,!0);var A=S(P.handles);return Object(l.moveAllHandles)(E,this.name,P,null,{deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:!1},"touch",A),g(c),!0}}};var i=function(m){var E=!1;return Object.keys(m).forEach(function(T){T!=="textBox"&&(m[T].selected=!1,E=m[T].active||E,m[T].active=!1)}),E},h=function(m,E){Object.keys(m).forEach(function(T){T!=="textBox"&&(m[T].moving=E)})},g=function(m){m.stopImmediatePropagation(),m.stopPropagation(),m.preventDefault()}},"./tools/annotation/bidirectionalTool/invertHandles.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return f});var r=function(d,t,o){var s=d[o],l=t[o];d[o]=l,t[o]=s},u=function(d,t){r(d,t,"x"),r(d,t,"y"),r(d,t,"moving"),r(d,t,"hover"),r(d,t,"active"),r(d,t,"selected")};function f(v,d,t){var o=v.image,s=o.rowPixelSpacing,l=o.columnPixelSpacing,a=d.handles,i=a.start,h=a.end,g=a.perpendicularStart,c=a.perpendicularEnd,m=(i.x-h.x)*(l||1),E=(i.y-h.y)*(s||1),T=Math.sqrt(m*m+E*E),P=(g.x-c.x)*(l||1),M=(g.y-c.y)*(s||1),C=Math.sqrt(P*P+M*M)||0;return C>T?(u(i,h),u(i,g),u(h,c),Object.values(a).find(function(O){return O.moving===!0})):t}},"./tools/annotation/bidirectionalTool/mouseMoveCallback.js":function(H,n,e){e.r(n);var r=e("./externalModules.js"),u=e("./stateManagement/toolCoordinates.js"),f=e("./manipulators/getHandleNearImagePoint.js"),v=e("./stateManagement/toolState.js"),d=function(o,s,l){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:6,i=Object(f.default)(o,s,l,a),h=!1;return Object.keys(s).forEach(function(g){if(g!=="textBox"){var c=s[g],m=c===i;c.active!==m&&(h=!0),c.active=m}}),h};n.default=function(t){var o=this,s=t.detail,l=s.element;u.default.setCoords(s);var a=Object(v.getToolState)(l,this.name);if(a){for(var i=!1,h=function(m){var E=s.currentPoints.canvas,T=a.data[m],P=d(l,T.handles,E);Object.keys(T.handles).forEach(function(I){if(I!=="textBox"){var _=T.handles[I];_.hover=_.active}}),P&&(i=!0);var M=o.pointNearTool(l,T,E,"mouse"),C=M&&!T.active,O=!M&&T.active;(C||O)&&(T.active=!T.active,i=!0)},g=0;g<a.data.length;g++)h(g);i===!0&&r.default.cornerstone.updateImage(l)}}},"./tools/annotation/bidirectionalTool/moveHandle/getBaseData.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return v});var r=e("./externalModules.js"),u=e("./tools/annotation/bidirectionalTool/utils/getDistanceWithPixelSpacing.js");function f(d,t){return{start:d,end:t}}function v(d,t,o){var s=r.default.cornerstoneMath.lineSegment,l=d.handles,a=l.start,i=l.end,h=l.perpendicularStart,g=l.perpendicularEnd,c=t.image,m=c.columnPixelSpacing,E=m===void 0?1:m,T=c.rowPixelSpacing,P=T===void 0?1:T,M=f(a,i),C=f(h,g),O=s.intersectLine(M,C),I=Object(u.default)(E,P,o,O);return{columnPixelSpacing:E,rowPixelSpacing:P,start:a,end:i,perpendicularStart:h,perpendicularEnd:g,longLine:M,intersection:O,distanceToFixed:I,fixedPoint:o}}},"./tools/annotation/bidirectionalTool/moveHandle/moveHandle.js":function(H,n,e){e.r(n);var r=e("./externalModules.js"),u=e("./store/index.js"),f=e("./events.js"),v=e("./tools/annotation/bidirectionalTool/moveHandle/setHandlesPosition.js"),d=e("./util/getActiveTool.js"),t=e("./tools/base/BaseAnnotationTool.js");n.default=function(o,s,l,a,i,h){var g=o.element,c=o.image,m=o.buttons,E={x:a.x-o.currentPoints.image.x,y:a.y-o.currentPoints.image.y},T=function(I){var _=I.detail;a.hasMoved=!0,a.index===void 0||a.index===null?(a.x=_.currentPoints.image.x+E.x,a.y=_.currentPoints.image.y+E.y):Object(v.default)(a,_,l,E),h&&(a.x=Math.max(a.x,0),a.x=Math.min(a.x,_.image.width),a.y=Math.max(a.y,0),a.y=Math.min(a.y,_.image.height)),l.invalidated=!0,r.default.cornerstone.updateImage(g);var D=Object(d.default)(g,m,"mouse");D instanceof t.default&&D.updateCachedStats(c,g,l);var L={toolName:s,toolType:s,element:g,measurementData:l};r.default.cornerstone.triggerEvent(g,f.default.MEASUREMENT_MODIFIED,L)};a.active=!0,a.moving=!0,u.state.isToolLocked=!0,g.addEventListener(f.default.MOUSE_DRAG,T),g.addEventListener(f.default.TOUCH_DRAG,T);var P=r.default.cornerstone.getImage(g),M=function(){var I=r.default.cornerstone.getImage(g);I.imageId!==P.imageId&&C()};g.addEventListener(r.default.cornerstone.EVENTS.IMAGE_RENDERED,M);var C=function O(){a.active=!1,u.state.isToolLocked=!1,g.removeEventListener(r.default.cornerstone.EVENTS.IMAGE_RENDERED,M),g.removeEventListener(f.default.MOUSE_DRAG,T),g.removeEventListener(f.default.MOUSE_UP,O),g.removeEventListener(f.default.MOUSE_CLICK,O),g.removeEventListener(f.default.TOUCH_DRAG,T),g.removeEventListener(f.default.TOUCH_DRAG_END,O),g.removeEventListener(f.default.TAP,O),r.default.cornerstone.updateImage(g),typeof i=="function"&&i()};g.addEventListener(f.default.MOUSE_UP,C),g.addEventListener(f.default.MOUSE_CLICK,C),g.addEventListener(f.default.TOUCH_DRAG_END,C),g.addEventListener(f.default.TAP,C)}},"./tools/annotation/bidirectionalTool/moveHandle/moveLongLine/moveLongLine.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return v});var r=e("./tools/annotation/bidirectionalTool/utils/getDistanceWithPixelSpacing.js"),u=e("./tools/annotation/bidirectionalTool/moveHandle/getBaseData.js"),f=e("./tools/annotation/bidirectionalTool/moveHandle/moveLongLine/updatePerpendicularLine.js");function v(d,t,o,s){var l=Object(u.default)(t,o,s),a=l.columnPixelSpacing,i=l.rowPixelSpacing,h=l.distanceToFixed,g=Object(r.default)(a,i,s,d);if(g<=h)return!1;var c=h/g,m={x:s.x+(d.x-s.x)*c,y:s.y+(d.y-s.y)*c},E=Object(f.default)(l,m);return t.handles.perpendicularStart.x=E.start.x,t.handles.perpendicularStart.y=E.start.y,t.handles.perpendicularEnd.x=E.end.x,t.handles.perpendicularEnd.y=E.end.y,!0}},"./tools/annotation/bidirectionalTool/moveHandle/moveLongLine/updatePerpendicularLine.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return f});var r=e("./tools/annotation/bidirectionalTool/utils/getLineVector.js"),u=e("./tools/annotation/bidirectionalTool/utils/getDistanceWithPixelSpacing.js");function f(v,d){var t=v.columnPixelSpacing,o=v.rowPixelSpacing,s=v.start,l=v.perpendicularStart,a=v.perpendicularEnd,i=v.intersection,h=v.fixedPoint,g=Object(u.default)(t,o,l,i),c=Object(u.default)(t,o,a,i),m=Object(r.default)(t,o,h,d),E=h===s?1:-1,T=E*o,P=E*t;return{start:{x:d.x+m.y*g*T,y:d.y+m.x*g*P*-1},end:{x:d.x+m.y*c*T*-1,y:d.y+m.x*c*P}}}},"./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/getDirectionMultiplier.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return u});var r=e("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/isPerpendicularEndFixed.js");function u(f,v){return Object(r.default)(f,v)?-1:1}},"./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/getHelperLine.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return u});var r=e("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/getDirectionMultiplier.js");function u(f,v,d){var t=f.columnPixelSpacing,o=f.rowPixelSpacing,s=f.perpendicularEnd,l=f.fixedPoint,a=Number.MAX_SAFE_INTEGER,i=Object(r.default)(l,s)*a;return{start:v,end:{x:v.x+d.y*o*i,y:v.y+d.x*t*i*-1}}}},"./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/getMovingPoint.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return u});var r=e("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/isPerpendicularEndFixed.js");function u(f,v,d){return Object(r.default)(f,d)?v:d}},"./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/isPerpendicularEndFixed.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return r});function r(u,f){return u===f}},"./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/lineHasLength.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return u});var r=e("./tools/annotation/bidirectionalTool/utils/getDistanceWithPixelSpacing.js");function u(f,v,d){var t=Object(r.default)(f,v,d.start,d.end);return t!==0}},"./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/movePerpendicularLine.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return o});var r=e("./externalModules.js"),u=e("./tools/annotation/bidirectionalTool/utils/getLineVector.js"),f=e("./tools/annotation/bidirectionalTool/moveHandle/getBaseData.js"),v=e("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/lineHasLength.js"),d=e("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/getHelperLine.js"),t=e("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/updatePerpendicularLine.js");function o(s,l,a,i){var h=r.default.cornerstoneMath.lineSegment,g=Object(f.default)(l,a,i),c=g.columnPixelSpacing,m=g.rowPixelSpacing,E=g.start,T=g.longLine,P=g.intersection;if(!Object(v.default)(c,m,T))return!1;var M=Object(u.default)(c,m,E,P),C=Object(d.default)(g,s,M),O=h.intersectLine(T,C);if(!O)return!1;var I=Object(t.default)(g,O,C,M);return l.handles.perpendicularStart.x=I.start.x,l.handles.perpendicularStart.y=I.start.y,l.handles.perpendicularEnd.x=I.end.x,l.handles.perpendicularEnd.y=I.end.y,!0}},"./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/updatePerpendicularLine.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return d});var r=e("../node_modules/@babel/runtime/helpers/defineProperty.js"),u=e.n(r),f=e("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/getDirectionMultiplier.js"),v=e("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/getMovingPoint.js");function d(t,o,s,l){var a,i=t.columnPixelSpacing,h=t.rowPixelSpacing,g=t.fixedPoint,c=t.perpendicularStart,m=t.perpendicularEnd,E=t.distanceToFixed,T=Object(f.default)(g,m)*E,P=Object(v.default)(g,c,m),M=P===c,C=M?"start":"end",O=M?"end":"start";return a={},u()(a,C,{x:s.start.x,y:s.start.y}),u()(a,O,{x:o.x+l.y*h*T,y:o.y+l.x*i*T*-1}),a}},"./tools/annotation/bidirectionalTool/moveHandle/setHandlesPosition.js":function(H,n,e){e.r(n);var r=e("./externalModules.js"),u=e("./tools/annotation/bidirectionalTool/moveHandle/moveLongLine/moveLongLine.js"),f=e("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/movePerpendicularLine.js");n.default=function(v,d,t,o){var s,l,a,i,h,g,c={},m={},E={x:d.currentPoints.image.x+o.x,y:d.currentPoints.image.y+o.y};v.index===0?(a=Object(u.default)(E,t,d,t.handles.end),a?(v.x=E.x,v.y=E.y):(d.currentPoints.image.x=v.x,d.currentPoints.image.y=v.y)):v.index===1?(a=Object(u.default)(E,t,d,t.handles.start),a?(v.x=E.x,v.y=E.y):(d.currentPoints.image.x=v.x,d.currentPoints.image.y=v.y)):v.index===2?(l=!1,c.start={x:t.handles.start.x,y:t.handles.start.y},c.end={x:t.handles.end.x,y:t.handles.end.y},m.start={x:t.handles.perpendicularEnd.x,y:t.handles.perpendicularEnd.y},m.end={x:E.x,y:E.y},i=r.default.cornerstoneMath.lineSegment.intersectLine(c,m),i||(m.end={x:t.handles.perpendicularStart.x,y:t.handles.perpendicularStart.y},i=r.default.cornerstoneMath.lineSegment.intersectLine(c,m),h=r.default.cornerstoneMath.point.distance(i,t.handles.start),g=r.default.cornerstoneMath.point.distance(i,t.handles.end),(!i||h<3||g<3)&&(l=!0)),s=!1,l||(s=Object(f.default)(E,t,d,t.handles.perpendicularEnd),s||(d.currentPoints.image.x=t.handles.perpendicularStart.x,d.currentPoints.image.y=t.handles.perpendicularStart.y))):v.index===3&&(l=!1,c.start={x:t.handles.start.x,y:t.handles.start.y},c.end={x:t.handles.end.x,y:t.handles.end.y},m.start={x:t.handles.perpendicularStart.x,y:t.handles.perpendicularStart.y},m.end={x:E.x,y:E.y},i=r.default.cornerstoneMath.lineSegment.intersectLine(c,m),i||(m.end={x:t.handles.perpendicularEnd.x,y:t.handles.perpendicularEnd.y},i=r.default.cornerstoneMath.lineSegment.intersectLine(c,m),h=r.default.cornerstoneMath.point.distance(i,t.handles.start),g=r.default.cornerstoneMath.point.distance(i,t.handles.end),(!i||h<3||g<3)&&(l=!0)),s=!1,l||(s=Object(f.default)(E,t,d,t.handles.perpendicularStart),s||(d.currentPoints.image.x=t.handles.perpendicularEnd.x,d.currentPoints.image.y=t.handles.perpendicularEnd.y)))}},"./tools/annotation/bidirectionalTool/moveHandle/touchMoveHandle.js":function(H,n,e){e.r(n);var r=e("./externalModules.js"),u=e("./store/index.js"),f=e("./events.js"),v=e("./tools/annotation/bidirectionalTool/moveHandle/setHandlesPosition.js"),d=e("./util/getActiveTool.js"),t=e("./tools/base/BaseAnnotationTool.js"),o=[f.default.TOUCH_END,f.default.TOUCH_DRAG_END,f.default.TOUCH_PINCH,f.default.TOUCH_PRESS,f.default.TAP];n.default=function(s,l,a,i,h,g){var c=s.element,m=s.image,E=s.buttons,T={x:i.x-s.currentPoints.image.x,y:i.y-s.currentPoints.image.y},P=function(O){var I=O.detail;i.hasMoved=!0,i.index===void 0||i.index===null?(i.x=I.currentPoints.image.x+T.x,i.y=I.currentPoints.image.y+T.y):Object(v.default)(i,I,a,T),g&&(i.x=Math.max(i.x,0),i.x=Math.min(i.x,I.image.width),i.y=Math.max(i.y,0),i.y=Math.min(i.y,I.image.height)),a.invalidated=!0,r.default.cornerstone.updateImage(c);var _=Object(d.default)(c,E,"touch");_ instanceof t.default&&_.updateCachedStats(m,c,a);var D={toolName:l,toolType:l,element:c,measurementData:a};r.default.cornerstone.triggerEvent(c,f.default.MEASUREMENT_MODIFIED,D)};i.active=!0,u.state.isToolLocked=!0,c.addEventListener(f.default.TOUCH_DRAG,P);var M=function C(){i.active=!1,u.state.isToolLocked=!1,c.removeEventListener(f.default.TOUCH_DRAG,P),o.forEach(function(O){c.removeEventListener(O,C)}),r.default.cornerstone.updateImage(c),typeof h=="function"&&h()};o.forEach(function(C){c.addEventListener(C,M)})}},"./tools/annotation/bidirectionalTool/pointNearTool.js":function(H,n,e){e.r(n);var r=e("./util/getProximityThreshold.js"),u=e("./externalModules.js"),f=e("./util/pointInsideBoundingBox.js"),v=function(t,o,s,l){var a=u.default.cornerstone,i=u.default.cornerstoneMath,h={start:a.pixelToCanvas(t,o.perpendicularStart),end:a.pixelToCanvas(t,o.perpendicularEnd)},g=i.lineSegment.distanceToPoint(h,s);return g<l};n.default=function(d,t,o){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"mouse",l=u.default.cornerstone,a=u.default.cornerstoneMath,i=t.handles,h={start:l.pixelToCanvas(d,i.start),end:l.pixelToCanvas(d,i.end)},g=a.lineSegment.distanceToPoint(h,o);if(Object(f.default)(i.textBox,o))return!0;var c=Object(r.default)(s,"Bidirectional");return v(d,i,o,c)?!0:g<c}},"./tools/annotation/bidirectionalTool/renderToolData.js":function(H,n,e){e.r(n);var r=e("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),u=e.n(r),f=e("./drawing/drawHandles.js"),v=e("./tools/annotation/bidirectionalTool/utils/updatePerpendicularLineHandles.js"),d=e("./store/index.js"),t=e("./stateManagement/toolStyle.js"),o=e("./stateManagement/toolColors.js"),s=e("./stateManagement/toolState.js"),l=e("./drawing/index.js"),a=e("./drawing/drawLinkedTextBox.js"),i=e("./util/getPixelSpacing.js");n.default=function(g){var c=this,m=g.detail,E=m.element,T=m.canvasContext,P=m.image,M=this.configuration,C=M.handleRadius,O=M.drawHandlesOnHover,I=M.hideHandlesIfMoving,_=M.renderDashed,D=Object(d.getModule)("globalConfiguration").configuration.lineDash,L=Object(s.getToolState)(E,this.name);if(L){var S=Object(i.default)(P),A=S.rowPixelSpacing,U=S.colPixelSpacing;if(!(!A||!U))for(var B=Object(l.getNewContext)(T.canvas),b,y=t.default.getToolWidth(),x=function(W){var K=L.data[W];if(K.visible===!1)return"continue";b=o.default.getColorIfActive(K),K.invalidated===!0&&(K.longestDiameter&&K.shortestDiameter?c.throttledUpdateCachedStats(P,E,K):c.updateCachedStats(P,E,K)),Object(l.draw)(B,function(N){Object(l.setShadow)(N,c.configuration);var z=K.handles,Y=z.start,$=z.end,J=z.perpendicularStart,te=z.perpendicularEnd,ne=z.textBox,de={color:b},w={color:b,strokeWidth:G};_&&(de.lineDash=D,w.lineDash=D),Object(l.drawLine)(N,E,Y,$,de);var G=y;Object(v.default)(m,K),Object(l.drawLine)(N,E,J,te,w);var Z={color:b,handleRadius:C,drawHandlesIfActive:O,hideHandlesIfMoving:I};c.configuration.drawHandles&&Object(f.default)(N,m,K.handles,Z);var Q=10,k=function(oe){return[oe.start,oe.end,oe.perpendicularStart,oe.perpendicularEnd]},ae=h(K,A,U);Object(a.default)(N,E,ne,ae,K.handles,k,b,y,Q,!0)})},j=0;j<L.data.length;j++)var p=x(j)}};var h=function(c,m,E){var T=" mm";(!m||!E)&&(T=" pixels");var P=" L ".concat(c.longestDiameter).concat(T),M=" W ".concat(c.shortestDiameter).concat(T),C=c.labels;return C&&Array.isArray(C)?[].concat(u()(C),[P,M]):[P,M]}},"./tools/annotation/bidirectionalTool/utils/calculateLongestAndShortestDiameters.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return r});function r(u,f){var v=f.rowPixelSpacing,d=f.colPixelSpacing,t=u.handles,o=t.start,s=t.end,l=t.perpendicularStart,a=t.perpendicularEnd,i=(o.x-s.x)*(d||1),h=(o.y-s.y)*(v||1),g=Math.sqrt(i*i+h*h),c=(l.x-a.x)*(d||1),m=(l.y-a.y)*(v||1),E=Math.sqrt(c*c+m*m);if(E||(E=0),E>g){var T=E,P=g;g=T,E=P}return{longestDiameter:g.toFixed(1),shortestDiameter:E.toFixed(1)}}},"./tools/annotation/bidirectionalTool/utils/getDistanceWithPixelSpacing.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return r});function r(u,f,v,d){var t=(v.x-d.x)/f,o=(v.y-d.y)/u;return Math.sqrt(t*t+o*o)}},"./tools/annotation/bidirectionalTool/utils/getLineVector.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return r});function r(u,f,v,d){var t=(v.x-d.x)*u,o=(v.y-d.y)*f,s=Math.sqrt(t*t+o*o),l=t/s,a=o/s;return{x:l,y:a,length:s}}},"./tools/annotation/bidirectionalTool/utils/updatePerpendicularLineHandles.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return u});var r=e("./tools/annotation/bidirectionalTool/utils/getLineVector.js");function u(f,v){if(!v.handles.perpendicularStart.locked)return!1;var d,t,o,s,l=v.handles,a=l.start,i=l.end,h=f.image,g=h.columnPixelSpacing,c=g===void 0?1:g,m=h.rowPixelSpacing,E=m===void 0?1:m;if(a.x===i.x&&a.y===i.y)d=a.x,t=a.y,o=i.x,s=i.y;else{var T={x:(a.x+i.x)/2,y:(a.y+i.y)/2},P=Object(r.default)(c,E,a,i),M=P.length/2,C=M/(2*E),O=M/(2*c);d=T.x+O*P.y,t=T.y-C*P.x,o=T.x-O*P.y,s=T.y+C*P.x}return v.handles.perpendicularStart.x=d,v.handles.perpendicularStart.y=t,v.handles.perpendicularEnd.x=o,v.handles.perpendicularEnd.y=s,!0}},"./tools/annotation/index.js":function(H,n,e){e.r(n);var r=e("./tools/annotation/AngleTool.js"),u=e("./tools/annotation/ArrowAnnotateTool.js"),f=e("./tools/annotation/BidirectionalTool.js"),v=e("./tools/annotation/CircleRoiTool.js"),d=e("./tools/annotation/CobbAngleTool.js"),t=e("./tools/annotation/EllipticalRoiTool.js"),o=e("./tools/annotation/FreehandRoiTool.js"),s=e("./tools/annotation/LengthTool.js"),l=e("./tools/annotation/ProbeTool.js"),a=e("./tools/annotation/RectangleRoiTool.js"),i=e("./tools/annotation/TextMarkerTool.js");e.d(n,"AngleTool",function(){return r.default}),e.d(n,"ArrowAnnotateTool",function(){return u.default}),e.d(n,"BidirectionalTool",function(){return f.default}),e.d(n,"CircleRoiTool",function(){return v.default}),e.d(n,"CobbAngleTool",function(){return d.default}),e.d(n,"EllipticalRoiTool",function(){return t.default}),e.d(n,"FreehandRoiTool",function(){return o.default}),e.d(n,"LengthTool",function(){return s.default}),e.d(n,"ProbeTool",function(){return l.default}),e.d(n,"RectangleRoiTool",function(){return a.default}),e.d(n,"TextMarkerTool",function(){return i.default}),n.default={AngleTool:r.default,ArrowAnnotateTool:u.default,BidirectionalTool:f.default,CircleRoiTool:v.default,CobbAngleTool:d.default,EllipticalRoiTool:t.default,FreehandRoiTool:o.default,LengthTool:s.default,ProbeTool:l.default,RectangleRoiTool:a.default,TextMarkerTool:i.default}},"./tools/base/BaseAnnotationTool.js":function(H,n,e){e.r(n);var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=e.n(o),l=e("../node_modules/@babel/runtime/helpers/inherits.js"),a=e.n(l),i=e("./tools/base/BaseTool.js"),h=e("./stateManagement/toolState.js"),g=e("./manipulators/handleActivator.js"),c=e("./util/findAndMoveHelpers.js"),m=e("./util/logger.js"),E=Object(m.getLogger)("baseAnnotationTool"),T=function(P){a()(M,P);function M(){return u()(this,M),t()(this,s()(M).apply(this,arguments))}return v()(M,[{key:"createNewMeasurement",value:function(O){throw new Error("Method createNewMeasurement not implemented for ".concat(this.name,"."))}},{key:"pointNearTool",value:function(O,I,_){throw new Error("Method pointNearTool not implemented for ".concat(this.name,"."))}},{key:"distanceFromPoint",value:function(O,I,_){throw new Error("Method distanceFromPoint not implemented for ".concat(this.name,"."))}},{key:"renderToolData",value:function(O){throw new Error("renderToolData not implemented for ".concat(this.name,"."))}},{key:"mouseMoveCallback",value:function(O){for(var I=O.detail,_=I.element,D=I.currentPoints,L=D.canvas,S=Object(h.getToolState)(_,this.name),A=!1,U=0;U<S.data.length;U++){var B=S.data[U];Object(g.default)(_,B.handles,L)===!0&&(A=!0);var b=this.pointNearTool(_,B,L,"mouse")&&!B.active,y=!this.pointNearTool(_,B,L,"mouse")&&B.active;(b||y)&&(B.active=!B.active,A=!0)}return A}},{key:"handleSelectedCallback",value:function(O,I,_){var D=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"mouse";Object(c.moveHandleNearImagePoint)(O,this,I,_,D)}},{key:"toolSelectedCallback",value:function(O,I){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"mouse";Object(c.moveAnnotation)(O,this,I,_)}},{key:"updateCachedStats",value:function(O,I,_){E.warn("updateCachedStats not implemented for ".concat(this.name,"."))}}]),M}(i.default);n.default=T},"./tools/base/BaseBrushTool.js":function(H,n,e){e.r(n);var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=e.n(o),l=e("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),a=e.n(l),i=e("../node_modules/@babel/runtime/helpers/inherits.js"),h=e.n(i),g=e("./tools/base/BaseTool.js"),c=e("./events.js"),m=e("./externalModules.js"),E=e("./store/isToolActiveForElement.js"),T=e("./store/index.js"),P=e("./util/segmentation/index.js"),M=Object(T.getModule)("segmentation"),C=function(O){h()(I,O);function I(_){var D,L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return u()(this,I),L.configuration||(L.configuration={alwaysEraseOnClick:!1}),D=t()(this,s()(I).call(this,_,L)),D.updateOnMouseMove=!0,D.hideDefaultCursor=!0,D._drawing=!1,D._drawingMouseUpCallback=D._drawingMouseUpCallback.bind(a()(D)),D}return v()(I,[{key:"renderBrush",value:function(D){throw new Error("Method renderBrush not implemented for ".concat(this.name,"."))}},{key:"_paint",value:function(D){throw new Error("Method _paint not implemented for ".concat(this.name,"."))}},{key:"mouseDragCallback",value:function(D){var L=D.detail.currentPoints;this._lastImageCoords=L.image,this._drawing&&this._paint(D)}},{key:"preMouseDownCallback",value:function(D){var L=D.detail,S=L.element,A=L.currentPoints;return this._startPainting(D),this._lastImageCoords=A.image,this._drawing=!0,this._startListeningForMouseUp(S),this._paint(D),!0}},{key:"_startPainting",value:function(D){var L=D.detail,S=L.element,A=M.configuration,U=M.getters,B=U.labelmap2D(S),b=B.labelmap2D,y=B.labelmap3D,x=B.currentImageIdIndex,j=B.activeLabelmapIndex,p=this._isCtrlDown(L)||this.configuration.alwaysEraseOnClick;if(this.paintEventData={labelmap2D:b,labelmap3D:y,currentImageIdIndex:x,activeLabelmapIndex:j,shouldErase:p},A.storeHistory){var R=b.pixelData.slice();this.paintEventData.previousPixelData=R}}},{key:"_endPainting",value:function(D){for(var L=M.configuration,S=M.setters,A=this.paintEventData,U=A.labelmap2D,B=A.currentImageIdIndex,b=new Set(U.pixelData),y=b.values(),x=[],j=!1;!j;){var p=y.next();j=p.done,j||x.push(p.value)}if(U.segmentsOnLabelmap=x,L.storeHistory){var R=this.paintEventData.previousPixelData,W=U.pixelData,K={imageIdIndex:B,diff:Object(P.getDiffBetweenPixelData)(R,W)};S.pushState(this.element,[K])}Object(P.triggerLabelmapModifiedEvent)(this.element)}},{key:"mouseMoveCallback",value:function(D){var L=D.detail.currentPoints;this._lastImageCoords=L.image}},{key:"renderToolData",value:function(D){var L=D.detail,S=L.element;Object(E.default)(S,this.name)&&this.renderBrush(D)}},{key:"passiveCallback",value:function(D){try{m.default.cornerstone.updateImage(this.element)}catch{return}}},{key:"_drawingMouseUpCallback",value:function(D){var L=D.detail,S=L.element;this._endPainting(D),this._drawing=!1,this._mouseUpRender=!0,this._stopListeningForMouseUp(S)}},{key:"newImageCallback",value:function(D){this._drawing&&(this._endPainting(D),this._startPainting(D))}},{key:"_startListeningForMouseUp",value:function(D){D.removeEventListener(c.default.MOUSE_UP,this._drawingMouseUpCallback),D.removeEventListener(c.default.MOUSE_CLICK,this._drawingMouseUpCallback),D.addEventListener(c.default.MOUSE_UP,this._drawingMouseUpCallback),D.addEventListener(c.default.MOUSE_CLICK,this._drawingMouseUpCallback),m.default.cornerstone.updateImage(D)}},{key:"_stopListeningForMouseUp",value:function(D){D.removeEventListener(c.default.MOUSE_UP,this._drawingMouseUpCallback),D.removeEventListener(c.default.MOUSE_CLICK,this._drawingMouseUpCallback),m.default.cornerstone.updateImage(D)}},{key:"increaseBrushSize",value:function(){var D=M.configuration,L=M.setters,S=D.radius,A=Math.floor(S*1.2);A===S&&(A+=1),L.radius(A)}},{key:"decreaseBrushSize",value:function(){var D=M.configuration,L=M.setters,S=D.radius,A=Math.floor(S*.8);L.radius(A)}},{key:"_isCtrlDown",value:function(D){return D.event&&D.event.ctrlKey||D.ctrlKey}}]),I}(g.default);n.default=C},"./tools/base/BaseTool.js":function(H,n,e){e.r(n);var r=e("../node_modules/@babel/runtime/helpers/typeof.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/createClass.js"),t=e.n(d),o=e("./mixins/index.js"),s=e("./util/logger.js"),l=e("./util/deepmerge.js"),a=e("./store/setToolCursor.js"),i=e("./store/index.js"),h=Object(s.getLogger)("tools:base:BaseTool"),g=Object(i.getModule)("globalConfiguration"),c=function(){function m(E,T){v()(this,m),this.initialConfiguration=Object(l.default)(T,E);var P=this.initialConfiguration,M=P.name,C=P.strategies,O=P.defaultStrategy,I=P.configuration,_=P.supportedInteractionTypes,D=P.mixins,L=P.svgCursor;this.name=M,this.mode="disabled",this.element=void 0,this.supportedInteractionTypes=_||[],this.strategies=C||{},this.defaultStrategy=O||Object.keys(this.strategies)[0]||void 0,this.activeStrategy=this.defaultStrategy,L&&(this.svgCursor=L),this._options={},this._configuration=Object.assign({},I),this.updateOnMouseMove=!1,this.hideDefaultCursor=!1,D&&D.length&&this._applyMixins(D),this._cursors=Object.assign({},this.initialConfiguration.cursors);var S=this.defaultStrategy&&this._cursors[this.activeStrategy];S&&(this.svgCursor=S)}return t()(m,[{key:"mergeOptions",value:function(T){this._options=Object.assign({},this._options,T)}},{key:"clearOptions",value:function(){this._options={}}},{key:"applyActiveStrategy",value:function(T,P){return this.strategies[this.activeStrategy].call(this,T,P)}},{key:"_applyMixins",value:function(T){for(var P=0;P<T.length;P++){var M=o.default["".concat(T[P])];u()(M)==="object"?(Object.assign(this,M),typeof this.initializeMixin=="function"&&this.initializeMixin()):h.warn("".concat(this.name,": mixin ").concat(o.default[P]," does not exist."))}this.initializeMixin==="function"&&delete this.initializeMixin}},{key:"setActiveStrategy",value:function(T){this.activeStrategy=T,g.configuration.showSVGCursors&&this.changeCursor(this.element,T)}},{key:"changeCursor",value:function(T,P){if(T){var M=this._cursors[P];M&&(this.svgCursor=M,this.mode==="active"&&Object(a.setToolCursor)(T,M))}}},{key:"configuration",get:function(){return this._configuration},set:function(T){this._configuration=T}},{key:"options",get:function(){return this._options}}],[{key:"configuration",get:function(){}}]),m}();n.default=c},"./tools/base/index.js":function(H,n,e){e.r(n);var r=e("./tools/base/BaseAnnotationTool.js"),u=e("./tools/base/BaseTool.js"),f=e("./tools/base/BaseBrushTool.js");e.d(n,"BaseAnnotationTool",function(){return r.default}),e.d(n,"BaseBrushTool",function(){return f.default}),e.d(n,"BaseTool",function(){return u.default}),n.default={BaseAnnotationTool:r.default,BaseBrushTool:f.default,BaseTool:u.default}},"./tools/cursors/MouseCursor.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return s});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("./stateManagement/toolColors.js"),t=e("./store/index.js"),o=t.modules.cursor,s=function(){function l(a,i){u()(this,l),this.iconGroupString=a,this.options=Object.assign({},o.getters.defaultOptions(),i)}return v()(l,[{key:"getIconSVG",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},h=this._generateIconSVGString(i);return new Blob([h],{type:"image/svg+xml"})}},{key:"getIconSVGString",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._generateIconSVGString(i)}},{key:"getIconWithPointerSVG",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},h=this._generateIconWithPointerSVGString(i);return new Blob([h],{type:"image/svg+xml"})}},{key:"getIconWithPointerString",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._generateIconWithPointerSVGString(i)}},{key:"_generateIconWithPointerSVGString",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},h=Object.assign({},this.options,i),g=h.mousePointerGroupString,c=h.iconSize,m=h.viewBox,E=c/Math.max(m.x,m.y),T=16+c,P=`
        <svg
        data-icon="cursor" role="img" xmlns="http://www.w3.org/2000/svg"
        width="`.concat(T,'" height="').concat(T,'" viewBox="0 0 ').concat(T," ").concat(T,`"
      >
        <g>
          `).concat(g,`
        </g>
        <g transform="translate(16, 16) scale(`).concat(E,`)">
          `).concat(this.iconGroupString,`
        </g>
      </svg>`);return this._injectColors(P,h)}},{key:"_generateIconSVGString",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},h=Object.assign({},this.options,i),g=h.iconSize,c=h.viewBox,m=`
      <svg
        data-icon="cursor" role="img" xmlns="http://www.w3.org/2000/svg"
        width="`.concat(g,'" height="').concat(g,`" viewBox="0 0
        `).concat(c.x," ").concat(c.y,`"
      >
        `).concat(this.iconGroupString,`
      </svg>`);return this._injectColors(m,h)}},{key:"_injectColors",value:function(i){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},g=h.activeColor||d.default.getActiveColor(),c=h.toolColor||d.default.getToolColor(),m=h.fillColor||d.default.getFillColor();return i.replace(/ACTIVE_COLOR/g,"".concat(g)).replace(/TOOL_COLOR/g,"".concat(c)).replace(/FILL_COLOR/g,"".concat(m))}},{key:"mousePoint",get:function(){var i=this.options.mousePoint;return"".concat(i.x," ").concat(i.y)}}]),l}()},"./tools/cursors/index.js":function(H,n,e){e.r(n),e.d(n,"angleCursor",function(){return u}),e.d(n,"arrowAnnotateCursor",function(){return f}),e.d(n,"bidirectionalCursor",function(){return v}),e.d(n,"cobbAngleCursor",function(){return d}),e.d(n,"circleRoiCursor",function(){return t}),e.d(n,"ellipticalRoiCursor",function(){return o}),e.d(n,"freehandRoiCursor",function(){return s}),e.d(n,"freehandRoiSculptorCursor",function(){return l}),e.d(n,"lengthCursor",function(){return a}),e.d(n,"probeCursor",function(){return i}),e.d(n,"rectangleRoiCursor",function(){return h}),e.d(n,"textMarkerCursor",function(){return g}),e.d(n,"crosshairsCursor",function(){return c}),e.d(n,"eraserCursor",function(){return m}),e.d(n,"magnifyCursor",function(){return E}),e.d(n,"panCursor",function(){return T}),e.d(n,"rotateCursor",function(){return P}),e.d(n,"stackScrollCursor",function(){return M}),e.d(n,"wwwcRegionCursor",function(){return C}),e.d(n,"wwwcCursor",function(){return O}),e.d(n,"zoomCursor",function(){return I}),e.d(n,"freehandEraseInsideCursor",function(){return B}),e.d(n,"freehandFillInsideCursor",function(){return b}),e.d(n,"freehandEraseOutsideCursor",function(){return y}),e.d(n,"freehandFillOutsideCursor",function(){return x}),e.d(n,"segRectangleEraseInsideCursor",function(){return j}),e.d(n,"segRectangleFillInsideCursor",function(){return p}),e.d(n,"segRectangleEraseOutsideCursor",function(){return R}),e.d(n,"segRectangleFillOutsideCursor",function(){return W}),e.d(n,"segCircleEraseInsideCursor",function(){return K}),e.d(n,"segCircleFillInsideCursor",function(){return N}),e.d(n,"segCircleEraseOutsideCursor",function(){return z}),e.d(n,"segCircleFillOutsideCursor",function(){return Y});var r=e("./tools/cursors/MouseCursor.js"),u=new r.default(`<path fill="ACTIVE_COLOR" d="M1203 544q0 13-10 23l-393 393 393 393q10 10 10 23t-10 23l-50
        50q-10 10-23 10t-23-10l-466-466q-10-10-10-23t10-23l466-466q10-10 23-10t23
        10l50 50q10 10 10 23z"
      />`,{viewBox:{x:1792,y:1792}}),f=new r.default(`<g id="arrowAnnotate-group" fill="none" stroke-width="1" stroke="ACTIVE_COLOR" stroke-linecap="round" stroke-linejoin="round">
    <path id="arrowAnnotate-arrow" d="M23,7 l-15,15 M7,17 l0,6 6,0" stroke-width="2" />
  </g>`,{viewBox:{x:24,y:24}}),v=new r.default(`<g fill="ACTIVE_COLOR" stroke-width="3" stroke="ACTIVE_COLOR">
    <path d="M27.63 3.21L3.12 28.81"></path>
    <path d="M27.63 15.75L15.27 4.43"></path>
    <path d="M16.5 4.28C16.5 4.96 15.95 5.51 15.27 5.51C14.59 5.51 14.03 4.96 14.03 4.28C14.03 3.59 14.59 3.04 15.27 3.04C15.95 3.04 16.5 3.59 16.5 4.28Z" ></path>
    <path d="M28.87 3.19C28.87 3.87 28.31 4.43 27.63 4.43C26.95 4.43 26.4 3.87 26.4 3.19C26.4 2.51 26.95 1.95 27.63 1.95C28.31 1.95 28.87 2.51 28.87 3.19Z"></path>
    <path d="M28.87 15.75C28.87 16.43 28.31 16.99 27.63 16.99C26.95 16.99 26.4 16.43 26.4 15.75C26.4 15.07 26.95 14.51 27.63 14.51C28.31 14.51 28.87 15.07 28.87 15.75Z"></path>
    <path d="M4.73 28.44C4.73 29.12 4.17 29.68 3.49 29.68C2.81 29.68 2.25 29.12 2.25 28.44C2.25 27.76 2.81 27.2 3.49 27.2C4.17 27.2 4.73 27.76 4.73 28.44Z"></path>
  </g>`,{viewBox:{x:48,y:48}}),d=new r.default(`<g stroke="ACTIVE_COLOR" stroke-width="3">
    <path d="M28.59 2.34L3.82 12.32"></path>
    <path d="M28.59 29.66L3.82 19.68"></path>
    <path stroke-dasharray="2" fill-opacity="0" d="M12.37
      23.06C12.67 22.36 12.85 21.93 12.92 21.76C14.6 17.8 14.68 13.35 13.15
      9.33C13.11 9.24 13.02 9 12.88 8.63">
    </path>
  </g>`,{viewBox:{x:32,y:32}}),t=new r.default('<circle stroke="ACTIVE_COLOR" fill="none" stroke-width="3" cx="16" cy="16" r="14" />',{viewBox:{x:32,y:32}}),o=new r.default(`<path stroke="ACTIVE_COLOR" fill="none" stroke-width="3" d="M30.74 15.76C30.74 20.99 24.14 25.23 16
    25.23C7.86 25.23 1.26 20.99 1.26 15.76C1.26 10.54 7.86 6.3 16 6.3C24.14
    6.3 30.74 10.54 30.74 15.76Z"
    />`,{viewBox:{x:32,y:32}}),s=new r.default(`
  <g fill="ACTIVE_COLOR" stroke="ACTIVE_COLOR" stroke-width="2">
    <ellipse ry="1" rx="1" id="svg_3" cy="4.240343" cx="14.306499"/>
    <line id="svg_4" y2="3.58462" x2="12.242186" y1="3.997482" x1="13.432202"/>
    <line id="svg_5" y2="3.268901" x2="10.857882" y1="3.608906" x1="12.387902"/>
    <line id="svg_6" y2="3.147471" x2="9.740724" y1="3.293187" x1="10.955026"/>
    <line id="svg_7" y2="3.147471" x2="8.089274" y1="3.196043" x1="9.983585"/>
    <line id="svg_8" y2="3.268901" x2="6.874972" y1="3.123185" x1="8.307848"/>
    <line id="svg_9" y2="3.657478" x2="5.587812" y1="3.220329" x1="7.020688"/>
    <line id="svg_10" y2="4.046054" x2="4.737801" y1="3.560334" x1="5.854959"/>
    <line id="svg_11" y2="4.337487" x2="4.300652" y1="3.997482" x1="4.834945"/>
    <line id="svg_12" y2="4.726063" x2="3.88779" y1="4.191771" x1="4.470655"/>
    <line id="svg_15" y2="5.3575" x2="3.377783" y1="4.604633" x1="3.960648"/>
    <line id="svg_16" y2="6.183226" x2="2.916348" y1="5.138926" x1="3.547785"/>
    <line id="svg_17" y2="6.960379" x2="2.770632" y1="5.867507" x1="3.037779"/>
    <line id="svg_18" y2="7.713246" x2="2.673488" y1="6.741804" x1="2.819204"/>
    <line id="svg_19" y2="8.684687" x2="2.697774" y1="7.616102" x1="2.673488"/>
    <line id="svg_20" y2="9.753273" x2="2.892062" y1="8.611829" x1="2.697774"/>
    <line id="svg_21" y2="10.724714" x2="3.134923" y1="9.534698" x1="2.84349"/>
    <line id="svg_23" y2="11.647583" x2="3.596357" y1="10.578998" x1="3.086351"/>
    <line id="svg_25" y2="12.521881" x2="4.276366" y1="11.501867" x1="3.499213"/>
    <line id="svg_26" y2="13.930471" x2="5.830673" y1="12.376165" x1="4.13065"/>
    <line id="svg_28" y2="14.707624" x2="7.263549" y1="13.881899" x1="5.733528"/>
    <line id="svg_29" y2="15.339061" x2="8.963571" y1="14.61048" x1="7.06926"/>
    <line id="svg_30" y2="15.581921" x2="10.882168" y1="15.314775" x1="8.817855"/>
    <line id="svg_31" y2="15.460491" x2="12.023612" y1="15.581921" x1="10.785024"/>
    <line id="svg_33" y2="15.120487" x2="13.092197" y1="15.484777" x1="11.877895"/>
    <line id="svg_34" y2="14.586194" x2="13.86935" y1="15.217631" x1="12.897909"/>
    <line id="svg_35" y2="13.833327" x2="14.597931" y1="14.756196" x1="13.699348"/>
    <line id="svg_37" y2="12.716169" x2="15.180796" y1="13.881899" x1="14.549359"/>
    <line id="svg_39" y2="11.429009" x2="15.520801" y1="12.813313" x1="15.15651"/>
    <ellipse ry="1" rx="1" id="svg_40" cy="10.967574" cx="15.520801"/>
  </g>`,{viewBox:{x:18,y:18}}),l=new r.default(`<g id="icon-freehand-sculpt" fill="none" stroke-width="1.5" stroke="ACTIVE_COLOR" stroke-linecap="round" stroke-linejoin="round">
      <line id="svg_1" y2="2.559367" x2="10.184807" y1="4.467781" x1="8.81711"/>
      <line id="svg_4" y2="1.493836" x2="11.727442" y1="2.766112" x1="10.089386"/>
      <line id="svg_7" y2="1.080346" x2="13.047428" y1="1.748291" x1="11.345759"/>
      <line id="svg_8" y2="1.000829" x2="14.351511" y1="1.112153" x1="12.77707"/>
      <line id="svg_9" y2="1.350705" x2="15.242104" y1="0.905408" x1="13.969828"/>
      <line id="svg_10" y2="2.098167" x2="15.862339" y1="1.14396" x1="14.955842"/>
      <line id="svg_11" y2="3.195505" x2="16.41896" y1="1.939133" x1="15.766918"/>
      <line id="svg_12" y2="4.292843" x2="16.530284" y1="2.925147" x1="16.387153"/>
      <line id="svg_16" y2="5.644637" x2="16.196311" y1="3.831643" x1="16.593898"/>
      <line id="svg_18" y2="7.266789" x2="15.623787" y1="5.19934" x1="16.275829"/>
      <line id="svg_19" y2="10.813258" x2="14.526449" y1="6.726071" x1="15.766918"/>
      <line id="svg_20" y2="5.056209" x2="8.085552" y1="4.181519" x1="8.976145"/>
      <line id="svg_23" y2="5.326568" x2="7.481221" y1="4.78585" x1="8.403621"/>
      <line id="svg_24" y2="5.565119" x2="6.749662" y1="5.294761" x1="7.624352"/>
      <line id="svg_25" y2="5.994512" x2="5.429675" y1="5.533312" x1="6.956407"/>
      <line id="svg_27" y2="6.551133" x2="4.284627" y1="5.962706" x1="5.572807"/>
      <line id="svg_28" y2="7.584858" x2="3.044158" y1="6.392099" x1="4.427758"/>
      <line id="svg_29" y2="8.84123" x2="2.185372" y1="7.489437" x1="3.219096"/>
      <line id="svg_31" y2="10.606513" x2="1.644654" y1="8.602678" x1="2.280792"/>
      <line id="svg_32" y2="13.214679" x2="1.48562" y1="10.352058" x1="1.724171"/>
      <line id="svg_33" y2="14.375631" x2="1.676461" y1="12.992031" x1="1.453813"/>
      <line id="svg_34" y2="15.298031" x2="2.264889" y1="14.152983" x1="1.517427"/>
      <line id="svg_35" y2="16.172721" x2="3.521261" y1="14.948155" x1="1.915013"/>
      <line id="svg_36" y2="16.824762" x2="5.207027" y1="15.997783" x1="3.28271"/>
      <line id="svg_38" y2="17.063314" x2="7.035924" y1="16.745245" x1="4.968475"/>
      <line id="svg_39" y2="16.888376" x2="9.278311" y1="17.047411" x1="6.733758"/>
      <line id="svg_40" y2="16.284045" x2="10.661911" y1="16.983797" x1="8.992048"/>
      <line id="svg_41" y2="15.313934" x2="11.647925" y1="16.395369" x1="10.455166"/>
      <line id="svg_44" y2="13.898527" x2="12.82478" y1="15.425259" x1="11.504794"/>
      <line id="svg_45" y2="12.037824" x2="14.144766" y1="14.312017" x1="12.522614"/>
      <line id="svg_47" y2="10.59061" x2="14.605966" y1="12.228665" x1="13.953925"/>
      <ellipse ry="1" rx="1" id="svg_48" cy="3.982726" cx="13.460918"/>
    </g>`,{viewBox:{x:18,y:18}}),a=new r.default(`<g id="length-group" fill="none" stroke-width="1" stroke="ACTIVE_COLOR" stroke-linecap="round" stroke-linejoin="round">
    <path id="length-dashes" d="m22.5,6 -16.5,16.5" stroke-width="3" stroke-dasharray="0.6666,5" />
  </g>`,{viewBox:{x:24,y:24}}),i=new r.default(`<path fill="ACTIVE_COLOR" d="M1152 896q0 106-75 181t-181 75-181-75-75-181 75-181 181-75 181 75
    75 181zm-256-544q-148 0-273 73t-198 198-73 273 73 273 198 198 273 73 273-73
    198-198 73-273-73-273-198-198-273-73zm768 544q0 209-103 385.5t-279.5
    279.5-385.5 103-385.5-103-279.5-279.5-103-385.5 103-385.5 279.5-279.5
    385.5-103 385.5 103 279.5 279.5 103 385.5z"
  />`,{viewBox:{x:1792,y:1792}}),h=new r.default(`<path fill="ACTIVE_COLOR" d="M1312 256h-832q-66 0-113 47t-47 113v832q0 66 47
    113t113 47h832q66 0 113-47t47-113v-832q0-66-47-113t-113-47zm288 160v832q0
    119-84.5 203.5t-203.5 84.5h-832q-119 0-203.5-84.5t-84.5-203.5v-832q0-119
    84.5-203.5t203.5-84.5h832q119 0 203.5 84.5t84.5 203.5z"
  />`,{viewBox:{x:1792,y:1792}}),g=new r.default(`<path fill="ACTIVE_COLOR" d="M789 559l-170 450q33 0 136.5 2t160.5 2q19 0
    57-2-87-253-184-452zm-725 1105l2-79q23-7 56-12.5t57-10.5 49.5-14.5 44.5-29
    31-50.5l237-616 280-724h128q8 14 11 21l205 480q33 78 106 257.5t114 274.5q15
    34 58 144.5t72 168.5q20 45 35 57 19 15 88 29.5t84 20.5q6 38 6 57 0 5-.5
    13.5t-.5 12.5q-63 0-190-8t-191-8q-76 0-215 7t-178 8q0-43 4-78l131-28q1 0
    12.5-2.5t15.5-3.5 14.5-4.5 15-6.5 11-8 9-11
    2.5-14q0-16-31-96.5t-72-177.5-42-100l-450-2q-26 58-76.5 195.5t-50.5 162.5q0
    22 14 37.5t43.5 24.5 48.5 13.5 57 8.5 41 4q1 19 1 58 0 9-2 27-58
    0-174.5-10t-174.5-10q-8 0-26.5 4t-21.5 4q-80 14-188 14z"
  />`,{viewBox:{x:1792,y:1792}}),c=new r.default(`<path fill="ACTIVE_COLOR" d="M1325 1024h-109q-26 0-45-19t-19-45v-128q0-26
    19-45t45-19h109q-32-108-112.5-188.5t-188.5-112.5v109q0 26-19 45t-45
    19h-128q-26 0-45-19t-19-45v-109q-108 32-188.5 112.5t-112.5 188.5h109q26
    0 45 19t19 45v128q0 26-19 45t-45 19h-109q32 108 112.5 188.5t188.5
    112.5v-109q0-26 19-45t45-19h128q26 0 45 19t19 45v109q108-32
    188.5-112.5t112.5-188.5zm339-192v128q0 26-19 45t-45 19h-143q-37 161-154.5
    278.5t-278.5 154.5v143q0 26-19 45t-45 19h-128q-26
    0-45-19t-19-45v-143q-161-37-278.5-154.5t-154.5-278.5h-143q-26
    0-45-19t-19-45v-128q0-26 19-45t45-19h143q37-161
    154.5-278.5t278.5-154.5v-143q0-26 19-45t45-19h128q26 0 45 19t19 45v143q161
    37 278.5 154.5t154.5 278.5h143q26 0 45 19t19 45z"
  />`,{viewBox:{x:1792,y:1792}}),m=new r.default(`<path transform="translate(0,1792) scale(1,-1)" fill="ACTIVE_COLOR" d="M960 1408l336-384h-768l-336 384h768zm1013-1077q15
      34 9.5 71.5t-30.5 65.5l-896 1024q-38 44-96 44h-768q-38
      0-69.5-20.5t-47.5-54.5q-15-34-9.5-71.5t30.5-65.5l896-1024q38-44 96-44h768q38
      0 69.5 20.5t47.5 54.5z"
    />`,{viewBox:{x:2048,y:1792}}),E=new r.default(`<path fill="ACTIVE_COLOR" d="M508.5 481.6l-129-129c-2.3-2.3-5.3-3.5-8.5-3.5h-10.3C395
      312 416 262.5 416 208 416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c54.5
      0 104-21 141.1-55.2V371c0 3.2 1.3 6.2 3.5 8.5l129 129c4.7 4.7 12.3 4.7 17
      0l9.9-9.9c4.7-4.7 4.7-12.3 0-17zM208 384c-97.3 0-176-78.7-176-176S110.7 32 208
      32s176 78.7 176 176-78.7 176-176 176z"
    />`,{viewBox:{x:512,y:512}}),T=new r.default(`<path fill="ACTIVE_COLOR" d="M1411 541l-355 355 355 355 144-144q29-31 70-14 39 17
      39 59v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39 14-69l144-144-355-355-355
      355 144 144q31 30 14 69-17 40-59 40h-448q-26 0-45-19t-19-45v-448q0-42 40-59
      39-17 69 14l144 144 355-355-355-355-144 144q-19 19-45 19-12
      0-24-5-40-17-40-59v-448q0-26 19-45t45-19h448q42 0 59 40 17 39-14 69l-144
      144 355 355 355-355-144-144q-31-30-14-69 17-40 59-40h448q26 0 45 19t19
      45v448q0 42-39 59-13 5-25 5-26 0-45-19z"
    />`,{viewBox:{x:1792,y:1792}}),P=new r.default(`<path fill="ACTIVE_COLOR" d="M1664 256v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39
      14-69l138-138q-148-137-349-137-104 0-198.5 40.5t-163.5 109.5-109.5
      163.5-40.5 198.5 40.5 198.5 109.5 163.5 163.5 109.5 198.5 40.5q119 0
      225-52t179-147q7-10 23-12 15 0 25 9l137 138q9 8 9.5 20.5t-7.5 22.5q-109
      132-264 204.5t-327 72.5q-156 0-298-61t-245-164-164-245-61-298 61-298
      164-245 245-164 298-61q147 0 284.5 55.5t244.5 156.5l130-129q29-31 70-14
      39 17 39 59z"
    />`,{viewBox:{x:1792,y:1792}}),M=new r.default(`<path fill="ACTIVE_COLOR" d="M24 21v2c0 0.547-0.453 1-1 1h-22c-0.547
      0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547 0 1 0.453 1 1zM24 13v2c0
      0.547-0.453 1-1 1h-22c-0.547 0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547
      0 1 0.453 1 1zM24 5v2c0 0.547-0.453 1-1 1h-22c-0.547
      0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547 0 1 0.453 1 1z"
      />`,{viewBox:{x:24,y:28}}),C=new r.default(`<path fill="ACTIVE_COLOR" d="M1664 416v960q0 119-84.5 203.5t-203.5 84.5h-960q-119
    0-203.5-84.5t-84.5-203.5v-960q0-119 84.5-203.5t203.5-84.5h960q119 0 203.5
    84.5t84.5 203.5z"
  />`,{viewBox:{x:1792,y:1792}}),O=new r.default(`<path fill="ACTIVE_COLOR" d="M14.5,3.5 a1 1 0 0 1 -11,11 Z" stroke="none" opacity="0.8" />
    <circle cx="9" cy="9" r="8" fill="none" stroke-width="2" stroke="ACTIVE_COLOR" />`,{viewBox:{x:18,y:18}}),I=new r.default(`<path fill="ACTIVE_COLOR" d="M508.5 481.6l-129-129c-2.3-2.3-5.3-3.5-8.5-3.5h-10.3C395
      312 416 262.5 416 208 416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c54.5
      0 104-21 141.1-55.2V371c0 3.2 1.3 6.2 3.5 8.5l129 129c4.7 4.7 12.3 4.7 17
      0l9.9-9.9c4.7-4.7 4.7-12.3 0-17zM208 384c-97.3 0-176-78.7-176-176S110.7 32 208
      32s176 78.7 176 176-78.7 176-176 176z"
    />
    <path fill="ACTIVE_COLOR" transform="scale(0.22,0.22) translate(1400,0)" d="M1216
      320q0 26-19 45t-45 19h-128v1024h128q26 0 45 19t19 45-19 45l-256 256q-19
      19-45 19t-45-19l-256-256q-19-19-19-45t19-45 45-19h128v-1024h-128q-26
      0-45-19t-19-45 19-45l256-256q19-19 45-19t45 19l256 256q19 19 19 45z"
    />`,{viewBox:{x:640,y:512}}),_={x:127,y:60},D=function(){var J=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"ACTIVE_COLOR";return'<rect fill="'.concat(J,'" x="80.19" y="25.03" width="47.14" height="15.85"/>')},L=function(){var J=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"ACTIVE_COLOR";return'<rect fill="'.concat(J,`" x="80.19" y="25.03" width="47.14" height="15.85"/>
      <rect fill="`).concat(J,'" x="95.84" y="9.38" width="15.85" height="47.14"/>')},S='<path fill="ACTIVE_COLOR" d="M82.89,10a12.09,12.09,0,0,0-16.8-2.5l-27.5,20.4-8.5-6.3a2.93,2.93,0,0,1-1.1-3,14.66,14.66,0,0,0,.1-6.6,14.08,14.08,0,1,0-6.5,15.2,2.87,2.87,0,0,1,3.2.2l8.2,6.1-8.2,6.1a2.87,2.87,0,0,1-3.2.2,14.16,14.16,0,1,0,6.7,14.4,14,14,0,0,0-.3-5.8,2.93,2.93,0,0,1,1.1-3l8.5-6.3,27.5,20.4A11.91,11.91,0,0,0,82.89,57l-31.7-23.5ZM15.29,21a5.9,5.9,0,1,1,5.9-5.9A5.91,5.91,0,0,1,15.29,21Zm0,36.8a5.9,5.9,0,1,1,5.9-5.9A5.91,5.91,0,0,1,15.29,57.77Zm28.3-21.5a2.8,2.8,0,1,1,2.8-2.8A2.8,2.8,0,0,1,43.59,36.27Z" transform="translate(-1.17 -0.96)"/>',A='<path fill="ACTIVE_COLOR" d="M8.86,2.25V66.08H72.69V2.25H8.86ZM65.28,58.67h-49v-49h49v49Z" transform="translate(-8.86 -2.25)"/>',U='<path fill="ACTIVE_COLOR" d="M40.77,2.25A31.92,31.92,0,1,0,72.69,34.16,31.92,31.92,0,0,0,40.77,2.25Zm0,57.63A25.71,25.71,0,1,1,66.48,34.16,25.71,25.71,0,0,1,40.77,59.87Z" transform="translate(-8.86 -2.25)"/>',B=new r.default("".concat(S," ").concat(D()),{viewBox:_}),b=new r.default("".concat(S," ").concat(L()),{viewBox:_}),y=new r.default("".concat(S," ").concat(D()),{viewBox:_}),x=new r.default("".concat(S," ").concat(L()),{viewBox:_}),j=new r.default("".concat(A," ").concat(D()),{viewBox:_}),p=new r.default("".concat(A," ").concat(L()),{viewBox:_}),R=new r.default("".concat(A," ").concat(D()),{viewBox:_}),W=new r.default("".concat(A," ").concat(L()),{viewBox:_}),K=new r.default("".concat(U," ").concat(D()),{viewBox:_}),N=new r.default("".concat(U," ").concat(L()),{viewBox:_}),z=new r.default("".concat(U," ").concat(D()),{viewBox:_}),Y=new r.default("".concat(U," ").concat(L()),{viewBox:_})},"./tools/index.js":function(H,n,e){e.r(n);var r=e("./tools/CrosshairsTool.js");e.d(n,"CrosshairsTool",function(){return r.default});var u=e("./tools/DoubleTapFitToWindowTool.js");e.d(n,"DoubleTapFitToWindowTool",function(){return u.default});var f=e("./tools/DragProbeTool.js");e.d(n,"DragProbeTool",function(){return f.default});var v=e("./tools/EraserTool.js");e.d(n,"EraserTool",function(){return v.default});var d=e("./tools/FreehandRoiSculptorTool.js");e.d(n,"FreehandRoiSculptorTool",function(){return d.default});var t=e("./tools/MagnifyTool.js");e.d(n,"MagnifyTool",function(){return t.default});var o=e("./tools/OverlayTool.js");e.d(n,"OverlayTool",function(){return o.default});var s=e("./tools/OrientationMarkersTool.js");e.d(n,"OrientationMarkersTool",function(){return s.default});var l=e("./tools/PanMultiTouchTool.js");e.d(n,"PanMultiTouchTool",function(){return l.default});var a=e("./tools/PanTool.js");e.d(n,"PanTool",function(){return a.default});var i=e("./tools/ReferenceLinesTool.js");e.d(n,"ReferenceLinesTool",function(){return i.default});var h=e("./tools/RotateTool.js");e.d(n,"RotateTool",function(){return h.default});var g=e("./tools/RotateTouchTool.js");e.d(n,"RotateTouchTool",function(){return g.default});var c=e("./tools/ScaleOverlayTool.js");e.d(n,"ScaleOverlayTool",function(){return c.default});var m=e("./tools/StackScrollMouseWheelTool.js");e.d(n,"StackScrollMouseWheelTool",function(){return m.default});var E=e("./tools/StackScrollMultiTouchTool.js");e.d(n,"StackScrollMultiTouchTool",function(){return E.default});var T=e("./tools/StackScrollTool.js");e.d(n,"StackScrollTool",function(){return T.default});var P=e("./tools/WwwcRegionTool.js");e.d(n,"WwwcRegionTool",function(){return P.default});var M=e("./tools/WwwcTool.js");e.d(n,"WwwcTool",function(){return M.default});var C=e("./tools/ZoomMouseWheelTool.js");e.d(n,"ZoomMouseWheelTool",function(){return C.default});var O=e("./tools/ZoomTool.js");e.d(n,"ZoomTool",function(){return O.default});var I=e("./tools/ZoomTouchPinchTool.js");e.d(n,"ZoomTouchPinchTool",function(){return I.default}),n.default={CrosshairsTool:r.default,DoubleTapFitToWindowTool:u.default,DragProbeTool:f.default,EraserTool:v.default,FreehandRoiSculptorTool:d.default,MagnifyTool:t.default,OverlayTool:o.default,OrientationMarkersTool:s.default,PanMultiTouchTool:l.default,PanTool:a.default,ReferenceLinesTool:i.default,RotateTool:h.default,RotateTouchTool:g.default,ScaleOverlayTool:c.default,StackScrollMouseWheelTool:m.default,StackScrollMultiTouchTool:E.default,StackScrollTool:T.default,WwwcRegionTool:P.default,WwwcTool:M.default,ZoomMouseWheelTool:C.default,ZoomTool:O.default,ZoomTouchPinchTool:I.default}},"./tools/referenceLines/calculateReferenceLine.js":function(H,n,e){e.r(n);var r=e("./util/pointProjector.js");n.default=function(u,f){var v=Object(r.planePlaneIntersection)(u,f);if(v)return{start:Object(r.projectPatientPointToImagePlane)(v.start,u),end:Object(r.projectPatientPointToImagePlane)(v.end,u)}}},"./tools/referenceLines/renderActiveReferenceLine.js":function(H,n,e){e.r(n);var r=e("./externalModules.js"),u=e("./tools/referenceLines/calculateReferenceLine.js"),f=e("./stateManagement/toolColors.js"),v=e("./util/convertToVector3.js"),d=e("./drawing/index.js");n.default=function(t,o,s,l){var a=r.default.cornerstone,i=a.getEnabledElement(s).image,h=a.getEnabledElement(l).image;if(!(!i||!h)){var g=a.metaData.get("imagePlaneModule",i.imageId),c=a.metaData.get("imagePlaneModule",h.imageId);if(!(!g||!c||!g.rowCosines||!g.columnCosines||!g.imagePositionPatient||!c.rowCosines||!c.columnCosines||!c.imagePositionPatient)&&g.frameOfReferenceUID===c.frameOfReferenceUID){g.rowCosines=Object(v.default)(g.rowCosines),g.columnCosines=Object(v.default)(g.columnCosines),g.imagePositionPatient=Object(v.default)(g.imagePositionPatient),c.rowCosines=Object(v.default)(c.rowCosines),c.columnCosines=Object(v.default)(c.columnCosines),c.imagePositionPatient=Object(v.default)(c.imagePositionPatient);var m=g.rowCosines.clone().cross(g.columnCosines),E=c.rowCosines.clone().cross(c.columnCosines),T=m.angleTo(E);if(T=Math.abs(T),!(T<.5)){var P=Object(u.default)(g,c);if(P){var M=f.default.getActiveColor();t.setTransform(1,0,0,1,0,0),Object(d.draw)(t,function(C){Object(d.drawLine)(C,o.element,P.start,P.end,{color:M})})}}}}}},"./tools/segmentation/BrushTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return M});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=e.n(o),l=e("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),a=e.n(l),i=e("../node_modules/@babel/runtime/helpers/inherits.js"),h=e.n(i),g=e("./externalModules.js"),c=e("./tools/base/index.js"),m=e("./store/index.js"),E=e("./util/segmentation/index.js"),T=e("./util/logger.js");Object(T.getLogger)("tools:BrushTool");var P=Object(m.getModule)("segmentation"),M=function(C){h()(O,C);function O(){var I,_=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u()(this,O);var D={name:"Brush",supportedInteractionTypes:["Mouse","Touch"],configuration:{},mixins:["renderBrushMixin"]};return I=t()(this,s()(O).call(this,_,D)),I.touchDragCallback=I._paint.bind(a()(I)),I}return v()(O,[{key:"_paint",value:function(_){var D=P.configuration,L=_.detail;L.element;var S=L.image,A=S.rows,U=S.columns,B=L.currentPoints.image,b=B.x,y=B.y;if(!(b<0||b>U||y<0||y>A)){var x=D.radius,j=Object(E.getCircle)(x,A,U,b,y),p=this.paintEventData,R=p.labelmap2D,W=p.labelmap3D,K=p.shouldErase;Object(E.drawBrushPixels)(j,R.pixelData,W.activeSegmentIndex,U,K),g.default.cornerstone.updateImage(_.detail.element)}}}]),O}(c.BaseBrushTool)},"./tools/segmentation/CircleScissorsTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return h});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/inherits.js"),s=e.n(o),l=e("./tools/base/index.js"),a=e("./tools/segmentation/strategies/index.js"),i=e("./tools/cursors/index.js"),h=function(g){s()(c,g);function c(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u()(this,c);var E={name:"CircleScissors",strategies:{FILL_INSIDE:a.fillInsideCircle,FILL_OUTSIDE:a.fillOutsideCircle,ERASE_OUTSIDE:a.eraseOutsideCircle,ERASE_INSIDE:a.eraseInsideCircle},cursors:{FILL_INSIDE:i.segCircleFillInsideCursor,FILL_OUTSIDE:i.segCircleFillOutsideCursor,ERASE_OUTSIDE:i.segCircleEraseOutsideCursor,ERASE_INSIDE:i.segCircleEraseInsideCursor},defaultStrategy:"FILL_INSIDE",supportedInteractionTypes:["Mouse","Touch"],svgCursor:i.segCircleFillInsideCursor,mixins:["circleSegmentationMixin"]};return v()(this,t()(c).call(this,m,E))}return c}(l.BaseTool)},"./tools/segmentation/CorrectionScissorsTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return h});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/inherits.js"),s=e.n(o),l=e("./tools/base/index.js"),a=e("./tools/cursors/index.js"),i=e("./tools/segmentation/strategies/index.js"),h=function(g){s()(c,g);function c(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u()(this,c);var E={name:"CorrectionScissors",strategies:{CORRECTION:i.correction},cursors:{CORRECTION:a.freehandFillInsideCursor},defaultStrategy:"CORRECTION",supportedInteractionTypes:["Mouse","Touch"],svgCursor:a.freehandFillInsideCursor,mixins:["polylineSegmentationMixin"]};return v()(this,t()(c).call(this,m,E))}return c}(l.BaseTool)},"./tools/segmentation/FreehandScissorsTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return h});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/inherits.js"),s=e.n(o),l=e("./tools/cursors/index.js"),a=e("./tools/segmentation/strategies/index.js"),i=e("./tools/base/index.js"),h=function(g){s()(c,g);function c(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u()(this,c);var E={name:"FreehandScissors",strategies:{FILL_INSIDE:a.fillInsideFreehand,FILL_OUTSIDE:a.fillOutsideFreehand,ERASE_OUTSIDE:a.eraseOutsideFreehand,ERASE_INSIDE:a.eraseInsideFreehand},cursors:{FILL_INSIDE:l.freehandFillInsideCursor,FILL_OUTSIDE:l.freehandFillOutsideCursor,ERASE_OUTSIDE:l.freehandEraseOutsideCursor,ERASE_INSIDE:l.freehandEraseInsideCursor},defaultStrategy:"FILL_INSIDE",supportedInteractionTypes:["Mouse","Touch"],svgCursor:l.freehandFillInsideCursor,mixins:["freehandSegmentationMixin"]};return v()(this,t()(c).call(this,m,E))}return c}(i.BaseTool)},"./tools/segmentation/RectangleScissorsTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return h});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/inherits.js"),s=e.n(o),l=e("./tools/base/index.js"),a=e("./tools/segmentation/strategies/index.js"),i=e("./tools/cursors/index.js"),h=function(g){s()(c,g);function c(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u()(this,c);var E={name:"RectangleScissors",strategies:{FILL_INSIDE:a.fillInsideRectangle,FILL_OUTSIDE:a.fillOutsideRectangle,ERASE_OUTSIDE:a.eraseOutsideRectangle,ERASE_INSIDE:a.eraseInsideRectangle},cursors:{FILL_INSIDE:i.segRectangleFillInsideCursor,FILL_OUTSIDE:i.segRectangleFillOutsideCursor,ERASE_OUTSIDE:i.segRectangleEraseOutsideCursor,ERASE_INSIDE:i.segRectangleEraseInsideCursor},defaultStrategy:"FILL_INSIDE",supportedInteractionTypes:["Mouse","Touch"],mixins:["rectangleSegmentationMixin"]};return v()(this,t()(c).call(this,m,E))}return c}(l.BaseTool)},"./tools/segmentation/SphericalBrushTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return O});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),t=e.n(d),o=e("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),s=e.n(o),l=e("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),a=e.n(l),i=e("../node_modules/@babel/runtime/helpers/inherits.js"),h=e.n(i),g=e("./externalModules.js"),c=e("./tools/base/BaseBrushTool.js"),m=e("./store/index.js"),E=e("./util/segmentation/index.js"),T=e("./stateManagement/toolState.js"),P=e("./util/logger.js"),M=Object(P.getLogger)("tools:SphericalBrushTool"),C=Object(m.getModule)("segmentation"),O=function(I){h()(_,I);function _(){var D,L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};u()(this,_);var S={name:"SphericalBrush",supportedInteractionTypes:["Mouse","Touch"],configuration:{alwaysEraseOnClick:!1},mixins:["renderBrushMixin"]};return D=t()(this,s()(_).call(this,L,S)),D.touchDragCallback=D._paint.bind(a()(D)),D}return v()(_,[{key:"_startPainting",value:function(L){var S=C.configuration,A=C.getters,U=L.detail,B=U.element,b=U.image,y=g.default.cornerstone,x=S.radius,j=b.rows,p=b.columns,R=Math.max(b.rowPixelSpacing,b.columnPixelSpacing),W=Object(T.getToolState)(B,"stack"),K=W.data[0],N=K.imageIds,z=A.labelmap2D(B),Y=z.labelmap2D,$=z.labelmap3D,J=z.currentImageIdIndex,te=z.activeLabelmapIndex,ne=this._isCtrlDown(U)||this.configuration.alwaysEraseOnClick,de=y.metaData.get("imagePlaneModule",b.imageId),w;if(de){var G=de.imagePositionPatient;w=this._getImagesInRange(J,G,N,x,R)}else M.warn("No imagePlane metadata found for image, defaulting to circle brush application."),w=[{imageIdIndex:J,radiusOnImage:x}];if(this.paintEventData={labelmap2D:Y,labelmap3D:$,currentImageIdIndex:J,activeLabelmapIndex:te,shouldErase:ne,imagesInRange:w},S.storeHistory){for(var Z=[],Q=0;Q<w.length;Q++){var k=w[Q].imageIdIndex,ae=A.labelmap2DByImageIdIndex($,k,j,p),ee=ae.pixelData.slice();Z.push(ee)}this.paintEventData.previousPixeldataForImagesInRange=Z}}},{key:"_paint",value:function(L){var S=C.getters,A=L.detail;A.element;var U=A.image,B=U.rows,b=U.columns,y=A.currentPoints.image,x=y.x,j=y.y;if(!(x<0||x>b||j<0||j>B)){for(var p=this.paintEventData,R=p.labelmap3D,W=p.imagesInRange,K=p.shouldErase,N=0;N<W.length;N++){var z=W[N],Y=z.imageIdIndex,$=z.radiusOnImage,J=Object(E.getCircle)($,B,b,x,j),te=S.labelmap2DByImageIdIndex(R,Y,B,b);Object(E.drawBrushPixels)(J,te.pixelData,R.activeSegmentIndex,b,K)}g.default.cornerstone.updateImage(L.detail.element)}}},{key:"_getImagesInRange",value:function(L,S,A,U,B){for(var b=U*B,y=[{imageIdIndex:L,radiusOnImage:U}],x=L+1;x<A.length;x++){var j=this._getRadiusOnImage(A[x],S,b,B);if(!j)break;y.push({imageIdIndex:x,radiusOnImage:j})}for(var p=L-1;p>=0;p--){var R=this._getRadiusOnImage(A[p],S,b,B);if(!R)break;y.push({imageIdIndex:p,radiusOnImage:R})}return y}},{key:"_getRadiusOnImage",value:function(L,S,A,U){var B=g.default.cornerstone.metaData.get("imagePlaneModule",L);if(!B){M.warn("Can't find imagePlane metadata for image, cancelling spherical brushing on: ".concat(L,","));return}var b=B.imagePositionPatient,y=Math.sqrt(Math.pow(b[0]-S[0],2)+Math.pow(b[1]-S[1],2)+Math.pow(b[2]-S[2],2));if(!(y>A))return Math.floor(Math.sqrt(Math.pow(A,2)-Math.pow(y,2))/U)}},{key:"_endPainting",value:function(L){for(var S=this.paintEventData,A=S.labelmap3D,U=S.imagesInRange,B=[],b=C.configuration,y=C.setters,x=0;x<U.length;x++){for(var j=U[x].imageIdIndex,p=A.labelmaps2D[j],R=new Set(p.pixelData),W=R.values(),K=[],N=!1;!N;){var z=W.next();N=z.done,N||K.push(z.value)}if(p.segmentsOnLabelmap=K,b.storeHistory){var Y=this.paintEventData.previousPixeldataForImagesInRange,$=Y[x],J=A.labelmaps2D[j],te=J.pixelData;B.push({imageIdIndex:j,diff:Object(E.getDiffBetweenPixelData)($,te)})}}b.storeHistory&&y.pushState(this.element,B),Object(E.triggerLabelmapModifiedEvent)(this.element)}}]),_}(c.default)},"./tools/segmentation/index.js":function(H,n,e){e.r(n);var r=e("./tools/segmentation/BrushTool.js"),u=e("./tools/segmentation/SphericalBrushTool.js"),f=e("./tools/segmentation/FreehandScissorsTool.js"),v=e("./tools/segmentation/RectangleScissorsTool.js"),d=e("./tools/segmentation/CircleScissorsTool.js"),t=e("./tools/segmentation/CorrectionScissorsTool.js");e.d(n,"BrushTool",function(){return r.default}),e.d(n,"SphericalBrushTool",function(){return u.default}),e.d(n,"FreehandScissorsTool",function(){return f.default}),e.d(n,"RectangleScissorsTool",function(){return v.default}),e.d(n,"CircleScissorsTool",function(){return d.default}),e.d(n,"CorrectionScissorsTool",function(){return t.default}),n.default={BrushTool:r.default,SphericalBrushTool:u.default,CircleScissorsTool:d.default,CorrectionScissorsTool:t.default,FreehandScissorsTool:f.default,RectangleScissorsTool:v.default}},"./tools/segmentation/strategies/correction.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return l});var r=e("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),u=e.n(r),f=e("./tools/segmentation/strategies/index.js"),v=e("./util/segmentation/index.js"),d=e("./util/clip.js"),t=e("./util/isPointInImage.js"),o=e("./util/logger.js"),s=Object(o.getLogger)("util:segmentation:operations:correction");function l(M,C){var O=C.pixelData,I=C.segmentIndex,_=C.segmentationMixinType;if(_!=="freehandSegmentationMixin"){s.error("correction operation requires freehandSegmentationMixin operationData, recieved ".concat(_));return}var D=a(M,C),L=i(D,I);if(L.isScissorOperation){L.operation==="fillInsideFreehand"?(s.warn("The line never intersects a segment."),Object(f.fillInsideFreehand)(M,C)):L.operation==="eraseInsideFreehand"&&(s.warn("The line is only ever inside the segment."),Object(f.eraseInsideFreehand)(M,C));return}var S=new Uint8Array(O.length),A=P(D,I);A.forEach(function(U){h(U,O,S,I,M)})}function a(M,C){for(var O=C.pixelData,I=C.points,_=M.detail.image,D=_.width,L=_.height,S=[],A=0;A<I.length;A++){var U=I[A],B=Math.floor(U.x),b=Math.floor(U.y);B=Object(d.default)(B,0,D-1),b=Object(d.default)(b,0,L-1);var y=S[S.length-1];y&&B===y.x&&b===y.y||S.push({x:B,y:b,segment:O[b*D+B]})}return S}function i(M,C){for(var O=!0,I=!0,_=0;_<M.length;_++){var D=M[_];if(D.segment===C?I=!1:O=!1,!O&&!I)break}return I?{isScissorOperation:!0,operation:"fillInsideFreehand"}:O?{isScissorOperation:!0,operation:"eraseInsideFreehand"}:{isScissorOperation:!1}}function h(M,C,O,I,_){var D=_.detail.image,L=D.width,S=D.height,A=M.nodes,U=M.additive,B=U?0:1,b=function(ve){return ve.y*L+ve.x},y=function(ve){return{x:ve%L,y:Math.floor(ve/L)}};U?s.warn("additive operation..."):s.warn("subtractive operation...");for(var x=E(A),j=x.pixelPath,p=x.leftPath,R=x.rightPath,W=j[0],K={xMin:W.x,xMax:W.x,yMin:W.y,yMax:W.y},N=0;N<O.length;N++)if(C[N]===I){var z=y(N);g(K,z),O[N]=1}else O[N]=0;for(var Y=0;Y<j.length;Y++){var $=j[Y];O[b($)]=2,g(K,$)}c(K,S,L);var J=K.xMin,te=K.xMax,ne=K.yMin,de=K.yMax;function w(ie,ve){if(!(ie>=te||ie<J||ve>=de||ve<ne))return O[ve*L+ie]}for(var G=0,Z=0,Q=0;Q<p.length;Q++){var k=p[Q],ae=O[b(k)];ae===B&&Object(t.default)(k,S,L)&&(G+=m(k,3,O,w,L));var ee=R[Q],oe=O[b(ee)];oe===B&&Object(t.default)(ee,S,L)&&(Z+=m(ee,4,O,w,L))}if(!(G===0||Z===0)){for(var se=U?I:0,re=G<Z?3:4,ce=0;ce<O.length;ce++)O[ce]===re&&(C[ce]=se);if(se===I)for(var le=0;le<j.length;le++)C[b(j[le])]=I;else for(var fe=0;fe<j.length;fe++){var ge=b(j[fe]);C[ge]===I&&(C[ge]=0)}}}function g(M,C){var O=C.x,I=C.y;O<M.xMin&&(M.xMin=O),O>M.xMax&&(M.xMax=O),I<M.yMin&&(M.yMin=I),I>M.yMax&&(M.yMax=I)}function c(M,C,O){var I=2;M.xMax=Math.min(M.xMax+I,O),M.xMin=Math.max(M.xMin-I,0),M.yMax=Math.min(M.yMax+I,C),M.yMin=Math.max(M.yMin-I,0)}function m(M,C,O,I,_){for(var D=Object(v.floodFill)(I,[M.x,M.y]),L=D.flooded,S=0;S<L.length;S++){var A=L[S];O[A[1]*_+A[0]]=C}return L.length}function E(M){for(var C=[],O=0;O<M.length-1;O++)C.push(M[O]),C.push.apply(C,u()(Object(v.getPixelPathBetweenPixels)(M[O],M[O+1])));C.push[M[M.length-1]];for(var I=[],_=[],D=0;D<C.length-1;D++){var L=T(C[D],C[D+1]),S=L.left,A=L.right;I.push(S),_.push(A)}return{pixelPath:C,leftPath:I,rightPath:_}}function T(M,C){var O={x:C.x-M.x,y:C.y-M.y};if(O.x===-1&&O.y===1)return{left:{x:M.x-1,y:M.y-1},right:{x:M.x+1,y:M.y+1}};if(O.x===0&&O.y===1)return{left:{x:M.x-1,y:M.y},right:{x:M.x+1,y:M.y}};if(O.x===1&&O.y===1)return{left:{x:M.x-1,y:M.y+1},right:{x:M.x+1,y:M.y-1}};if(O.x===1&&O.y===0)return{left:{x:M.x,y:M.y+1},right:{x:M.x,y:M.y-1}};if(O.x===1&&O.y===-1)return{left:{x:M.x+1,y:M.y+1},right:{x:M.x-1,y:M.y-1}};if(O.x===0&&O.y===-1)return{left:{x:M.x+1,y:M.y},right:{x:M.x-1,y:M.y}};if(O.x===-1&&O.y===-1)return{left:{x:M.x+1,y:M.y-1},right:{x:M.x-1,y:M.y+1}};if(O.x===-1&&O.y===0)return{left:{x:M.x,y:M.y-1},right:{x:M.x,y:M.y+1}};s.error("Unable to find left and right paths for flood fill ",M,C,O)}function P(M,C){var O=M[0].segment===C,I=[];I.push({additive:!O,nodes:[]});for(var _=0,D=0;D<M.length;D++){var L=M[D];O?(I[_].nodes.push(L),L.segment!==C&&(_++,O=!O,I.push({additive:!0,nodes:[]}),I[_].nodes.push(M[D-1]),I[_].nodes.push(L))):(I[_].nodes.push(L),L.segment===C&&(_++,O=!O,I.push({additive:!1,nodes:[]}),I[_].nodes.push(M[D-1]),I[_].nodes.push(L)))}return I.pop(),I.shift(),I}},"./tools/segmentation/strategies/eraseCircle.js":function(H,n,e){e.r(n),e.d(n,"eraseInsideCircle",function(){return l}),e.d(n,"eraseOutsideCircle",function(){return a});var r=e("../node_modules/@babel/runtime/helpers/slicedToArray.js"),u=e.n(r),f=e("./util/ellipse/index.js"),v=e("./util/logger.js"),d=e("./util/segmentation/index.js"),t=e("./util/getCircleCoords.js"),o=Object(v.getLogger)("util:segmentation:operations:eraseInsideCircle");function s(i,h){var g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,c=h.segmentationMixinType;if(c!=="circleSegmentationMixin"){o.error("eraseInsideCircle operation requires circleSegmentationMixin operationData, recieved ".concat(c));return}var m=i.detail,E=Object(d.getBoundingBoxAroundCircle)(i),T=u()(E,2),P=T[0],M=T[1],C=Object(t.default)(m.handles.start,m.handles.end);g?Object(d.eraseInsideShape)(i,h,function(O){return Object(f.pointInEllipse)(C,O)},P,M):Object(d.eraseOutsideShape)(i,h,function(O){return Object(f.pointInEllipse)(C,O)},P,M)}function l(i,h){s(i,h,!0)}function a(i,h){s(i,h,!1)}},"./tools/segmentation/strategies/eraseFreehand.js":function(H,n,e){e.r(n),e.d(n,"eraseInsideFreehand",function(){return s}),e.d(n,"eraseOutsideFreehand",function(){return l});var r=e("../node_modules/@babel/runtime/helpers/slicedToArray.js"),u=e.n(r),f=e("./util/segmentation/index.js"),v=e("./util/isPointInPolygon.js"),d=e("./util/logger.js"),t=Object(d.getLogger)("util:segmentation:operations:eraseInsideFreehand");function o(a,i){var h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,g=i.points,c=i.segmentationMixinType;if(c!=="freehandSegmentationMixin"){t.error("eraseInsideFreehand operation requires freehandSegmentationMixin operationData, recieved ".concat(c));return}var m=a.detail.image,E=g.map(function(O){return[O.x,O.y]}),T=Object(f.getBoundingBoxAroundPolygon)(E,m),P=u()(T,2),M=P[0],C=P[1];h?Object(f.eraseInsideShape)(a,i,function(O){return Object(v.default)([O.x,O.y],E)},M,C):Object(f.eraseOutsideShape)(a,i,function(O){return Object(v.default)([O.x,O.y],E)},M,C)}function s(a,i){o(a,i,!0)}function l(a,i){o(a,i,!1)}},"./tools/segmentation/strategies/eraseRectangle.js":function(H,n,e){e.r(n),e.d(n,"eraseInsideRectangle",function(){return o}),e.d(n,"eraseOutsideRectangle",function(){return s});var r=e("../node_modules/@babel/runtime/helpers/slicedToArray.js"),u=e.n(r),f=e("./util/logger.js"),v=e("./util/segmentation/index.js"),d=Object(f.getLogger)("util:segmentation:operations:eraseInsideRectangle");function t(l,a){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,h=a.points,g=a.segmentationMixinType;if(g!=="rectangleSegmentationMixin"){d.error("eraseInsideRectangle operation requires rectangleSegmentationMixin operationData, recieved ".concat(g));return}var c=l.detail,m=c.image,E=h.map(function(O){return[O.x,O.y]}),T=Object(v.getBoundingBoxAroundPolygon)(E,m),P=u()(T,2),M=P[0],C=P[1];i?Object(v.eraseInsideShape)(l,a,function(){return!0},M,C):Object(v.eraseOutsideBoundingBox)(l,a,M,C)}function o(l,a){t(l,a,!0)}function s(l,a){t(l,a,!1)}},"./tools/segmentation/strategies/fillCircle.js":function(H,n,e){e.r(n),e.d(n,"fillInsideCircle",function(){return l}),e.d(n,"fillOutsideCircle",function(){return a});var r=e("../node_modules/@babel/runtime/helpers/slicedToArray.js"),u=e.n(r),f=e("./util/segmentation/index.js"),v=e("./util/ellipse/index.js"),d=e("./util/getCircleCoords.js"),t=e("./util/logger.js"),o=Object(t.getLogger)("util:segmentation:operations:fillCircle");function s(i,h){var g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,c=h.segmentationMixinType;if(c!=="circleSegmentationMixin"){o.error("fillInsideCircle operation requires circleSegmentationMixin operationData, recieved ".concat(c));return}var m=i.detail,E=Object(f.getBoundingBoxAroundCircle)(i),T=u()(E,2),P=T[0],M=T[1],C=Object(d.default)(m.handles.start,m.handles.end);g?Object(f.fillInsideShape)(i,h,function(O){return Object(v.pointInEllipse)(C,O)},P,M):Object(f.fillOutsideShape)(i,h,function(O){return Object(v.pointInEllipse)(C,O)},P,M)}function l(i,h){s(i,h,!0)}function a(i,h){s(i,h,!1)}},"./tools/segmentation/strategies/fillFreehand.js":function(H,n,e){e.r(n),e.d(n,"fillInsideFreehand",function(){return s}),e.d(n,"fillOutsideFreehand",function(){return l});var r=e("../node_modules/@babel/runtime/helpers/slicedToArray.js"),u=e.n(r),f=e("./util/segmentation/index.js"),v=e("./util/isPointInPolygon.js"),d=e("./util/logger.js"),t=Object(d.getLogger)("util:segmentation:operations:fillInsideFreehand");function o(a,i){var h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,g=i.points,c=i.segmentationMixinType;if(c!=="freehandSegmentationMixin"){t.error("eraseInsideFreehand operation requires freehandSegmentationMixin operationData, recieved ".concat(c));return}var m=a.detail.image,E=g.map(function(O){return[O.x,O.y]}),T=Object(f.getBoundingBoxAroundPolygon)(E,m),P=u()(T,2),M=P[0],C=P[1];h?Object(f.fillInsideShape)(a,i,function(O){return Object(v.default)([O.x,O.y],E)},M,C):Object(f.fillOutsideShape)(a,i,function(O){return Object(v.default)([O.x,O.y],E)},M,C)}function s(a,i){o(a,i,!0)}function l(a,i){o(a,i,!1)}},"./tools/segmentation/strategies/fillRectangle.js":function(H,n,e){e.r(n),e.d(n,"fillInsideRectangle",function(){return o}),e.d(n,"fillOutsideRectangle",function(){return s});var r=e("../node_modules/@babel/runtime/helpers/slicedToArray.js"),u=e.n(r),f=e("./util/segmentation/index.js"),v=e("./util/logger.js"),d=Object(v.getLogger)("util:segmentation:operations:fillInsideRectangle");function t(l,a){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,h=a.points,g=a.segmentationMixinType;if(g!=="rectangleSegmentationMixin"){d.error("eraseInsideRectangle operation requires rectangleSegmentationMixin operationData, recieved ".concat(g));return}var c=l.detail.image,m=h.map(function(C){return[C.x,C.y]}),E=Object(f.getBoundingBoxAroundPolygon)(m,c),T=u()(E,2),P=T[0],M=T[1];i?Object(f.fillInsideShape)(l,a,function(){return!0},P,M):Object(f.fillOutsideBoundingBox)(l,a,P,M)}function o(l,a){t(l,a,!0)}function s(l,a){t(l,a,!1)}},"./tools/segmentation/strategies/index.js":function(H,n,e){e.r(n);var r=e("./tools/segmentation/strategies/correction.js");e.d(n,"correction",function(){return r.default});var u=e("./tools/segmentation/strategies/eraseFreehand.js");e.d(n,"eraseInsideFreehand",function(){return u.eraseInsideFreehand}),e.d(n,"eraseOutsideFreehand",function(){return u.eraseOutsideFreehand});var f=e("./tools/segmentation/strategies/eraseRectangle.js");e.d(n,"eraseInsideRectangle",function(){return f.eraseInsideRectangle}),e.d(n,"eraseOutsideRectangle",function(){return f.eraseOutsideRectangle});var v=e("./tools/segmentation/strategies/fillFreehand.js");e.d(n,"fillInsideFreehand",function(){return v.fillInsideFreehand}),e.d(n,"fillOutsideFreehand",function(){return v.fillOutsideFreehand});var d=e("./tools/segmentation/strategies/fillRectangle.js");e.d(n,"fillInsideRectangle",function(){return d.fillInsideRectangle}),e.d(n,"fillOutsideRectangle",function(){return d.fillOutsideRectangle});var t=e("./tools/segmentation/strategies/fillCircle.js");e.d(n,"fillInsideCircle",function(){return t.fillInsideCircle}),e.d(n,"fillOutsideCircle",function(){return t.fillOutsideCircle});var o=e("./tools/segmentation/strategies/eraseCircle.js");e.d(n,"eraseInsideCircle",function(){return o.eraseInsideCircle}),e.d(n,"eraseOutsideCircle",function(){return o.eraseOutsideCircle})},"./util/SaveAs.js":function(H,n,e){e.r(n),n.default=function(r,u){var f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"image/png",v=r.querySelector("canvas");if(v.msToBlob){var d=v.msToBlob();return window.navigator.msSaveBlob(d,u)}var t=document.createElement("a");if(t.download=u,t.href=v.toDataURL(f,1),document.createEvent){var o=document.createEvent("MouseEvents");o.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),t.dispatchEvent(o)}else t.fireEvent&&t.fireEvent("onclick")}},"./util/angleBetweenPoints.js":function(H,n,e){e.r(n),n.default=function(r,u,f){var v=Math.sqrt(Math.pow(r.x-u.x,2)+Math.pow(r.y-u.y,2)),d=Math.sqrt(Math.pow(r.x-f.x,2)+Math.pow(r.y-f.y,2)),t=Math.sqrt(Math.pow(u.x-f.x,2)+Math.pow(u.y-f.y,2)),o=Math.acos((Math.pow(v,2)+Math.pow(d,2)-Math.pow(t,2))/(2*v*d))*180/Math.PI,s=(u.x-r.x)*(f.y-r.y)-(u.y-r.y)*(f.x-r.x);return{angle:o,direction:s}}},"./util/calculateSUV.js":function(H,n,e){e.r(n);var r=e("./externalModules.js");n.default=function(f,v){var d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,t=r.default.cornerstone,o=t.metaData.get("patientStudyModule",f.imageId),s=t.metaData.get("generalSeriesModule",f.imageId);if(!(!o||!s)){var l=s.modality;if(l==="PT"){var a=d?v:v*f.slope+f.intercept,i=o.patientWeight;if(i){var h=t.metaData.get("petIsotopeModule",f.imageId);if(h){var g=h.radiopharmaceuticalInfo,c=g.radiopharmaceuticalStartTime,m=g.radionuclideTotalDose,E=g.radionuclideHalfLife,T=s.seriesTime;if(!(!c||!m||!E||!T)){var P=u(T.fractionalSeconds||0)+T.seconds+T.minutes*60+T.hours*60*60,M=u(c.fractionalSeconds||0)+c.seconds+c.minutes*60+c.hours*60*60,C=P-M,O=m*Math.exp(-C*Math.log(2)/E),I=a*i/O*1e3;return I}}}}}};function u(f){return parseFloat(".".concat(f))}},"./util/clip.js":function(H,n,e){e.r(n),e.d(n,"clip",function(){return v}),e.d(n,"clipToBox",function(){return d}),e.d(n,"clipBoxToDisplayedArea",function(){return s});var r=e("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),u=e.n(r),f=e("./externalModules.js");function v(l,a,i){return Math.min(Math.max(a,l),i)}function d(l,a){var i=a.left||0,h=a.top||0;l.x=v(l.x,i,i+a.width),l.y=v(l.y,h,h+a.height)}var t=function(a,i){var h=function(L){return f.default.cornerstone.canvasToPixel(a,L)},g=i.top,c=i.left,m=i.width,E=i.height,T=h({x:c,y:g}),P=h({x:c+m,y:g}),M=h({x:c,y:g+E}),C=h({x:c+m,y:g+E}),O=[T,P,M,C],I=O.map(function(D){return D.x}),_=O.map(function(D){return D.y});return{minX:Math.min.apply(Math,u()(I)),minY:Math.min.apply(Math,u()(_)),maxX:Math.max.apply(Math,u()(I)),maxY:Math.max.apply(Math,u()(_))}},o=function(a,i,h,g,c,m){m-c<g-h?(a[i]+=c-h,a[i]+=(m-c)/2,a[i]-=(g-h)/2):h<c?a[i]+=c-h:g>m&&(a[i]-=g-m)};function s(l,a){var i=f.default.cornerstone,h=i.pixelToCanvas,g=i.canvasToPixel,c=i.getViewport,m=i.getEnabledElement,E=i.getDisplayedArea,T=g(l,{x:a.left,y:a.top}),P=t(l,a),M=P.minX,C=P.minY,O=P.maxX,I=P.maxY,_=c(l),D=m(l),L=E(D.image,_),S=_.displayedArea?_.displayedArea:L,A=S.tlhc,U=S.brhc,B=A.y-1,b=A.x-1,y=U.y,x=U.x;o(T,"y",C,I,B,y),o(T,"x",M,O,b,x);var j=h(l,T);a.top=j.y,a.left=j.x}n.default=v},"./util/convertToVector3.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return u});var r=e("./externalModules.js");function u(f){var v=r.default.cornerstoneMath;if(f instanceof v.Vector3)return f;var d=Object.keys(f);return d.includes("x")&&d.includes("y")&&d.includes("z")?new v.Vector3(f.x,f.y,f.z):new v.Vector3(f[0],f[1],f[2])}},"./util/copyPoints.js":function(H,n,e){e.r(n),n.default=function(u){var f=r(u.page),v=r(u.image),d=r(u.client),t=r(u.canvas);return{page:f,image:v,client:d,canvas:t}};function r(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},f=u.x,v=u.y;return{x:f,y:v}}},"./util/debounce.js":function(H,n,e){e.r(n);var r=e("./util/isObject.js");function u(f,v,d){var t,o,s,l,a,i,h=0,g=!1,c=!1,m=!0,E=!v&&v!==0&&typeof window.requestAnimationFrame=="function";if(typeof f!="function")throw new TypeError("Expected a function");v=Number(v)||0,Object(r.default)(d)&&(g=!!d.leading,c="maxWait"in d,s=c?Math.max(Number(d.maxWait)||0,v):s,m="trailing"in d?!!d.trailing:m);function T(B){var b=t,y=o;return t=o=void 0,h=B,l=f.apply(y,b),l}function P(B,b){return E?window.requestAnimationFrame(B):setTimeout(B,b)}function M(B){if(E)return window.cancelAnimationFrame(B);clearTimeout(B)}function C(B){return h=B,a=P(_,v),g?T(B):l}function O(B){var b=B-i,y=B-h,x=v-b;return c?Math.min(x,s-y):x}function I(B){var b=B-i,y=B-h;return i===void 0||b>=v||b<0||c&&y>=s}function _(){var B=Date.now();if(I(B))return D(B);a=P(_,O(B))}function D(B){return a=void 0,m&&t?T(B):(t=o=void 0,l)}function L(){a!==void 0&&M(a),h=0,t=i=o=a=void 0}function S(){return a===void 0?l:D(Date.now())}function A(){return a!==void 0}function U(){for(var B=Date.now(),b=I(B),y=arguments.length,x=new Array(y),j=0;j<y;j++)x[j]=arguments[j];if(t=x,o=this,i=B,b){if(a===void 0)return C(i);if(c)return a=P(_,v),T(i)}return a===void 0&&(a=P(_,v)),l}return U.cancel=L,U.flush=S,U.pending=A,U}n.default=u},"./util/debugLib/common.js":function(H,n,e){e.r(n);var r=e("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),u=e.n(r);function f(v){t.debug=t,t.default=t,t.coerce=g,t.disable=a,t.enable=l,t.enabled=i,t.humanize=e("../node_modules/ms/index.js"),Object.keys(v).forEach(function(c){t[c]=v[c]}),t.instances=[],t.names=[],t.skips=[],t.formatters={};function d(c){for(var m=0,E=0;E<c.length;E++)m=(m<<5)-m+c.charCodeAt(E),m|=0;return t.colors[Math.abs(m)%t.colors.length]}t.selectColor=d;function t(c){var m;function E(){for(var T=arguments.length,P=new Array(T),M=0;M<T;M++)P[M]=arguments[M];if(E.enabled){var C=E,O=Number(new Date),I=O-(m||O);C.diff=I,C.prev=m,C.curr=O,m=O,P[0]=t.coerce(P[0]),typeof P[0]!="string"&&P.unshift("%O");var _=0;P[0]=P[0].replace(/%([a-zA-Z%])/g,function(L,S){if(L==="%%")return L;_++;var A=t.formatters[S];if(typeof A=="function"){var U=P[_];L=A.call(C,U),P.splice(_,1),_--}return L}),t.formatArgs.call(C,P);var D=C.log||t.log;D.apply(C,P)}}return E.namespace=c,E.enabled=t.enabled(c),E.useColors=t.useColors(),E.color=d(c),E.destroy=o,E.extend=s,typeof t.init=="function"&&t.init(E),t.instances.push(E),E}function o(){var c=t.instances.indexOf(this);return c!==-1?(t.instances.splice(c,1),!0):!1}function s(c,m){var E=t(this.namespace+(typeof m>"u"?":":m)+c);return E.log=this.log,E}function l(c){t.save(c),t.names=[],t.skips=[];var m,E=(typeof c=="string"?c:"").split(/[\s,]+/),T=E.length;for(m=0;m<T;m++)E[m]&&(c=E[m].replace(/\*/g,".*?"),c[0]==="-"?t.skips.push(new RegExp("^".concat(c.substr(1),"$"))):t.names.push(new RegExp("^".concat(c,"$"))));for(m=0;m<t.instances.length;m++){var P=t.instances[m];P.enabled=t.enabled(P.namespace)}}function a(){var c=[].concat(u()(t.names.map(h)),u()(t.skips.map(h).map(function(m){return"-".concat(m)}))).join(",");return t.enable(""),c}function i(c){if(c[c.length-1]==="*")return!0;var m,E;for(m=0,E=t.skips.length;m<E;m++)if(t.skips[m].test(c))return!1;for(m=0,E=t.names.length;m<E;m++)if(t.names[m].test(c))return!0;return!1}function h(c){return c.toString().substring(2,c.toString().length-2).replace(/\.\*\?$/,"*")}function g(c){return c instanceof Error?c.stack||c.message:c}return t.enable(t.load()),t}n.default=f},"./util/debugLib/index.js":function(H,n,e){e.r(n),(function(r){var u=e("./util/debugLib/common.js"),f=l(),v={formatArgs:t,save:o,load:s,useColors:d,storage:f};v.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function d(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function t(h){if(h[0]="".concat((this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+h[0]+(this.useColors?"%c ":" "),"+").concat(a.humanize(this.diff)),!!this.useColors){var g="color: ".concat(this.color);h.splice(1,0,g,"color: inherit");var c=0,m=0;h[0].replace(/%[a-zA-Z%]/g,function(E){E!=="%%"&&(c++,E==="%c"&&(m=c))}),h.splice(m,0,g)}}v.log=console.debug||console.log||function(){};function o(h){try{h?v.storage.setItem("debug",h):v.storage.removeItem("debug")}catch{}}function s(){var h;try{h=v.storage.getItem("debug")}catch(g){console.warn(g)}return!h&&typeof r<"u"&&"env"in r&&(h=r.env.DEBUG),h}function l(){try{return localStorage}catch{}}var a=Object(u.default)(v),i=a.formatters;i.j=function(h){try{return JSON.stringify(h)}catch(g){return"[UnexpectedJSONParseError]: ".concat(g.message)}},n.default=a}).call(this,e("../node_modules/process/browser.js"))},"./util/deepmerge.js":function(H,n,e){e.r(n);var r=e("../node_modules/@babel/runtime/helpers/typeof.js"),u=e.n(r),f=function(a){var i=a&&u()(a)==="object";return i&&Object.prototype.toString.call(a)!=="[object RegExp]"&&Object.prototype.toString.call(a)!=="[object Date]"},v=function(a){var i=Array.isArray(a)?[]:{};return i},d=function(a,i){var h=i&&i.clone===!0;return h&&f(a)?s(v(a),a,i):a},t=function(a,i,h){var g=a.slice();return i.forEach(function(c,m){typeof g[m]>"u"?g[m]=d(c,h):f(c)?g[m]=s(a[m],c,h):a.indexOf(c)===-1&&g.push(d(c,h))}),g},o=function(a,i,h){var g={};return f(a)&&Object.keys(a).forEach(function(c){g[c]=d(a[c],h)}),Object.keys(i).forEach(function(c){!f(i[c])||!a[c]?g[c]=d(i[c],h):g[c]=s(a[c],i[c],h)}),g},s=function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},h=arguments.length>2?arguments[2]:void 0,g=Array.isArray(i),c=h||{arrayMerge:t},m=c.arrayMerge||t;if(g)return Array.isArray(a)?m(a,i,h):d(i,h);var E=o(a,i,h);return Object.getPrototypeOf(a)!==Object.prototype&&Object.setPrototypeOf(E,Object.getPrototypeOf(a)),E};n.default=s},"./util/ellipse/calculateEllipseStatistics.js":function(H,n,e){e.r(n);var r=e("./util/ellipse/pointInEllipse.js");n.default=function(u,f){for(var v=0,d=0,t=0,o=0,s=null,l=null,a=f.top;a<f.top+f.height;a++)for(var i=f.left;i<f.left+f.width;i++){var h={x:i,y:a};Object(r.default)(f,h)&&(s===null&&(s=u[o],l=u[o]),v+=u[o],d+=u[o]*u[o],s=Math.min(s,u[o]),l=Math.max(l,u[o]),t++),o++}if(t===0)return{count:t,mean:0,variance:0,stdDev:0,min:0,max:0};var g=v/t,c=d/t-g*g;return{count:t,mean:g,variance:c,stdDev:Math.sqrt(c),min:s,max:l}}},"./util/ellipse/index.js":function(H,n,e){e.r(n);var r=e("./util/ellipse/calculateEllipseStatistics.js");e.d(n,"calculateEllipseStatistics",function(){return r.default});var u=e("./util/ellipse/pointInEllipse.js");e.d(n,"pointInEllipse",function(){return u.default}),n.default={calculateEllipseStatistics:r.default,pointInEllipse:u.default}},"./util/ellipse/pointInEllipse.js":function(H,n,e){e.r(n),n.default=function(r,u){var f=r.width/2,v=r.height/2;if(f<=0||v<=0)return!1;var d={x:r.left+f,y:r.top+v},t={x:u.x-d.x,y:u.y-d.y},o=t.x*t.x/(f*f)+t.y*t.y/(v*v)<=1;return o}},"./util/findAndMoveHelpers.js":function(H,n,e){e.r(n),e.d(n,"moveHandleNearImagePoint",function(){return i}),e.d(n,"findHandleDataNearImagePoint",function(){return h}),e.d(n,"moveAnnotation",function(){return g});var r=e("../node_modules/@babel/runtime/helpers/defineProperty.js"),u=e.n(r),f=e("./store/index.js"),v=e("./manipulators/getHandleNearImagePoint.js"),d=e("./manipulators/index.js"),t=e("./util/getProximityThreshold.js"),o=e("./events.js"),s=e("./util/triggerEvent.js");function l(c,m){var E=Object.keys(c);if(Object.getOwnPropertySymbols){var T=Object.getOwnPropertySymbols(c);m&&(T=T.filter(function(P){return Object.getOwnPropertyDescriptor(c,P).enumerable})),E.push.apply(E,T)}return E}function a(c){for(var m=1;m<arguments.length;m++){var E=arguments[m]!=null?arguments[m]:{};m%2?l(E,!0).forEach(function(T){u()(c,T,E[T])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(E)):l(E).forEach(function(T){Object.defineProperty(c,T,Object.getOwnPropertyDescriptor(E,T))})}return c}var i=function(m,E,T,P,M){T.active=!0,f.state.isToolLocked=!0;var C=function(I){var _=m.detail.element,D=T.toolType||T.toolName,L={toolName:D,toolType:D,element:_,measurementData:a({},T,{active:!1})};Object(s.default)(_,o.default.MEASUREMENT_COMPLETED,L)};Object(d.moveHandle)(m.detail,E.name,T,P,E.options,M,C),m.stopImmediatePropagation(),m.stopPropagation(),m.preventDefault()},h=function(m,E,T,P){for(var M=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"mouse",C=0;C<E.data.length;C++){var O=E.data[C],I=Object(v.default)(m,O.handles,P,Object(t.default)(M,T));if(I)return{handle:I,data:O}}},g=function(m,E,T){var P=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"mouse";T.active=!0,f.state.isToolLocked=!0,Object(d.moveAllHandles)(m.detail,E.name,T,null,E.options,P,function(){T.active=!1,f.state.isToolLocked=!1}),m.stopImmediatePropagation(),m.stopPropagation(),m.preventDefault()}},"./util/freehand/ClickedLineData.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return f});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=function v(d,t){u()(this,v),this.toolIndex=d,this.handleIndexArray=t}},"./util/freehand/FreehandHandleData.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return f});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=function v(d){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;u()(this,v),this.x=d.x,this.y=d.y,this.highlight=t,this.active=o,this.lines=[]}},"./util/freehand/FreehandLineFinder.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return l});var r=e("../node_modules/@babel/runtime/helpers/classCallCheck.js"),u=e.n(r),f=e("../node_modules/@babel/runtime/helpers/createClass.js"),v=e.n(f),d=e("./stateManagement/toolState.js"),t=e("./externalModules.js"),o=e("./util/freehand/ClickedLineData.js"),s=10,l=function(){function a(i,h){u()(this,a),this._eventData=i,this._toolName=h}return v()(a,[{key:"findLine",value:function(){var h=this.findTool();if(h===null)return null;var g=this._getCloseLinesInTool(h);if(g){var c=this._findCorrectLine(h,g);return c}return null}},{key:"findTool",value:function(){if(this._toolData=Object(d.getToolState)(this._eventData.element,this._toolName),this._mousePoint=this._eventData.currentPoints.canvas,!this._toolData)return null;var h=this._nearestHandleToPointAllTools();return h.toolIndex}},{key:"_nearestHandleToPointAllTools",value:function(){for(var h=this._toolData,g={toolIndex:null,handleIndex:null,distance:1/0},c=0;c<h.data.length;c++){var m=this._nearestHandleToPoint(c);m!==null&&m.distance<g.distance&&(g=m)}return g}},{key:"_nearestHandleToPoint",value:function(h){var g=this._eventData,c=this._toolData,m=c.data[h],E=m.handles.points;if(E===void 0||m.visible===!1)return null;for(var T={toolIndex:h,handleIndex:null,distance:1/0},P=0;P<E.length;P++){var M=t.default.cornerstone.pixelToCanvas(g.element,E[P]),C=t.default.cornerstoneMath.point.distance(M,this._mousePoint);C<T.distance&&(T.handleIndex=P,T.distance=C)}return T}},{key:"_getCloseLinesInTool",value:function(h){for(var g=this._toolData,c=g.data[h].handles.points,m=[],E=0;E<c.length;E++){var T=a.getNextHandleIndex(E,c.length),P=this._distanceOfPointfromLine(c[E],c[T]);P<s&&m.push([E,T])}return m}},{key:"_findCorrectLine",value:function(h,g){for(var c=0;c<g.length;c++)if(this._pointProjectsToLineSegment(h,g[c]))return new o.default(h,g[c]);return null}},{key:"_pointProjectsToLineSegment",value:function(h,g){var c=this._eventData,m=this._toolData,E=m.data[h],T=E.handles.points;if(E.handles.points!==void 0){if(E.visible===!1)return!1;var P=T[g[0]],M=T[g[1]],C=a.getCanvasPointsFromHandles(P,M,c.element),O=a.getLineAsVector(C),I=this._getLineOriginToMouseAsVector(C),_=(I[0]*O[0]+I[1]*O[1])/O.magnitude;return _>0&&_<O.magnitude}}},{key:"_getLineOriginToMouseAsVector",value:function(h){var g=[this._mousePoint.x-h[0].x,this._mousePoint.y-h[0].y];return g}},{key:"_distanceOfPointfromLine",value:function(h,g){var c=this._eventData,m=t.default.cornerstone.pixelToCanvas(c.element,h),E=t.default.cornerstone.pixelToCanvas(c.element,g),T=this._mousePoint,P=Math.abs((E.y-m.y)*T.x-(E.x-m.x)*T.y+E.x*m.y-E.y*m.x),M=t.default.cornerstoneMath.point.distance(m,E),C=P/M;return C}}],[{key:"getCanvasPointsFromHandles",value:function(h,g,c){var m=[];return h.x<g.x?(m.push(t.default.cornerstone.pixelToCanvas(c,h)),m.push(t.default.cornerstone.pixelToCanvas(c,g))):(m.push(t.default.cornerstone.pixelToCanvas(c,g)),m.push(t.default.cornerstone.pixelToCanvas(c,h))),m}},{key:"getLineAsVector",value:function(h){var g=[h[1].x-h[0].x,h[1].y-h[0].y];return g.magnitude=t.default.cornerstoneMath.point.distance(h[0],h[1]),g}},{key:"getNextHandleIndex",value:function(h,g){var c;return h<g-1?c=h+1:c=0,c}}]),a}()},"./util/freehand/addLine.js":function(H,n,e){e.r(n),n.default=function(r,u){u===r.length-1?r[u].lines.push(r[0]):r[u].lines.push(r[u+1])}},"./util/freehand/calculateFreehandStatistics.js":function(H,n,e){e.r(n);var r=e("./util/freehand/pointInFreehand.js");n.default=function(v,d,t){var o={count:0,mean:0,variance:0,stdDev:0},s=u(v,d,t);return s.count===0||(o.count=s.count,o.mean=s.value/s.count,o.variance=s.squared/s.count-o.mean*o.mean,o.stdDev=Math.sqrt(o.variance)),o};function u(v,d,t){for(var o={value:0,squared:0,count:0},s=0,l=d.top;l<d.top+d.height;l++)for(var a=d.left;a<d.left+d.width;a++){var i={x:a,y:l};f(t,i,o,v[s]),s++}return o}function f(v,d,t,o){Object(r.default)(v,d)&&(t.value+=o,t.squared+=o*o,t.count++)}},"./util/freehand/freehandArea.js":function(H,n,e){e.r(n),n.default=function(r,u){var f=0,v=r.length-1;u=u||1;for(var d=0;d<r.length;d++)f+=(r[v].x+r[d].x)*(r[v].y-r[d].y),v=d;return Math.abs(f*u/2)}},"./util/freehand/freehandIntersect.js":function(H,n,e){e.r(n);function r(l,a){var i=a.length-1,h=t(a[i]),g=t(l);return v(a,h,g,[i])}function u(l){var a=l.length-1,i=t(l[a]),h=t(l[0]);return v(l,i,h,[a,0])}function f(l,a){var i=t(l[a]),h=a-1;a===0&&(h=l.length-1);var g=t(l[h]);return v(l,i,g,[a,h])?!0:(a===l.length-1?h=0:h=a+1,g=t(l[h]),v(l,i,g,[a,h]))}function v(l,a,i,h){for(var g=l.length-1,c=0;c<l.length;c++){if(h.indexOf(c)!==-1||h.indexOf(g)!==-1){g=c;continue}var m=t(l[g]),E=t(l[c]);if(d(a,i,m,E))return!0;g=c}return!1}function d(l,a,i,h){var g=!1,c=[o(l,a,i),o(l,a,h),o(i,h,l),o(i,h,a)];return c[0]!==c[1]&&c[2]!==c[3]?!0:((c[0]===0&&s(l,i,a)||c[1]===0&&s(l,h,a)||c[2]===0&&s(i,l,h)||c[3]===0&&s(i,a,h))&&(g=!0),g)}function t(l){return{x:l.x,y:l.y}}function o(l,a,i){var h=(a.y-l.y)*(i.x-a.x)-(a.x-l.x)*(i.y-a.y);return h===0?0:h>0?1:2}function s(l,a,i){return a.x<=Math.max(l.x,i.x)&&a.x>=Math.min(l.x,i.x)&&a.y<=Math.max(l.y,i.y)&&a.y>=Math.min(l.y,i.y)}n.default={newHandle:r,end:u,modify:f}},"./util/freehand/index.js":function(H,n,e){e.r(n);var r=e("./util/freehand/calculateFreehandStatistics.js"),u=e("./util/freehand/ClickedLineData.js"),f=e("./util/freehand/freehandArea.js"),v=e("./util/freehand/FreehandHandleData.js"),d=e("./util/freehand/freehandIntersect.js"),t=e("./util/freehand/FreehandLineFinder.js"),o=e("./util/freehand/insertOrDelete.js"),s=e("./util/freehand/pointInFreehand.js"),l=e("./util/freehand/addLine.js");n.default={calculateFreehandStatistics:r.default,ClickedLineData:u.default,freehandArea:f.default,FreehandHandleData:v.default,freehandIntersect:d.default,FreehandLineFinder:t.default,insertOrDelete:o.default,pointInFreehand:s.default,addLine:l.default}},"./util/freehand/insertOrDelete.js":function(H,n,e){e.r(n);var r=e("./util/freehand/FreehandLineFinder.js"),u=e("./util/freehand/FreehandHandleData.js"),f=e("./stateManagement/toolState.js"),v=e("./externalModules.js"),d=e("./util/freehand/addLine.js");n.default=function(l,a){var i=l.detail;if(a&&a.handleNearby!==null){var h={toolIndex:a.toolIndex,handleIndex:a.handleNearby};t.call(this,i,h)}else{var g=new r.default(i,this.name),c=g.findLine();c&&o.call(this,i,c)}};function t(l,a){var i=Object(f.getToolState)(l.element,this.name);if(i!==void 0){var h=a.handleIndex,g=a.toolIndex,c=i.data[g],m=c.handles.points;m.length<=3||(h===m.length-1?(m[h-1].lines.pop(),m[h-1].lines.push(m[0])):h===0?(m[m.length-1].lines.pop(),m[m.length-1].lines.push(m[h+1])):(m[h-1].lines.pop(),m[h-1].lines.push(m[h+1])),m.splice(h,1),c.invalidated=!0,c.active=!0,c.highlight=!0,v.default.cornerstone.updateImage(l.element))}}function o(l,a){var i=Object(f.getToolState)(l.element,this.name);if(i!==void 0){var h=i.data[a.toolIndex],g=s(a);if(g!==1/0){var c=new u.default(l.currentPoints.image),m=h.handles.points;m.splice(g,0,c),m[g-1].lines.pop(),m[g-1].lines.push(l.currentPoints.image),Object(d.default)(m,g),h.active=!0,h.highlight=!0,h.invalidated=!0,v.default.cornerstone.updateImage(l.element)}}}function s(l){for(var a=l.handleIndexArray,i=1/0,h=a.includes(0),g=0;g<a.length;g++){var c=a[g];c!==0&&c<i&&(i=c)}return h&&i===1&&(i=0),i++,i}},"./util/freehand/pointInFreehand.js":function(H,n,e){e.r(n),n.default=function(d,t){for(var o=!1,s=d.length-1,l=0;l<d.length;l++)v(t,d[l],d[s])&&(o=!o),s=l;return o};function r(d,t,o){return t<d&&d<o||o<d&&d<t}function u(d,t,o){if(t.x>d.x&&o.x>d.x)return!0;if(t.x===o.x)return d.x<t.x;if(t.x>o.x){var s=t;t=o,o=s}var l=f(d,t,o);return Math.sign(l.gradient)*d.y>Math.sign(l.gradient)*l.value}function f(d,t,o){var s=(o.y-t.y)/(o.x-t.x),l={value:t.y+s*(d.x-t.x),gradient:s};return l}function v(d,t,o){return!!(r(d.y,t.y,o.y)&&u(d,t,o))}},"./util/getActiveTool.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return v});var r=e("./store/index.js"),u=e("./store/getActiveToolsForElement.js"),f=e("./store/filterToolsUsableWithMultiPartTools.js");function v(d,t){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"mouse",s;if(o==="touch"?(s=Object(u.default)(d,r.getters.touchTools()),s=s.filter(function(l){return l.options.isTouchActive})):(s=Object(u.default)(d,r.getters.mouseTools()),s=s.filter(function(l){return Array.isArray(l.options.mouseButtonMask)&&t&&l.options.mouseButtonMask.includes(t)&&l.options.isMouseActive}),r.state.isMultiPartToolActive&&(s=Object(f.default)(s))),s.length!==0)return s[0]}},"./util/getCircleCoords.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return u});var r=e("./externalModules.js");function u(f,v){var d=r.default.cornerstoneMath.point.distance,t=d(f,v);return{left:Math.floor(Math.min(f.x-t,v.x)),top:Math.floor(Math.min(f.y-t,v.y)),width:t*2,height:t*2}}},"./util/getDefault.js":function(H,n,e){e.r(n),n.default=function(r,u){return r===void 0?u:r}},"./util/getKeyPressData.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return f});var r=e("./store/index.js"),u=e("./externalModules.js");function f(v){var d=u.default.cornerstone,t=v.currentTarget,o=d.getEnabledElement(t);if(!(!o||!o.image)){var s=r.default.state.mousePositionImage;return{event:window.event||v,element:t,viewport:d.getViewport(t),image:o.image,currentPoints:{image:s,canvas:d.pixelToCanvas(t,s)},keyCode:v.keyCode,which:v.which}}}},"./util/getLuminance.js":function(H,n,e){e.r(n);var r=e("./externalModules.js");n.default=function(u,f,v,d,t){if(!u)throw new Error("getLuminance: parameter element must not be undefined");f=Math.round(f),v=Math.round(v);var o=r.default.cornerstone.getEnabledElement(u),s=o.image,l=[],a=0,i=s.getPixelData(),h,g,c;if(s.color)for(g=0;g<t;g++)for(c=0;c<d;c++){h=((g+v)*s.columns+(c+f))*4;var m=i[h],E=i[h+1],T=i[h+2];l[a++]=.2126*m+.7152*E+.0722*T}else for(g=0;g<t;g++)for(c=0;c<d;c++)h=(g+v)*s.columns+(c+f),l[a++]=i[h]*s.slope+s.intercept;return l}},"./util/getMaxSimultaneousRequests.js":function(H,n,e){e.r(n),e.d(n,"getDefaultSimultaneousRequests",function(){return t}),e.d(n,"getMaxSimultaneousRequests",function(){return d}),e.d(n,"setMaxSimultaneousRequests",function(){return v}),e.d(n,"getBrowserInfo",function(){return f}),e.d(n,"isMobileDevice",function(){return o});var r,u={default:6,IE:{9:6,10:8,default:8},Firefox:{default:6},Opera:{10:8,11:6,12:6,default:6},Chrome:{default:6},Safari:{default:6}};function f(){var s=navigator.userAgent,l=s.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[],a;return/trident/i.test(l[1])?(a=/\brv[ :]+(\d+)/g.exec(s)||[],"IE ".concat(a[1]||"")):l[1]==="Chrome"&&(a=s.match(/\b(OPR|Edge)\/(\d+)/),a!==null)?a.slice(1).join(" ").replace("OPR","Opera"):(l=l[2]?[l[1],l[2]]:[navigator.appName,navigator.appVersion,"-?"],(a=s.match(/version\/(\d+)/i))!==null&&l.splice(1,1,a[1]),l.join(" "))}function v(s){r=s}function d(){return r||t()}function t(){var s=f(),l=s.split(" "),a=l[0],i=l[1],h=u[a];return h?h[i]?h[i]:h.default:u.default}function o(){var s=new RegExp("Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini");return s.test(navigator.userAgent)}},"./util/getPixelSpacing.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return u});var r=e("./externalModules.js");function u(f){var v=r.default.cornerstone.metaData.get("imagePlaneModule",f.imageId);return v?{rowPixelSpacing:v.rowPixelSpacing||v.rowImagePixelSpacing,colPixelSpacing:v.columnPixelSpacing||v.colImagePixelSpacing}:{rowPixelSpacing:f.rowPixelSpacing,colPixelSpacing:f.columnPixelSpacing}}},"./util/getProximityThreshold.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return u});var r=e("./store/index.js");function u(f,v){var d=r.state.clickProximity,t=r.state.touchProximity,o=r.state.tools.find(function(s){var l=s.name;return l===v});return o&&o.configuration&&(d=o.configuration.clickProximity||d,t=o.configuration.touchProximity||t),f==="mouse"?d:t}},"./util/getRGBPixels.js":function(H,n,e){e.r(n);var r=e("./externalModules.js");n.default=function(u,f,v,d,t){if(!u)throw new Error("getRGBPixels: parameter element must not be undefined");f=Math.round(f),v=Math.round(v);var o=r.default.cornerstone.getEnabledElement(u),s=[],l=0,a=o.image.getPixelData(),i,h,g;if(o.image.color)for(h=0;h<t;h++)for(g=0;g<d;g++){i=((h+v)*o.image.columns+(g+f))*4;var c=a[i],m=a[i+1],E=a[i+2],T=a[i+3];s[l++]=c,s[l++]=m,s[l++]=E,s[l++]=T}return s}},"./util/getROITextBoxCoords.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return r});function r(f,v){var d=u(v),t=(d.left.x+d.right.x)/2,o=(d.top.y+d.bottom.y)/2,s={};return f.rotation>=0&&f.rotation<90&&(s.x=f.hflip?d.left.x:d.right.x,s.y=o),f.rotation>=90&&f.rotation<180&&(s.x=t,s.y=f.vflip?d.bottom.y:d.top.y),f.rotation>=180&&f.rotation<270&&(s.x=f.hflip?d.right.x:d.left.x,s.y=o),f.rotation>=270&&f.rotation<360&&(s.x=t,s.y=f.vflip?d.top.y:d.bottom.y),s}function u(f){var v=[f.start,f.end].sort(a),d=[f.start,f.end].sort(i),t=v[0],o=v[v.length-1],s=d[0],l=d[d.length-1];return{top:s,left:t,bottom:l,right:o};function a(h,g){return h.x<g.x?-1:1}function i(h,g){return h.y<g.y?-1:1}}},"./util/isEmptyObject.js":function(H,n,e){e.r(n);var r=function(f){return Object.keys(f).length===0&&f.constructor===Object};n.default=r},"./util/isObject.js":function(H,n,e){e.r(n);var r=e("../node_modules/@babel/runtime/helpers/typeof.js"),u=e.n(r);function f(v){var d=u()(v);return v!==null&&(d==="object"||d==="function")}n.default=f},"./util/isPointInImage.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return r});function r(u,f,v){var d=u.x,t=u.y;return d<v&&d>=0&&t<f&&t>=0}},"./util/isPointInPolygon.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return r});function r(u,f){for(var v=u[0],d=u[1],t=!1,o=0,s=f.length-1;o<f.length;s=o++){var l=f[o][0],a=f[o][1],i=f[s][0],h=f[s][1],g=a>d!=h>d&&v<(i-l)*(d-a)/(h-a)+l;g&&(t=!t)}return t}},"./util/lineSegDistance.js":function(H,n,e){e.r(n);var r=e("./externalModules.js");n.default=function(u,f,v,d){var t=r.default.cornerstone,o={start:t.pixelToCanvas(u,f),end:t.pixelToCanvas(u,v)};return r.default.cornerstoneMath.lineSegment.distanceToPoint(o,d)}},"./util/logger.js":function(H,n,e){e.r(n),e.d(n,"getLogger",function(){return d}),e.d(n,"enable",function(){return t}),e.d(n,"disable",function(){return o});var r=e("./util/debugLib/index.js"),u="cornerstoneTools",f=Object(r.default)(u),v=!0;f.enabled||(console.log("%cCornerstone Tools","background: #339955; padding: 4px; font-weight: bold; color: white"),console.info('run %clocalStorage.setItem("debug", "cornerstoneTools")%c to see console output',"background: #eaeaea; color: #333; font-family: monospace",""));var d=function(l){var a=f.extend(l);return{log:a,warn:v?console.warn.bind(console):a,error:console.error.bind(console)}},t=function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"".concat(u,":*");return r.default.enable(l)},o=function(){return r.default.disable()}},"./util/makeUnselectable.js":function(H,n,e){e.r(n),n.default=function(r,u){r.style.webkitUserSelect="none",r.style.webkitTouchCallout="none",r.style.mozUserSelect="none",r.style.msUserSelect="none",r.style.oUserSelect="none",r.style.khtmlUserSelect="none",r.style.userSelect="none",r.unselectable="on",r.oncontextmenu=function(){return!1},u===!0&&(r.style.pointerEvents="none")}},"./util/numbersWithCommas.js":function(H,n,e){e.r(n),n.default=function(r){var u=r.toString().split(".");return u[0]=u[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),u.join(".")}},"./util/pointInsideBoundingBox.js":function(H,n,e){e.r(n);var r=e("./externalModules.js");n.default=function(u,f){if(u.boundingBox)return r.default.cornerstoneMath.point.insideRect(f,u.boundingBox)}},"./util/pointProjector.js":function(H,n,e){e.r(n),e.d(n,"projectPatientPointToImagePlane",function(){return f}),e.d(n,"imagePointToPatientPoint",function(){return v}),e.d(n,"planePlaneIntersection",function(){return o}),e.d(n,"rotatePoint",function(){return s});var r=e("./externalModules.js"),u=e("./util/convertToVector3.js");function f(l,a){var i=Object(u.default)(a.rowCosines),h=Object(u.default)(a.columnCosines),g=Object(u.default)(a.imagePositionPatient),c=l.clone().sub(g),m=i.dot(c)/a.columnPixelSpacing,E=h.dot(c)/a.rowPixelSpacing;return{x:m,y:E}}function v(l,a){var i=Object(u.default)(a.rowCosines),h=Object(u.default)(a.columnCosines),g=Object(u.default)(a.imagePositionPatient),c=i.clone().multiplyScalar(l.x);c.multiplyScalar(a.columnPixelSpacing);var m=h.clone().multiplyScalar(l.y);m.multiplyScalar(a.rowPixelSpacing);var E=c.add(m);return E.add(g),E}function d(l){var a=v({x:0,y:0},l),i=v({x:l.columns,y:0},l),h=v({x:0,y:l.rows},l),g=v({x:l.columns,y:l.rows},l),c={top:new r.default.cornerstoneMath.Line3(a,i),left:new r.default.cornerstoneMath.Line3(a,h),right:new r.default.cornerstoneMath.Line3(i,g),bottom:new r.default.cornerstoneMath.Line3(h,g)};return c}function t(l,a){var i=[];return Object.keys(a).forEach(function(h){var g=a[h],c=l.intersectLine(g);c&&i.push(c)}),i}function o(l,a){var i=Object(u.default)(l.rowCosines),h=Object(u.default)(l.columnCosines),g=Object(u.default)(l.imagePositionPatient),c=Object(u.default)(a.rowCosines),m=Object(u.default)(a.columnCosines),E=Object(u.default)(a.imagePositionPatient),T=i.clone().cross(h),P=new r.default.cornerstoneMath.Plane;P.setFromNormalAndCoplanarPoint(T,g);var M=c.clone().cross(m),C=new r.default.cornerstoneMath.Plane;C.setFromNormalAndCoplanarPoint(M,E);var O=C.clone().intersectPlane(P),I=O.origin,_=O.direction,D=v({x:a.columns,y:a.rows},a),L=E.distanceTo(D),S=new r.default.cornerstoneMath.Line3;S.start=I,S.end=I.clone().add(_.multiplyScalar(L));var A=d(a),U=t(S,A);if(U.length===2)return{start:U[0],end:U[1]}}function s(l,a,i){var h=i*(Math.PI/180),g=Math.cos(h)*(l.x-a.x)-Math.sin(h)*(l.y-a.y)+a.x,c=Math.sin(h)*(l.x-a.x)+Math.cos(h)*(l.y-a.y)+a.y;return{x:g,y:c}}},"./util/roundToDecimal.js":function(H,n,e){e.r(n),n.default=function(r,u){var f=Math.pow(10,u);return Math.round(r*f)/f}},"./util/scroll.js":function(H,n,e){e.r(n);var r=e("./util/scrollToIndex.js"),u=e("./stateManagement/toolState.js"),f=e("./util/clip.js"),v=e("./externalModules.js");n.default=function(t,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=Object(u.getToolState)(t,"stack");if(!(!a||!a.data||!a.data.length)){var i=a.data[0];i.pending||(i.pending=[]);var h=i.currentImageIdIndex+o;if(s){var g=i.imageIds.length;h%=g}else h=Object(f.default)(h,0,i.imageIds.length-1);if(l)Object(r.default)(t,h);else{var c={index:h};i.pending.push(c),d(i,c,t)}}};function d(t,o,s){if(t.pending[0]===o){if(t.currentImageIdIndex===o.index){t.pending.splice(t.pending.indexOf(o),1),t.pending.length>0&&d(t,t.pending[0],s);return}var l=function a(i){var h=t.imageIds.indexOf(i.detail.image.imageId);h===o.index&&(t.pending.splice(t.pending.indexOf(o),1),s.removeEventListener(v.default.cornerstone.EVENTS.NEW_IMAGE,a),t.pending.length>0&&d(t,t.pending[0],s))};s.addEventListener(v.default.cornerstone.EVENTS.NEW_IMAGE,l),Object(r.default)(s,o.index)}}},"./util/scrollToIndex.js":function(H,n,e){e.r(n);var r=e("./events.js"),u=e("./externalModules.js"),f=e("./stateManagement/toolState.js"),v=e("./stateManagement/loadHandlerManager.js"),d=e("./util/triggerEvent.js");n.default=function(t,o){var s=Object(f.getToolState)(t,"stack");if(!s||!s.data||!s.data.length)return;var l=u.default.cornerstone,a;if(s.data.length>1){var i=Object(f.getToolState)(t,"stackRenderer");i&&i.data&&i.data.length&&(a=i.data[0])}var h=s.data[0];o<0&&(o+=h.imageIds.length);var g=v.default.getStartLoadHandler(t),c=v.default.getEndLoadHandler(t),m=v.default.getErrorLoadingHandler(t);function E(I){if(h.currentImageIdIndex===o){try{l.getEnabledElement(t)}catch{return}a?(a.currentImageIdIndex=o,a.render(t,s.data)):l.displayImage(t,I),c&&c(t,I)}}function T(I){var _=h.imageIds[o];m&&m(t,_,I)}if(o!==h.currentImageIdIndex){g&&g(t);var P={newImageIdIndex:o,direction:o-h.currentImageIdIndex};h.currentImageIdIndex=o;var M=h.imageIds[o],C=!!h.preventCache,O;C?O=l.loadImage(M):O=l.loadAndCacheImage(M),O.then(E,T),Object(d.default)(t,r.default.STACK_SCROLL,P)}}},"./util/segmentation/drawBrush.js":function(H,n,e){e.r(n),e.d(n,"drawBrushPixels",function(){return v});var r=e("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),u=e.n(r),f=e("./util/segmentation/eraseIfSegmentIndex.js");function v(d,t,o,s){var l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,a=function(h,g){return g*s+h};d.forEach(function(i){var h=a.apply(void 0,u()(i));l?Object(f.default)(h,t,o):t[h]=o})}},"./util/segmentation/eraseIfSegmentIndex.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return r});function r(u,f,v){f[u]===v&&(f[u]=0)}},"./util/segmentation/eraseOutsideBoundingBox.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return u});var r=e("./util/segmentation/eraseIfSegmentIndex.js");function u(f,v,d,t){for(var o=f.detail,s=v.pixelData,l=v.segmentIndex,a=o.image,i=a.width,h=a.height,g=0;g<i;g++)for(var c=0;c<d[1];c++)Object(r.default)(c*i+g,s,l);for(var m=0;m<d[0];m++)for(var E=d[1];E<t[1];E++)Object(r.default)(E*i+m,s,l);for(var T=t[0];T<i;T++)for(var P=d[1];P<t[1];P++)Object(r.default)(P*i+T,s,l);for(var M=0;M<i;M++)for(var C=t[1];C<h;C++)Object(r.default)(C*i+M,s,l)}},"./util/segmentation/eraseShape.js":function(H,n,e){e.r(n),e.d(n,"eraseInsideShape",function(){return o}),e.d(n,"eraseOutsideShape",function(){return s});var r=e("../node_modules/@babel/runtime/helpers/slicedToArray.js"),u=e.n(r),f=e("./util/segmentation/eraseOutsideBoundingBox.js"),v=e("./util/segmentation/isSameSegment.js"),d=e("./util/logger.js");Object(d.getLogger)("util:segmentation:operations:eraseOutsideCircle");function t(l,a,i,h,g){var c=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"inside",m=l.detail.image.width,E=a.pixelData,T=a.segmentIndex,P=u()(h,2),M=P[0],C=P[1],O=u()(g,2),I=O[0],_=O[1];c==="outside"&&Object(f.default)(l,a,h,g);for(var D=M;D<I;D++)for(var L=C;L<_;L++){var S=L*m+D;Object(v.default)(S,E,T)&&i({x:D,y:L})&&(E[S]=0)}}function o(l,a,i,h,g){t(l,a,i,h,g,"inside")}function s(l,a,i,h,g){t(l,a,function(c){return!i(c)},h,g,"outside")}},"./util/segmentation/fillOutsideBoundingBox.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return r});function r(u,f,v,d){for(var t=f.pixelData,o=f.segmentIndex,s=u.detail.image,l=s.width,a=s.height,i=0;i<l;i++)for(var h=0;h<v[1];h++)t[h*l+i]=o;for(var g=0;g<v[0];g++)for(var c=v[1];c<d[1];c++)t[c*l+g]=o;for(var m=d[0];m<l;m++)for(var E=v[1];E<d[1];E++)t[E*l+m]=o;for(var T=0;T<l;T++)for(var P=d[1];P<a;P++)t[P*l+T]=o}},"./util/segmentation/fillShape.js":function(H,n,e){e.r(n),e.d(n,"fillInsideShape",function(){return o}),e.d(n,"fillOutsideShape",function(){return s});var r=e("../node_modules/@babel/runtime/helpers/slicedToArray.js"),u=e.n(r),f=e("./util/segmentation/fillOutsideBoundingBox.js"),v=e("./util/logger.js"),d=Object(v.getLogger)("util:segmentation:operations:helpers:fillShape");function t(l,a,i,h,g){var c=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"inside",m=a.pixelData,E=a.segmentIndex;if(m===void 0||E===void 0){d.error("fillInsideShape requires operationData to contain pixelData and segmentIndex");return}var T=l.detail.image.width,P=u()(h,2),M=P[0],C=P[1],O=u()(g,2),I=O[0],_=O[1];c==="outside"&&Object(f.default)(l,a,h,g);for(var D=M;D<I;D++)for(var L=C;L<_;L++){var S=L*T+D;i({x:D,y:L})&&(m[S]=E)}}function o(l,a,i,h,g){t(l,a,i,h,g,"inside")}function s(l,a,i,h,g){t(l,a,function(c){return!i(c)},h,g,"outside")}},"./util/segmentation/floodFill.js":function(H,n,e){e.r(n);var r=e("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),u=e.n(r);n.default=function(t,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},l=s.onFlood||function(){},a=s.onBoundary||function(){},i=s.equals||f,h=s.diagonals||!1,g=S(o),c=U(),m=[],E=[],T={},P={};for(m.push({currentArgs:o});m.length>0;)M(m.pop());return{flooded:E,boundaries:b()};function M(y){var x=y.currentArgs,j=y.previousArgs;C(x)||(O(x),I(x)?(_(x),L(x)):D(j))}function C(y){return T[y]===!0}function O(y){T[y]=!0}function I(y){var x=A(S,[y]);return A(i,[x,g])}function _(y){E.push(y),l.apply(void 0,u()(y))}function D(y){P[y]=y,a.apply(void 0,u()(y))}function L(y){for(var x=0;x<c.length;x+=1){for(var j=c[x],p=y.slice(0),R=0;R<y.length;R+=1)p[R]+=j[R];m.push({currentArgs:p,previousArgs:y})}}function S(y){return t.apply(void 0,u()(y))}function A(y,x){try{return y.apply(void 0,u()(x))}catch{return}}function U(){var y=B(o.length);return y.filter(function(x){var j=v(x);return j!==0&&(j===1||h)})}function B(y){for(var x=[],j=function(K){return K.split("").map(function(N){return parseInt(N,10)-1})},p=0;p<Math.pow(3,y);p+=1){var R=d(p.toString(3),"0",y);x.push(j(R))}return x}function b(){var y=[];for(var x in P)P.hasOwnProperty(x)&&y.unshift(P[x]);return y}};function f(t,o){return t===o}function v(t){for(var o=0,s=0;s<t.length;s+=1)t[s]!==0&&(o+=1);return o}function d(t,o,s){var l=new Array(s+1),a=l.join(o);return(a+t).slice(-s)}},"./util/segmentation/getBoundingBoxAroundCircle.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return u});var r=e("./util/getCircleCoords.js");function u(f){var v=f.detail.handles,d=f.detail.image,t=d.width,o=d.height,s=Object(r.default)(v.start,v.end),l=s.width+s.left,a=s.left,i=s.top+s.height,h=s.top;return a=Math.floor(a),h=Math.floor(h),l=Math.floor(l),i=Math.floor(i),l=Math.min(t,l),a=Math.max(0,a),i=Math.min(o,i),h=Math.max(0,h),[[a,h],[l,i]]}},"./util/segmentation/getBoundingBoxAroundPolygon.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return r});function r(u,f){var v=1/0,d=0,t=1/0,o=0,s=f.width,l=f.height;return u.forEach(function(a){v=Math.min(a[0],v),d=Math.max(a[0],d),t=Math.min(a[1],t),o=Math.max(a[1],o)}),v=Math.floor(v),t=Math.floor(t),d=Math.floor(d),o=Math.floor(o),d=Math.min(s,d),v=Math.max(0,v),o=Math.min(l,o),t=Math.max(0,t),[[v,t],[d,o]]}},"./util/segmentation/getCircle.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return r});function r(u,f,v){var d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,t=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,o=Math.floor(d),s=Math.floor(t);if(u===1)return[[o,s]];for(var l=[],a=0,i=-u;i<=u;i++){var h=s+i;if(!(h>f||h<0))for(var g=-u;g<=u;g++){var c=o+g;c>=v||c<0||g*g+i*i<u*u&&(l[a++]=[o+g,s+i])}}return l}},"./util/segmentation/getDiffBetweenPixelData.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return r});function r(u,f){for(var v=[],d=0;d<u.length;d++)u[d]!==f[d]&&v.push([d,u[d],f[d]]);return v}},"./util/segmentation/getPixelPathBetweenPixels.js":function(H,n,e){e.r(n);var r=e("./externalModules.js"),u=1/Math.sqrt(2),f={up:{x:0,y:1},upRight:{x:u,y:u},right:{x:1,y:0},downRight:{x:u,y:-u},down:{x:0,y:1},downLeft:{x:-u,y:-u},left:{x:-1,y:0},upLeft:{x:-u,y:u}};n.default=function(i,h){for(var g={x:i.x,y:i.y},c=[];h.x!==g.x||h.y!==g.y;)h.x===g.x?h.y>g.y?g.y++:g.y--:h.y===g.y?h.x>g.x?g.x++:g.x--:h.y>g.y?h.x>g.x?v(g,h):d(g,h):h.x>g.x?t(g,h):o(g,h),c.push({x:g.x,y:g.y});return c.pop(),c};function v(i,h){var g=s(i,h),c=[l(g,f.up),l(g,f.right),l(g,f.upRight)],m=a(c);switch(m){case 0:i.y++;break;case 1:i.x++;break;case 2:i.y++,i.x++}}function d(i,h){var g=s(i,h),c=[l(g,f.up),l(g,f.left),l(g,f.upLeft)],m=a(c);switch(m){case 0:i.y++;break;case 1:i.x--;break;case 2:i.y++,i.x--}}function t(i,h){var g=s(i,h),c=[l(g,f.down),l(g,f.right),l(g,f.downRight)],m=a(c);switch(m){case 0:i.y--;break;case 1:i.x++;break;case 2:i.y--,i.x++}}function o(i,h){var g=s(i,h),c=[l(g,f.down),l(g,f.left),l(g,f.downLeft)],m=a(c);switch(m){case 0:i.y--;break;case 1:i.x--;break;case 2:i.y--,i.x--}}function s(i,h){var g=r.default.cornerstoneMath.point.distance(i,h);return{x:(h.x-i.x)/g,y:(h.y-i.y)/g}}function l(i,h){return i.x*h.x+i.y*h.y}function a(i){var h=i[0]>i[1]?0:1;return i[2]>i[h]&&(h=2),h}},"./util/segmentation/index.js":function(H,n,e){e.r(n);var r=e("./util/segmentation/drawBrush.js");e.d(n,"drawBrushPixels",function(){return r.drawBrushPixels});var u=e("./util/segmentation/eraseIfSegmentIndex.js");e.d(n,"eraseIfSegmentIndex",function(){return u.default});var f=e("./util/segmentation/eraseOutsideBoundingBox.js");e.d(n,"eraseOutsideBoundingBox",function(){return f.default});var v=e("./util/segmentation/eraseShape.js");e.d(n,"eraseInsideShape",function(){return v.eraseInsideShape}),e.d(n,"eraseOutsideShape",function(){return v.eraseOutsideShape});var d=e("./util/segmentation/fillOutsideBoundingBox.js");e.d(n,"fillOutsideBoundingBox",function(){return d.default});var t=e("./util/segmentation/fillShape.js");e.d(n,"fillInsideShape",function(){return t.fillInsideShape}),e.d(n,"fillOutsideShape",function(){return t.fillOutsideShape});var o=e("./util/segmentation/floodFill.js");e.d(n,"floodFill",function(){return o.default});var s=e("./util/segmentation/getBoundingBoxAroundCircle.js");e.d(n,"getBoundingBoxAroundCircle",function(){return s.default});var l=e("./util/segmentation/getBoundingBoxAroundPolygon.js");e.d(n,"getBoundingBoxAroundPolygon",function(){return l.default});var a=e("./util/segmentation/getCircle.js");e.d(n,"getCircle",function(){return a.default});var i=e("./util/segmentation/getPixelPathBetweenPixels.js");e.d(n,"getPixelPathBetweenPixels",function(){return i.default});var h=e("./util/segmentation/isSameSegment.js");e.d(n,"isSameSegment",function(){return h.default});var g=e("./util/segmentation/triggerLabelmapModifiedEvent.js");e.d(n,"triggerLabelmapModifiedEvent",function(){return g.default});var c=e("./util/segmentation/getDiffBetweenPixelData.js");e.d(n,"getDiffBetweenPixelData",function(){return c.default})},"./util/segmentation/isSameSegment.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return r});function r(u,f,v){return f[u]===v}},"./util/segmentation/triggerLabelmapModifiedEvent.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return v});var r=e("./externalModules.js"),u=e("./events.js"),f=e("./store/index.js");function v(d,t){var o=Object(f.getModule)("segmentation"),s=o.getters;t=t===void 0?s.activeLabelmapIndex(d):t,r.default.cornerstone.triggerEvent(d,u.default.LABELMAP_MODIFIED,{labelmapIndex:t})}},"./util/setContextToDisplayFontSize.js":function(H,n,e){e.r(n);var r=e("./externalModules.js");n.default=function(u,f,v){var d=.1;r.default.cornerstone.setToPixelCoordinateSystem(u,f,d);var t=v/u.viewport.scale/d,o=v/u.viewport.scale/d;return{fontSize:t,lineHeight:o,fontScale:d}}},"./util/throttle.js":function(H,n,e){e.r(n);var r=e("./util/debounce.js"),u=e("./util/isObject.js");function f(v,d,t){var o=!0,s=!0;if(typeof v!="function")throw new TypeError("Expected a function");return Object(u.default)(t)&&(o="leading"in t?!!t.leading:o,s="trailing"in t?!!t.trailing:s),Object(r.default)(v,d,{leading:o,trailing:s,maxWait:d})}n.default=f},"./util/triggerEvent.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return r});function r(u,f){var v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,d;return typeof window.CustomEvent=="function"?d=new CustomEvent(f,{detail:v,cancelable:!0}):(d=document.createEvent("CustomEvent"),d.initCustomEvent(f,!0,!0,v)),u.dispatchEvent(d)}},"./util/uuidv4.js":function(H,n,e){e.r(n),e.d(n,"default",function(){return r});function r(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(u){var f=Math.random()*16|0,v=u==="x"?f:f&3|8;return v.toString(16)})}},"./util/wait.js":function(H,n,e){e.r(n),e.d(n,"wait",function(){return u}),e.d(n,"waitForEnabledElementImageToLoad",function(){return f});var r=e("./externalModules.js"),u=function(d){return new Promise(function(t){return setTimeout(t,d)})};function f(v){try{var d=r.default.cornerstone.getEnabledElement(v);return d.image?d:u(250).then(function(){return f(v)})}catch{return null}}n.default=u},"./util/zoom/changeViewportScale.js":function(H,n,e){e.r(n),n.default=function(r,u,f){var v=f.maxScale,d=f.minScale,t=1.7,o=Math.log(r.scale)/Math.log(t),s=o+u,l=Math.pow(t,s);return v&&l>v?r.scale=v:d&&l<d?r.scale=d:r.scale=l,r}},"./util/zoom/correctShift.js":function(H,n,e){e.r(n),n.default=function(r,u){var f=u.hflip,v=u.vflip,d=u.rotation;if(r.x*=f?-1:1,r.y*=v?-1:1,d!==0){var t=d*Math.PI/180,o=Math.cos(t),s=Math.sin(t),l=r.x*o-r.y*s,a=r.x*s+r.y*o;r.x=l,r.y=a}return r}},"./util/zoom/index.js":function(H,n,e){e.r(n);var r=e("./util/zoom/changeViewportScale.js");e.d(n,"changeViewportScale",function(){return r.default});var u=e("./util/zoom/correctShift.js");e.d(n,"correctShift",function(){return u.default}),n.default={changeViewportScale:r.default,correctShift:u.default}},"./version.js":function(H,n,e){e.r(n),n.default="6.0.10"}})})})(Rt);var Xt=Rt.exports;const ot=Et(Xt);var pt={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(Ne){(function(ye,H,n,e){var r=["","webkit","Moz","MS","ms","o"],u=H.createElement("div"),f="function",v=Math.round,d=Math.abs,t=Date.now;function o(F,V,X){return setTimeout(m(F,X),V)}function s(F,V,X){return Array.isArray(F)?(l(F,X[V],X),!0):!1}function l(F,V,X){var q;if(F)if(F.forEach)F.forEach(V,X);else if(F.length!==e)for(q=0;q<F.length;)V.call(X,F[q],q,F),q++;else for(q in F)F.hasOwnProperty(q)&&V.call(X,F[q],q,F)}function a(F,V,X){var q="DEPRECATED METHOD: "+V+`
`+X+` AT 
`;return function(){var ue=new Error("get-stack-trace"),he=ue&&ue.stack?ue.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Pe=ye.console&&(ye.console.warn||ye.console.log);return Pe&&Pe.call(ye.console,q,he),F.apply(this,arguments)}}var i;typeof Object.assign!="function"?i=function(V){if(V===e||V===null)throw new TypeError("Cannot convert undefined or null to object");for(var X=Object(V),q=1;q<arguments.length;q++){var ue=arguments[q];if(ue!==e&&ue!==null)for(var he in ue)ue.hasOwnProperty(he)&&(X[he]=ue[he])}return X}:i=Object.assign;var h=a(function(V,X,q){for(var ue=Object.keys(X),he=0;he<ue.length;)(!q||q&&V[ue[he]]===e)&&(V[ue[he]]=X[ue[he]]),he++;return V},"extend","Use `assign`."),g=a(function(V,X){return h(V,X,!0)},"merge","Use `assign`.");function c(F,V,X){var q=V.prototype,ue;ue=F.prototype=Object.create(q),ue.constructor=F,ue._super=q,X&&i(ue,X)}function m(F,V){return function(){return F.apply(V,arguments)}}function E(F,V){return typeof F==f?F.apply(V&&V[0]||e,V):F}function T(F,V){return F===e?V:F}function P(F,V,X){l(I(V),function(q){F.addEventListener(q,X,!1)})}function M(F,V,X){l(I(V),function(q){F.removeEventListener(q,X,!1)})}function C(F,V){for(;F;){if(F==V)return!0;F=F.parentNode}return!1}function O(F,V){return F.indexOf(V)>-1}function I(F){return F.trim().split(/\s+/g)}function _(F,V,X){if(F.indexOf&&!X)return F.indexOf(V);for(var q=0;q<F.length;){if(X&&F[q][X]==V||!X&&F[q]===V)return q;q++}return-1}function D(F){return Array.prototype.slice.call(F,0)}function L(F,V,X){for(var q=[],ue=[],he=0;he<F.length;){var Pe=F[he][V];_(ue,Pe)<0&&q.push(F[he]),ue[he]=Pe,he++}return q=q.sort(function(Ae,Re){return Ae[V]>Re[V]}),q}function S(F,V){for(var X,q,ue=V[0].toUpperCase()+V.slice(1),he=0;he<r.length;){if(X=r[he],q=X?X+ue:V,q in F)return q;he++}return e}var A=1;function U(){return A++}function B(F){var V=F.ownerDocument||F;return V.defaultView||V.parentWindow||ye}var b=/mobile|tablet|ip(ad|hone|od)|android/i,y="ontouchstart"in ye,x=S(ye,"PointerEvent")!==e,j=y&&b.test(navigator.userAgent),p="touch",R="pen",W="mouse",K="kinect",N=25,z=1,Y=2,$=4,J=8,te=1,ne=2,de=4,w=8,G=16,Z=ne|de,Q=w|G,k=Z|Q,ae=["x","y"],ee=["clientX","clientY"];function oe(F,V){var X=this;this.manager=F,this.callback=V,this.element=F.element,this.target=F.options.inputTarget,this.domHandler=function(q){E(F.options.enable,[F])&&X.handler(q)},this.init()}oe.prototype={handler:function(){},init:function(){this.evEl&&P(this.element,this.evEl,this.domHandler),this.evTarget&&P(this.target,this.evTarget,this.domHandler),this.evWin&&P(B(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&M(this.element,this.evEl,this.domHandler),this.evTarget&&M(this.target,this.evTarget,this.domHandler),this.evWin&&M(B(this.element),this.evWin,this.domHandler)}};function se(F){var V,X=F.options.inputClass;return X?V=X:x?V=ze:j?V=ke:y?V=st:V=je,new V(F,re)}function re(F,V,X){var q=X.pointers.length,ue=X.changedPointers.length,he=V&z&&q-ue===0,Pe=V&($|J)&&q-ue===0;X.isFirst=!!he,X.isFinal=!!Pe,he&&(F.session={}),X.eventType=V,ce(F,X),F.emit("hammer.input",X),F.recognize(X),F.session.prevInput=X}function ce(F,V){var X=F.session,q=V.pointers,ue=q.length;X.firstInput||(X.firstInput=ge(V)),ue>1&&!X.firstMultiple?X.firstMultiple=ge(V):ue===1&&(X.firstMultiple=!1);var he=X.firstInput,Pe=X.firstMultiple,Le=Pe?Pe.center:he.center,Ae=V.center=ie(q);V.timeStamp=t(),V.deltaTime=V.timeStamp-he.timeStamp,V.angle=De(Le,Ae),V.distance=me(Le,Ae),le(X,V),V.offsetDirection=Me(V.deltaX,V.deltaY);var Re=ve(V.deltaTime,V.deltaX,V.deltaY);V.overallVelocityX=Re.x,V.overallVelocityY=Re.y,V.overallVelocity=d(Re.x)>d(Re.y)?Re.x:Re.y,V.scale=Pe?Ce(Pe.pointers,q):1,V.rotation=Pe?Te(Pe.pointers,q):0,V.maxPointers=X.prevInput?V.pointers.length>X.prevInput.maxPointers?V.pointers.length:X.prevInput.maxPointers:V.pointers.length,fe(X,V);var We=F.element;C(V.srcEvent.target,We)&&(We=V.srcEvent.target),V.target=We}function le(F,V){var X=V.center,q=F.offsetDelta||{},ue=F.prevDelta||{},he=F.prevInput||{};(V.eventType===z||he.eventType===$)&&(ue=F.prevDelta={x:he.deltaX||0,y:he.deltaY||0},q=F.offsetDelta={x:X.x,y:X.y}),V.deltaX=ue.x+(X.x-q.x),V.deltaY=ue.y+(X.y-q.y)}function fe(F,V){var X=F.lastInterval||V,q=V.timeStamp-X.timeStamp,ue,he,Pe,Le;if(V.eventType!=J&&(q>N||X.velocity===e)){var Ae=V.deltaX-X.deltaX,Re=V.deltaY-X.deltaY,We=ve(q,Ae,Re);he=We.x,Pe=We.y,ue=d(We.x)>d(We.y)?We.x:We.y,Le=Me(Ae,Re),F.lastInterval=V}else ue=X.velocity,he=X.velocityX,Pe=X.velocityY,Le=X.direction;V.velocity=ue,V.velocityX=he,V.velocityY=Pe,V.direction=Le}function ge(F){for(var V=[],X=0;X<F.pointers.length;)V[X]={clientX:v(F.pointers[X].clientX),clientY:v(F.pointers[X].clientY)},X++;return{timeStamp:t(),pointers:V,center:ie(V),deltaX:F.deltaX,deltaY:F.deltaY}}function ie(F){var V=F.length;if(V===1)return{x:v(F[0].clientX),y:v(F[0].clientY)};for(var X=0,q=0,ue=0;ue<V;)X+=F[ue].clientX,q+=F[ue].clientY,ue++;return{x:v(X/V),y:v(q/V)}}function ve(F,V,X){return{x:V/F||0,y:X/F||0}}function Me(F,V){return F===V?te:d(F)>=d(V)?F<0?ne:de:V<0?w:G}function me(F,V,X){X||(X=ae);var q=V[X[0]]-F[X[0]],ue=V[X[1]]-F[X[1]];return Math.sqrt(q*q+ue*ue)}function De(F,V,X){X||(X=ae);var q=V[X[0]]-F[X[0]],ue=V[X[1]]-F[X[1]];return Math.atan2(ue,q)*180/Math.PI}function Te(F,V){return De(V[1],V[0],ee)+De(F[1],F[0],ee)}function Ce(F,V){return me(V[0],V[1],ee)/me(F[0],F[1],ee)}var Ee={mousedown:z,mousemove:Y,mouseup:$},Oe="mousedown",_e="mousemove mouseup";function je(){this.evEl=Oe,this.evWin=_e,this.pressed=!1,oe.apply(this,arguments)}c(je,oe,{handler:function(V){var X=Ee[V.type];X&z&&V.button===0&&(this.pressed=!0),X&Y&&V.which!==1&&(X=$),this.pressed&&(X&$&&(this.pressed=!1),this.callback(this.manager,X,{pointers:[V],changedPointers:[V],pointerType:W,srcEvent:V}))}});var Ie={pointerdown:z,pointermove:Y,pointerup:$,pointercancel:J,pointerout:J},xe={2:p,3:R,4:W,5:K},Se="pointerdown",Ue="pointermove pointerup pointercancel";ye.MSPointerEvent&&!ye.PointerEvent&&(Se="MSPointerDown",Ue="MSPointerMove MSPointerUp MSPointerCancel");function ze(){this.evEl=Se,this.evWin=Ue,oe.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}c(ze,oe,{handler:function(V){var X=this.store,q=!1,ue=V.type.toLowerCase().replace("ms",""),he=Ie[ue],Pe=xe[V.pointerType]||V.pointerType,Le=Pe==p,Ae=_(X,V.pointerId,"pointerId");he&z&&(V.button===0||Le)?Ae<0&&(X.push(V),Ae=X.length-1):he&($|J)&&(q=!0),!(Ae<0)&&(X[Ae]=V,this.callback(this.manager,he,{pointers:X,changedPointers:[V],pointerType:Pe,srcEvent:V}),q&&X.splice(Ae,1))}});var rt={touchstart:z,touchmove:Y,touchend:$,touchcancel:J},lt="touchstart",it="touchstart touchmove touchend touchcancel";function Ot(){this.evTarget=lt,this.evWin=it,this.started=!1,oe.apply(this,arguments)}c(Ot,oe,{handler:function(V){var X=rt[V.type];if(X===z&&(this.started=!0),!!this.started){var q=Bt.call(this,V,X);X&($|J)&&q[0].length-q[1].length===0&&(this.started=!1),this.callback(this.manager,X,{pointers:q[0],changedPointers:q[1],pointerType:p,srcEvent:V})}}});function Bt(F,V){var X=D(F.touches),q=D(F.changedTouches);return V&($|J)&&(X=L(X.concat(q),"identifier")),[X,q]}var Ut={touchstart:z,touchmove:Y,touchend:$,touchcancel:J},bt="touchstart touchmove touchend touchcancel";function ke(){this.evTarget=bt,this.targetIds={},oe.apply(this,arguments)}c(ke,oe,{handler:function(V){var X=Ut[V.type],q=Wt.call(this,V,X);q&&this.callback(this.manager,X,{pointers:q[0],changedPointers:q[1],pointerType:p,srcEvent:V})}});function Wt(F,V){var X=D(F.touches),q=this.targetIds;if(V&(z|Y)&&X.length===1)return q[X[0].identifier]=!0,[X,X];var ue,he,Pe=D(F.changedTouches),Le=[],Ae=this.target;if(he=X.filter(function(Re){return C(Re.target,Ae)}),V===z)for(ue=0;ue<he.length;)q[he[ue].identifier]=!0,ue++;for(ue=0;ue<Pe.length;)q[Pe[ue].identifier]&&Le.push(Pe[ue]),V&($|J)&&delete q[Pe[ue].identifier],ue++;if(Le.length)return[L(he.concat(Le),"identifier"),Le]}var Kt=2500,Pt=25;function st(){oe.apply(this,arguments);var F=m(this.handler,this);this.touch=new ke(this.manager,F),this.mouse=new je(this.manager,F),this.primaryTouch=null,this.lastTouches=[]}c(st,oe,{handler:function(V,X,q){var ue=q.pointerType==p,he=q.pointerType==W;if(!(he&&q.sourceCapabilities&&q.sourceCapabilities.firesTouchEvents)){if(ue)Ht.call(this,X,q);else if(he&&Ft.call(this,q))return;this.callback(V,X,q)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function Ht(F,V){F&z?(this.primaryTouch=V.changedPointers[0].identifier,Tt.call(this,V)):F&($|J)&&Tt.call(this,V)}function Tt(F){var V=F.changedPointers[0];if(V.identifier===this.primaryTouch){var X={x:V.clientX,y:V.clientY};this.lastTouches.push(X);var q=this.lastTouches,ue=function(){var he=q.indexOf(X);he>-1&&q.splice(he,1)};setTimeout(ue,Kt)}}function Ft(F){for(var V=F.srcEvent.clientX,X=F.srcEvent.clientY,q=0;q<this.lastTouches.length;q++){var ue=this.lastTouches[q],he=Math.abs(V-ue.x),Pe=Math.abs(X-ue.y);if(he<=Pt&&Pe<=Pt)return!0}return!1}var Dt=S(u.style,"touchAction"),_t=Dt!==e,Ct="compute",jt="auto",ut="manipulation",Ye="none",Ze="pan-x",Je="pan-y",qe=zt();function dt(F,V){this.manager=F,this.set(V)}dt.prototype={set:function(F){F==Ct&&(F=this.compute()),_t&&this.manager.element.style&&qe[F]&&(this.manager.element.style[Dt]=F),this.actions=F.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var F=[];return l(this.manager.recognizers,function(V){E(V.options.enable,[V])&&(F=F.concat(V.getTouchAction()))}),Nt(F.join(" "))},preventDefaults:function(F){var V=F.srcEvent,X=F.offsetDirection;if(this.manager.session.prevented){V.preventDefault();return}var q=this.actions,ue=O(q,Ye)&&!qe[Ye],he=O(q,Je)&&!qe[Je],Pe=O(q,Ze)&&!qe[Ze];if(ue){var Le=F.pointers.length===1,Ae=F.distance<2,Re=F.deltaTime<250;if(Le&&Ae&&Re)return}if(!(Pe&&he)&&(ue||he&&X&Z||Pe&&X&Q))return this.preventSrc(V)},preventSrc:function(F){this.manager.session.prevented=!0,F.preventDefault()}};function Nt(F){if(O(F,Ye))return Ye;var V=O(F,Ze),X=O(F,Je);return V&&X?Ye:V||X?V?Ze:Je:O(F,ut)?ut:jt}function zt(){if(!_t)return!1;var F={},V=ye.CSS&&ye.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(X){F[X]=V?ye.CSS.supports("touch-action",X):!0}),F}var et=1,pe=2,Xe=4,Ve=8,Ke=Ve,Qe=16,be=32;function He(F){this.options=i({},this.defaults,F||{}),this.id=U(),this.manager=null,this.options.enable=T(this.options.enable,!0),this.state=et,this.simultaneous={},this.requireFail=[]}He.prototype={defaults:{},set:function(F){return i(this.options,F),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(F){if(s(F,"recognizeWith",this))return this;var V=this.simultaneous;return F=tt(F,this),V[F.id]||(V[F.id]=F,F.recognizeWith(this)),this},dropRecognizeWith:function(F){return s(F,"dropRecognizeWith",this)?this:(F=tt(F,this),delete this.simultaneous[F.id],this)},requireFailure:function(F){if(s(F,"requireFailure",this))return this;var V=this.requireFail;return F=tt(F,this),_(V,F)===-1&&(V.push(F),F.requireFailure(this)),this},dropRequireFailure:function(F){if(s(F,"dropRequireFailure",this))return this;F=tt(F,this);var V=_(this.requireFail,F);return V>-1&&this.requireFail.splice(V,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(F){return!!this.simultaneous[F.id]},emit:function(F){var V=this,X=this.state;function q(ue){V.manager.emit(ue,F)}X<Ve&&q(V.options.event+It(X)),q(V.options.event),F.additionalEvent&&q(F.additionalEvent),X>=Ve&&q(V.options.event+It(X))},tryEmit:function(F){if(this.canEmit())return this.emit(F);this.state=be},canEmit:function(){for(var F=0;F<this.requireFail.length;){if(!(this.requireFail[F].state&(be|et)))return!1;F++}return!0},recognize:function(F){var V=i({},F);if(!E(this.options.enable,[this,V])){this.reset(),this.state=be;return}this.state&(Ke|Qe|be)&&(this.state=et),this.state=this.process(V),this.state&(pe|Xe|Ve|Qe)&&this.tryEmit(V)},process:function(F){},getTouchAction:function(){},reset:function(){}};function It(F){return F&Qe?"cancel":F&Ve?"end":F&Xe?"move":F&pe?"start":""}function yt(F){return F==G?"down":F==w?"up":F==ne?"left":F==de?"right":""}function tt(F,V){var X=V.manager;return X?X.get(F):F}function Be(){He.apply(this,arguments)}c(Be,He,{defaults:{pointers:1},attrTest:function(F){var V=this.options.pointers;return V===0||F.pointers.length===V},process:function(F){var V=this.state,X=F.eventType,q=V&(pe|Xe),ue=this.attrTest(F);return q&&(X&J||!ue)?V|Qe:q||ue?X&$?V|Ve:V&pe?V|Xe:pe:be}});function nt(){Be.apply(this,arguments),this.pX=null,this.pY=null}c(nt,Be,{defaults:{event:"pan",threshold:10,pointers:1,direction:k},getTouchAction:function(){var F=this.options.direction,V=[];return F&Z&&V.push(Je),F&Q&&V.push(Ze),V},directionTest:function(F){var V=this.options,X=!0,q=F.distance,ue=F.direction,he=F.deltaX,Pe=F.deltaY;return ue&V.direction||(V.direction&Z?(ue=he===0?te:he<0?ne:de,X=he!=this.pX,q=Math.abs(F.deltaX)):(ue=Pe===0?te:Pe<0?w:G,X=Pe!=this.pY,q=Math.abs(F.deltaY))),F.direction=ue,X&&q>V.threshold&&ue&V.direction},attrTest:function(F){return Be.prototype.attrTest.call(this,F)&&(this.state&pe||!(this.state&pe)&&this.directionTest(F))},emit:function(F){this.pX=F.deltaX,this.pY=F.deltaY;var V=yt(F.direction);V&&(F.additionalEvent=this.options.event+V),this._super.emit.call(this,F)}});function ct(){Be.apply(this,arguments)}c(ct,Be,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ye]},attrTest:function(F){return this._super.attrTest.call(this,F)&&(Math.abs(F.scale-1)>this.options.threshold||this.state&pe)},emit:function(F){if(F.scale!==1){var V=F.scale<1?"in":"out";F.additionalEvent=this.options.event+V}this._super.emit.call(this,F)}});function ft(){He.apply(this,arguments),this._timer=null,this._input=null}c(ft,He,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[jt]},process:function(F){var V=this.options,X=F.pointers.length===V.pointers,q=F.distance<V.threshold,ue=F.deltaTime>V.time;if(this._input=F,!q||!X||F.eventType&($|J)&&!ue)this.reset();else if(F.eventType&z)this.reset(),this._timer=o(function(){this.state=Ke,this.tryEmit()},V.time,this);else if(F.eventType&$)return Ke;return be},reset:function(){clearTimeout(this._timer)},emit:function(F){this.state===Ke&&(F&&F.eventType&$?this.manager.emit(this.options.event+"up",F):(this._input.timeStamp=t(),this.manager.emit(this.options.event,this._input)))}});function vt(){Be.apply(this,arguments)}c(vt,Be,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ye]},attrTest:function(F){return this._super.attrTest.call(this,F)&&(Math.abs(F.rotation)>this.options.threshold||this.state&pe)}});function gt(){Be.apply(this,arguments)}c(gt,Be,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Z|Q,pointers:1},getTouchAction:function(){return nt.prototype.getTouchAction.call(this)},attrTest:function(F){var V=this.options.direction,X;return V&(Z|Q)?X=F.overallVelocity:V&Z?X=F.overallVelocityX:V&Q&&(X=F.overallVelocityY),this._super.attrTest.call(this,F)&&V&F.offsetDirection&&F.distance>this.options.threshold&&F.maxPointers==this.options.pointers&&d(X)>this.options.velocity&&F.eventType&$},emit:function(F){var V=yt(F.offsetDirection);V&&this.manager.emit(this.options.event+V,F),this.manager.emit(this.options.event,F)}});function at(){He.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}c(at,He,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[ut]},process:function(F){var V=this.options,X=F.pointers.length===V.pointers,q=F.distance<V.threshold,ue=F.deltaTime<V.time;if(this.reset(),F.eventType&z&&this.count===0)return this.failTimeout();if(q&&ue&&X){if(F.eventType!=$)return this.failTimeout();var he=this.pTime?F.timeStamp-this.pTime<V.interval:!0,Pe=!this.pCenter||me(this.pCenter,F.center)<V.posThreshold;this.pTime=F.timeStamp,this.pCenter=F.center,!Pe||!he?this.count=1:this.count+=1,this._input=F;var Le=this.count%V.taps;if(Le===0)return this.hasRequireFailures()?(this._timer=o(function(){this.state=Ke,this.tryEmit()},V.interval,this),pe):Ke}return be},failTimeout:function(){return this._timer=o(function(){this.state=be},this.options.interval,this),be},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Ke&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Ge(F,V){return V=V||{},V.recognizers=T(V.recognizers,Ge.defaults.preset),new ht(F,V)}Ge.VERSION="2.0.7",Ge.defaults={domEvents:!1,touchAction:Ct,enable:!0,inputTarget:null,inputClass:null,preset:[[vt,{enable:!1}],[ct,{enable:!1},["rotate"]],[gt,{direction:Z}],[nt,{direction:Z},["swipe"]],[at],[at,{event:"doubletap",taps:2},["tap"]],[ft]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Vt=1,Lt=2;function ht(F,V){this.options=i({},Ge.defaults,V||{}),this.options.inputTarget=this.options.inputTarget||F,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=F,this.input=se(this),this.touchAction=new dt(this,this.options.touchAction),xt(this,!0),l(this.options.recognizers,function(X){var q=this.add(new X[0](X[1]));X[2]&&q.recognizeWith(X[2]),X[3]&&q.requireFailure(X[3])},this)}ht.prototype={set:function(F){return i(this.options,F),F.touchAction&&this.touchAction.update(),F.inputTarget&&(this.input.destroy(),this.input.target=F.inputTarget,this.input.init()),this},stop:function(F){this.session.stopped=F?Lt:Vt},recognize:function(F){var V=this.session;if(!V.stopped){this.touchAction.preventDefaults(F);var X,q=this.recognizers,ue=V.curRecognizer;(!ue||ue&&ue.state&Ke)&&(ue=V.curRecognizer=null);for(var he=0;he<q.length;)X=q[he],V.stopped!==Lt&&(!ue||X==ue||X.canRecognizeWith(ue))?X.recognize(F):X.reset(),!ue&&X.state&(pe|Xe|Ve)&&(ue=V.curRecognizer=X),he++}},get:function(F){if(F instanceof He)return F;for(var V=this.recognizers,X=0;X<V.length;X++)if(V[X].options.event==F)return V[X];return null},add:function(F){if(s(F,"add",this))return this;var V=this.get(F.options.event);return V&&this.remove(V),this.recognizers.push(F),F.manager=this,this.touchAction.update(),F},remove:function(F){if(s(F,"remove",this))return this;if(F=this.get(F),F){var V=this.recognizers,X=_(V,F);X!==-1&&(V.splice(X,1),this.touchAction.update())}return this},on:function(F,V){if(F!==e&&V!==e){var X=this.handlers;return l(I(F),function(q){X[q]=X[q]||[],X[q].push(V)}),this}},off:function(F,V){if(F!==e){var X=this.handlers;return l(I(F),function(q){V?X[q]&&X[q].splice(_(X[q],V),1):delete X[q]}),this}},emit:function(F,V){this.options.domEvents&&Gt(F,V);var X=this.handlers[F]&&this.handlers[F].slice();if(!(!X||!X.length)){V.type=F,V.preventDefault=function(){V.srcEvent.preventDefault()};for(var q=0;q<X.length;)X[q](V),q++}},destroy:function(){this.element&&xt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function xt(F,V){var X=F.element;if(X.style){var q;l(F.options.cssProps,function(ue,he){q=S(X.style,he),V?(F.oldCssProps[q]=X.style[q],X.style[q]=ue):X.style[q]=F.oldCssProps[q]||""}),V||(F.oldCssProps={})}}function Gt(F,V){var X=H.createEvent("Event");X.initEvent(F,!0,!0),X.gesture=V,V.target.dispatchEvent(X)}i(Ge,{INPUT_START:z,INPUT_MOVE:Y,INPUT_END:$,INPUT_CANCEL:J,STATE_POSSIBLE:et,STATE_BEGAN:pe,STATE_CHANGED:Xe,STATE_ENDED:Ve,STATE_RECOGNIZED:Ke,STATE_CANCELLED:Qe,STATE_FAILED:be,DIRECTION_NONE:te,DIRECTION_LEFT:ne,DIRECTION_RIGHT:de,DIRECTION_UP:w,DIRECTION_DOWN:G,DIRECTION_HORIZONTAL:Z,DIRECTION_VERTICAL:Q,DIRECTION_ALL:k,Manager:ht,Input:oe,TouchAction:dt,TouchInput:ke,MouseInput:je,PointerEventInput:ze,TouchMouseInput:st,SingleTouchInput:Ot,Recognizer:He,AttrRecognizer:Be,Tap:at,Pan:nt,Swipe:gt,Pinch:ct,Rotate:vt,Press:ft,on:P,off:M,each:l,merge:g,extend:h,assign:i,inherit:c,bindFn:m,prefixed:S});var Yt=typeof ye<"u"?ye:typeof self<"u"?self:{};Yt.Hammer=Ge,Ne.exports?Ne.exports=Ge:ye[n]=Ge})(window,document,"Hammer")})(pt);var $t=pt.exports;const Zt=Et($t);var St={exports:{}};/*! cornerstone-math - 0.1.10 - 2022-06-09 | (c) 2017 Chris Hafey | https://github.com/cornerstonejs/cornerstoneMath */(function(Ne,ye){(function(H,n){Ne.exports=n()})(window,function(){return function(H){var n={};function e(r){if(n[r])return n[r].exports;var u=n[r]={i:r,l:!1,exports:{}};return H[r].call(u.exports,u,u.exports,e),u.l=!0,u.exports}return e.m=H,e.c=n,e.d=function(r,u,f){e.o(r,u)||Object.defineProperty(r,u,{enumerable:!0,get:f})},e.r=function(r){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},e.t=function(r,u){if(1&u&&(r=e(r)),8&u||4&u&&typeof r=="object"&&r&&r.__esModule)return r;var f=Object.create(null);if(e.r(f),Object.defineProperty(f,"default",{enumerable:!0,value:r}),2&u&&typeof r!="string")for(var v in r)e.d(f,v,(function(d){return r[d]}).bind(null,v));return f},e.n=function(r){var u=r&&r.__esModule?function(){return r.default}:function(){return r};return e.d(u,"a",u),u},e.o=function(r,u){return Object.prototype.hasOwnProperty.call(r,u)},e.p="",e(e.s=4)}([function(H,n,e){Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function d(t,o){for(var s=0;s<o.length;s++){var l=o[s];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}return function(t,o,s){return o&&d(t.prototype,o),s&&d(t,s),t}}(),u=function(d){return d&&d.__esModule?d:{default:d}}(e(2)),f=e(1),v=function(){function d(t,o,s){(function(l,a){if(!(l instanceof a))throw new TypeError("Cannot call a class as a function")})(this,d),this.x=t||0,this.y=o||0,this.z=s||0}return r(d,[{key:"set",value:function(t,o,s){return this.x=t,this.y=o,this.z=s,this}},{key:"setX",value:function(t){return this.x=t,this}},{key:"setY",value:function(t){return this.y=t,this}},{key:"setZ",value:function(t){return this.z=t,this}},{key:"setComponent",value:function(t,o){switch(t){case 0:this.x=o;break;case 1:this.y=o;break;case 2:this.z=o;break;default:throw new Error("index is out of range: "+t)}}},{key:"getComponent",value:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}},{key:"copy",value:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}},{key:"add",value:function(t,o){return o!==void 0?(console.warn("DEPRECATED: Vector3's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,o)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)}},{key:"addScalar",value:function(t){return this.x+=t,this.y+=t,this.z+=t,this}},{key:"addVectors",value:function(t,o){return this.x=t.x+o.x,this.y=t.y+o.y,this.z=t.z+o.z,this}},{key:"sub",value:function(t,o){return o!==void 0?(console.warn("DEPRECATED: Vector3's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,o)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)}},{key:"subVectors",value:function(t,o){return this.x=t.x-o.x,this.y=t.y-o.y,this.z=t.z-o.z,this}},{key:"multiply",value:function(t,o){return o!==void 0?(console.warn("DEPRECATED: Vector3's .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,o)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)}},{key:"multiplyScalar",value:function(t){return this.x*=t,this.y*=t,this.z*=t,this}},{key:"multiplyVectors",value:function(t,o){return this.x=t.x*o.x,this.y=t.y*o.y,this.z=t.z*o.z,this}},{key:"applyMatrix3",value:function(t){var o=this.x,s=this.y,l=this.z,a=t.elements;return this.x=a[0]*o+a[3]*s+a[6]*l,this.y=a[1]*o+a[4]*s+a[7]*l,this.z=a[2]*o+a[5]*s+a[8]*l,this}},{key:"applyMatrix4",value:function(t){var o=this.x,s=this.y,l=this.z,a=t.elements;return this.x=a[0]*o+a[4]*s+a[8]*l+a[12],this.y=a[1]*o+a[5]*s+a[9]*l+a[13],this.z=a[2]*o+a[6]*s+a[10]*l+a[14],this}},{key:"applyProjection",value:function(t){var o=this.x,s=this.y,l=this.z,a=t.elements,i=1/(a[3]*o+a[7]*s+a[11]*l+a[15]);return this.x=(a[0]*o+a[4]*s+a[8]*l+a[12])*i,this.y=(a[1]*o+a[5]*s+a[9]*l+a[13])*i,this.z=(a[2]*o+a[6]*s+a[10]*l+a[14])*i,this}},{key:"applyQuaternion",value:function(t){var o=this.x,s=this.y,l=this.z,a=t.x,i=t.y,h=t.z,g=t.w,c=g*o+i*l-h*s,m=g*s+h*o-a*l,E=g*l+a*s-i*o,T=-a*o-i*s-h*l;return this.x=c*g+T*-a+m*-h-E*-i,this.y=m*g+T*-i+E*-a-c*-h,this.z=E*g+T*-h+c*-i-m*-a,this}},{key:"transformDirection",value:function(t){var o=this.x,s=this.y,l=this.z,a=t.elements;return this.x=a[0]*o+a[4]*s+a[8]*l,this.y=a[1]*o+a[5]*s+a[9]*l,this.z=a[2]*o+a[6]*s+a[10]*l,this.normalize(),this}},{key:"divide",value:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}},{key:"divideScalar",value:function(t){if(t!==0){var o=1/t;this.x*=o,this.y*=o,this.z*=o}else this.x=0,this.y=0,this.z=0;return this}},{key:"min",value:function(t){return this.x>t.x&&(this.x=t.x),this.y>t.y&&(this.y=t.y),this.z>t.z&&(this.z=t.z),this}},{key:"max",value:function(t){return this.x<t.x&&(this.x=t.x),this.y<t.y&&(this.y=t.y),this.z<t.z&&(this.z=t.z),this}},{key:"clamp",value:function(t,o){return this.x<t.x?this.x=t.x:this.x>o.x&&(this.x=o.x),this.y<t.y?this.y=t.y:this.y>o.y&&(this.y=o.y),this.z<t.z?this.z=t.z:this.z>o.z&&(this.z=o.z),this}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}},{key:"negate",value:function(){return this.multiplyScalar(-1)}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y+this.z*t.z}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"lengthManhattan",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}},{key:"normalize",value:function(){return this.divideScalar(this.length())}},{key:"setLength",value:function(t){var o=this.length();return o!==0&&t!==o&&this.multiplyScalar(t/o),this}},{key:"lerp",value:function(t,o){return this.x+=(t.x-this.x)*o,this.y+=(t.y-this.y)*o,this.z+=(t.z-this.z)*o,this}},{key:"cross",value:function(t,o){if(o!==void 0)return console.warn("DEPRECATED: Vector3's .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,o);var s=this.x,l=this.y,a=this.z;return this.x=l*t.z-a*t.y,this.y=a*t.x-s*t.z,this.z=s*t.y-l*t.x,this}},{key:"crossVectors",value:function(t,o){var s=t.x,l=t.y,a=t.z,i=o.x,h=o.y,g=o.z;return this.x=l*g-a*h,this.y=a*i-s*g,this.z=s*h-l*i,this}},{key:"angleTo",value:function(t){var o=this.dot(t)/(this.length()*t.length());return Math.acos((0,f.clamp)(o,-1,1))}},{key:"distanceTo",value:function(t){return Math.sqrt(this.distanceToSquared(t))}},{key:"distanceToSquared",value:function(t){var o=this.x-t.x,s=this.y-t.y,l=this.z-t.z;return o*o+s*s+l*l}},{key:"setFromMatrixPosition",value:function(t){return this.x=t.elements[12],this.y=t.elements[13],this.z=t.elements[14],this}},{key:"setFromMatrixScale",value:function(t){var o=this.set(t.elements[0],t.elements[1],t.elements[2]).length(),s=this.set(t.elements[4],t.elements[5],t.elements[6]).length(),l=this.set(t.elements[8],t.elements[9],t.elements[10]).length();return this.x=o,this.y=s,this.z=l,this}},{key:"setFromMatrixColumn",value:function(t,o){var s=4*t,l=o.elements;return this.x=l[s],this.y=l[s+1],this.z=l[s+2],this}},{key:"equals",value:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}},{key:"fromArray",value:function(t){return this.x=t[0],this.y=t[1],this.z=t[2],this}},{key:"toArray",value:function(){return[this.x,this.y,this.z]}},{key:"clone",value:function(){return new d(this.x,this.y,this.z)}}]),d}();v.prototype.projectOnVector=function(){var d=void 0,t=void 0;return function(o){return d===void 0&&(d=new v),d.copy(o).normalize(),t=this.dot(d),this.copy(d).multiplyScalar(t)}}(),v.prototype.projectOnPlane=function(){var d=void 0;return function(t){return d===void 0&&(d=new v),d.copy(this).projectOnVector(t),this.sub(d)}}(),v.prototype.reflect=function(){var d=void 0;return function(t){return d===void 0&&(d=new v),this.sub(d.copy(t).multiplyScalar(2*this.dot(t)))}}(),v.prototype.clampScalar=function(){var d=void 0,t=void 0;return function(o,s){return d===void 0&&(d=new v,t=new v),d.set(o,o,o),t.set(s,s,s),this.clamp(d,t)}}(),v.prototype.applyAxisAngle=function(){var d=void 0;return function(t,o){return d===void 0&&(d=new u.default),this.applyQuaternion(d.setFromAxisAngle(t.normalize(),o)),this}}(),n.default=v},function(H,n,e){Object.defineProperty(n,"__esModule",{value:!0});var r=1e-4;n.clamp=function(u,f,v){return u<f?f:u>v?v:u},n.degToRad=function(u){return u*(Math.PI/180)},n.approximatelyEquals=function(u,f,v){var d=v||r;return Math.abs(u-f)<=d*Math.max(1,Math.abs(u),Math.abs(f))},n.radToDeg=function(u){return u*(180/Math.PI)},n.sign=function(u){return typeof u=="number"?u?u<0?-1:1:u==u?0:NaN:NaN}},function(H,n,e){Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function f(v,d){for(var t=0;t<d.length;t++){var o=d[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(v,o.key,o)}}return function(v,d,t){return d&&f(v.prototype,d),t&&f(v,t),v}}(),u=function(){function f(v,d,t,o){(function(s,l){if(!(s instanceof l))throw new TypeError("Cannot call a class as a function")})(this,f),this.x=v||0,this.y=d||0,this.z=t||0,this.w=o!==void 0?o:1}return r(f,[{key:"setFromAxisAngle",value:function(v,d){var t=d/2,o=Math.sin(t);return this.x=v.x*o,this.y=v.y*o,this.z=v.z*o,this.w=Math.cos(t),this}},{key:"multiplyQuaternions",value:function(v,d){var t=v.x,o=v.y,s=v.z,l=v.w,a=d.x,i=d.y,h=d.z,g=d.w;return this.x=t*g+l*a+o*h-s*i,this.y=o*g+l*i+s*a-t*h,this.z=s*g+l*h+t*i-o*a,this.w=l*g-t*a-o*i-s*h,this}},{key:"setFromRotationMatrix",value:function(v){var d=v.elements,t=d[0],o=d[4],s=d[8],l=d[1],a=d[5],i=d[9],h=d[2],g=d[6],c=d[10],m=t+a+c,E=void 0;return m>0?(E=.5/Math.sqrt(m+1),this.w=.25/E,this.x=(g-i)*E,this.y=(s-h)*E,this.z=(l-o)*E):t>a&&t>c?(E=2*Math.sqrt(1+t-a-c),this.w=(g-i)/E,this.x=.25*E,this.y=(o+l)/E,this.z=(s+h)/E):a>c?(E=2*Math.sqrt(1+a-t-c),this.w=(s-h)/E,this.x=(o+l)/E,this.y=.25*E,this.z=(i+g)/E):(E=2*Math.sqrt(1+c-t-a),this.w=(l-o)/E,this.x=(s+h)/E,this.y=(i+g)/E,this.z=.25*E),this}}]),f}();n.default=u},function(H,n,e){Object.defineProperty(n,"__esModule",{value:!0});var r=e(1);function u(d){return d*d}function f(d,t){return u(d.x-t.x)+u(d.y-t.y)}var v={distanceToPoint:function(d,t){return Math.sqrt(function(o,s){var l=f(o.start,o.end);if(l===0)return f(s,o.start);var a=((s.x-o.start.x)*(o.end.x-o.start.x)+(s.y-o.start.y)*(o.end.y-o.start.y))/l;return f(s,a<0?o.start:a>1?o.end:{x:o.start.x+a*(o.end.x-o.start.x),y:o.start.y+a*(o.end.y-o.start.y)})}(d,t))},intersectLine:function(d,t){var o,s,l,a,i,h,g,c,m,E,T,P={},M=d.start.x,C=d.start.y,O=d.end.x,I=d.end.y,_=t.start.x,D=t.start.y,L=t.end.x,S=t.end.y,A=void 0;if(E=(o=I-C)*L+(l=M-O)*S+(i=O*C-M*I),((m=o*_+l*D+i)===0||E===0||(0,r.sign)(m)!==(0,r.sign)(E))&&(c=(s=S-D)*O+(a=_-L)*I+(h=L*D-_*S),(g=s*M+a*C+h)===0||c===0||(0,r.sign)(g)!==(0,r.sign)(c))){T=o*a-s*l,A=l*h-a*i;var U=parseFloat(A/T);A=s*i-o*h;var B=parseFloat(A/T);return P.x=U,P.y=B,P}}};n.default=v},function(H,n,e){Object.defineProperty(n,"__esModule",{value:!0}),n.Vector3=n.rect=n.quaternion=n.point=n.Plane=n.Matrix4=n.sign=n.radToDeg=n.degToRad=n.clamp=n.lineSegment=n.Line3=void 0;var r=a(e(5)),u=a(e(3)),f=e(1),v=a(e(6)),d=a(e(7)),t=a(e(8)),o=a(e(2)),s=a(e(9)),l=a(e(0));function a(h){return h&&h.__esModule?h:{default:h}}var i={Line3:r.default,lineSegment:u.default,clamp:f.clamp,degToRad:f.degToRad,radToDeg:f.radToDeg,sign:f.sign,Matrix4:v.default,Plane:d.default,point:t.default,quaternion:o.default,rect:s.default,Vector3:l.default};n.Line3=r.default,n.lineSegment=u.default,n.clamp=f.clamp,n.degToRad=f.degToRad,n.radToDeg=f.radToDeg,n.sign=f.sign,n.Matrix4=v.default,n.Plane=d.default,n.point=t.default,n.quaternion=o.default,n.rect=s.default,n.Vector3=l.default,n.default=i},function(H,n,e){Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function d(t,o){for(var s=0;s<o.length;s++){var l=o[s];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}return function(t,o,s){return o&&d(t.prototype,o),s&&d(t,s),t}}(),u=function(d){return d&&d.__esModule?d:{default:d}}(e(0)),f=e(1),v=function(){function d(t,o){(function(s,l){if(!(s instanceof l))throw new TypeError("Cannot call a class as a function")})(this,d),this.start=t!==void 0?t:new u.default,this.end=o!==void 0?o:new u.default}return r(d,[{key:"set",value:function(t,o){return this.start.copy(t),this.end.copy(o),this}},{key:"copy",value:function(t){return this.start.copy(t.start),this.end.copy(t.end),this}},{key:"center",value:function(t){return(t||new u.default).addVectors(this.start,this.end).multiplyScalar(.5)}},{key:"delta",value:function(t){return(t||new u.default).subVectors(this.end,this.start)}},{key:"distanceSq",value:function(){return this.start.distanceToSquared(this.end)}},{key:"distance",value:function(){return this.start.distanceTo(this.end)}},{key:"at",value:function(t,o){var s=o||new u.default;return this.delta(s).multiplyScalar(t).add(this.start)}},{key:"closestPointToPointParameter",value:function(t,o){var s=new u.default,l=new u.default;s.subVectors(t,this.start),l.subVectors(this.end,this.start);var a=l.dot(l),i=l.dot(s)/a;return o&&(i=(0,f.clamp)(i,0,1)),i}},{key:"closestPointToPoint",value:function(t,o,s){var l=this.closestPointToPointParameter(t,o),a=s||new u.default;return this.delta(a).multiplyScalar(l).add(this.start)}},{key:"applyMatrix4",value:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this}},{key:"equals",value:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}},{key:"clone",value:function(){return new d().copy(this)}},{key:"intersectLine",value:function(t){var o=this.end.clone().sub(this.start),s=t.end.clone().sub(t.start),l=t.start.clone().sub(this.start),a=o.clone().cross(s),i=l.clone().cross(s),h=l.dot(a)/(l.lengthSq()*a.lengthSq());if((0,f.approximatelyEquals)(h,0)){var g=i.dot(a)/a.lengthSq();if(!(g>1||isNaN(g))){var c=this.start.clone().add(o.clone().multiplyScalar(g));return c.clone().sub(t.start).lengthSq()+c.clone().sub(t.end).lengthSq()<=t.distanceSq()?c:void 0}}}}]),d}();n.default=v},function(H,n,e){Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function v(d,t){for(var o=0;o<t.length;o++){var s=t[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(d,s.key,s)}}return function(d,t,o){return t&&v(d.prototype,t),o&&v(d,o),d}}(),u=function(v){return v&&v.__esModule?v:{default:v}}(e(0)),f=function(){function v(d,t,o,s,l,a,i,h,g,c,m,E,T,P,M,C){(function(I,_){if(!(I instanceof _))throw new TypeError("Cannot call a class as a function")})(this,v),this.elements=new Float32Array(16);var O=this.elements;O[0]=d!==void 0?d:1,O[4]=t||0,O[8]=o||0,O[12]=s||0,O[1]=l||0,O[5]=a!==void 0?a:1,O[9]=i||0,O[13]=h||0,O[2]=g||0,O[6]=c||0,O[10]=m!==void 0?m:1,O[14]=E||0,O[3]=T||0,O[7]=P||0,O[11]=M||0,O[15]=C!==void 0?C:1}return r(v,[{key:"makeRotationFromQuaternion",value:function(d){var t=this.elements,o=d.x,s=d.y,l=d.z,a=d.w,i=o+o,h=s+s,g=l+l,c=o*i,m=o*h,E=o*g,T=s*h,P=s*g,M=l*g,C=a*i,O=a*h,I=a*g;return t[0]=1-(T+M),t[4]=m-I,t[8]=E+O,t[1]=m+I,t[5]=1-(c+M),t[9]=P-C,t[2]=E-O,t[6]=P+C,t[10]=1-(c+T),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}},{key:"multiplyMatrices",value:function(d,t){var o=d.elements,s=t.elements,l=this.elements,a=o[0],i=o[4],h=o[8],g=o[12],c=o[1],m=o[5],E=o[9],T=o[13],P=o[2],M=o[6],C=o[10],O=o[14],I=o[3],_=o[7],D=o[11],L=o[15],S=s[0],A=s[4],U=s[8],B=s[12],b=s[1],y=s[5],x=s[9],j=s[13],p=s[2],R=s[6],W=s[10],K=s[14],N=s[3],z=s[7],Y=s[11],$=s[15];return l[0]=a*S+i*b+h*p+g*N,l[4]=a*A+i*y+h*R+g*z,l[8]=a*U+i*x+h*W+g*Y,l[12]=a*B+i*j+h*K+g*$,l[1]=c*S+m*b+E*p+T*N,l[5]=c*A+m*y+E*R+T*z,l[9]=c*U+m*x+E*W+T*Y,l[13]=c*B+m*j+E*K+T*$,l[2]=P*S+M*b+C*p+O*N,l[6]=P*A+M*y+C*R+O*z,l[10]=P*U+M*x+C*W+O*Y,l[14]=P*B+M*j+C*K+O*$,l[3]=I*S+_*b+D*p+L*N,l[7]=I*A+_*y+D*R+L*z,l[11]=I*U+_*x+D*W+L*Y,l[15]=I*B+_*j+D*K+L*$,this}},{key:"multiply",value:function(d,t){return t!==void 0?(console.warn("DEPRECATED: Matrix4's .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(d,t)):this.multiplyMatrices(this,d)}},{key:"getInverse",value:function(d,t){var o=this.elements,s=d.elements,l=s[0],a=s[4],i=s[8],h=s[12],g=s[1],c=s[5],m=s[9],E=s[13],T=s[2],P=s[6],M=s[10],C=s[14],O=s[3],I=s[7],_=s[11],D=s[15];o[0]=m*C*I-E*M*I+E*P*_-c*C*_-m*P*D+c*M*D,o[4]=h*M*I-i*C*I-h*P*_+a*C*_+i*P*D-a*M*D,o[8]=i*E*I-h*m*I+h*c*_-a*E*_-i*c*D+a*m*D,o[12]=h*m*P-i*E*P-h*c*M+a*E*M+i*c*C-a*m*C,o[1]=E*M*O-m*C*O-E*T*_+g*C*_+m*T*D-g*M*D,o[5]=i*C*O-h*M*O+h*T*_-l*C*_-i*T*D+l*M*D,o[9]=h*m*O-i*E*O-h*g*_+l*E*_+i*g*D-l*m*D,o[13]=i*E*T-h*m*T+h*g*M-l*E*M-i*g*C+l*m*C,o[2]=c*C*O-E*P*O+E*T*I-g*C*I-c*T*D+g*P*D,o[6]=h*P*O-a*C*O-h*T*I+l*C*I+a*T*D-l*P*D,o[10]=a*E*O-h*c*O+h*g*I-l*E*I-a*g*D+l*c*D,o[14]=h*c*T-a*E*T-h*g*P+l*E*P+a*g*C-l*c*C,o[3]=m*P*O-c*M*O-m*T*I+g*M*I+c*T*_-g*P*_,o[7]=a*M*O-i*P*O+i*T*I-l*M*I-a*T*_+l*P*_,o[11]=i*c*O-a*m*O-i*g*I+l*m*I+a*g*_-l*c*_,o[15]=a*m*T-i*c*T+i*g*P-l*m*P-a*g*M+l*c*M;var L=l*o[0]+g*o[4]+T*o[8]+O*o[12];if(L===0){var S="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(t)throw new Error(S);return console.warn(S),this.identity(),this}return this.multiplyScalar(1/L),this}},{key:"applyToVector3Array",value:function(){var d=new u.default;return function(t,o,s){o===void 0&&(o=0),s===void 0&&(s=t.length);for(var l=0,a=o;l<s;l+=3,a+=3)d.x=t[a],d.y=t[a+1],d.z=t[a+2],d.applyMatrix4(this),t[a]=d.x,t[a+1]=d.y,t[a+2]=d.z;return t}}},{key:"makeTranslation",value:function(d,t,o){return this.set(1,0,0,d,0,1,0,t,0,0,1,o,0,0,0,1),this}},{key:"multiplyScalar",value:function(d){var t=this.elements;return t[0]*=d,t[4]*=d,t[8]*=d,t[12]*=d,t[1]*=d,t[5]*=d,t[9]*=d,t[13]*=d,t[2]*=d,t[6]*=d,t[10]*=d,t[14]*=d,t[3]*=d,t[7]*=d,t[11]*=d,t[15]*=d,this}},{key:"set",value:function(d,t,o,s,l,a,i,h,g,c,m,E,T,P,M,C){var O=this.elements;return O[0]=d,O[4]=t,O[8]=o,O[12]=s,O[1]=l,O[5]=a,O[9]=i,O[13]=h,O[2]=g,O[6]=c,O[10]=m,O[14]=E,O[3]=T,O[7]=P,O[11]=M,O[15]=C,this}},{key:"makeScale",value:function(d,t,o){return this.set(d,0,0,0,0,t,0,0,0,0,o,0,0,0,0,1),this}}]),v}();n.default=f},function(H,n,e){Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function v(d,t){for(var o=0;o<t.length;o++){var s=t[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(d,s.key,s)}}return function(d,t,o){return t&&v(d.prototype,t),o&&v(d,o),d}}(),u=function(v){return v&&v.__esModule?v:{default:v}}(e(0)),f=function(){function v(d,t){(function(o,s){if(!(o instanceof s))throw new TypeError("Cannot call a class as a function")})(this,v),this.normal=d!==void 0?d:new u.default(1,0,0),this.constant=t!==void 0?t:0}return r(v,[{key:"set",value:function(d,t){return this.normal.copy(d),this.constant=t,this}},{key:"setComponents",value:function(d,t,o,s){return this.normal.set(d,t,o),this.constant=s,this}},{key:"setFromNormalAndCoplanarPoint",value:function(d,t){return this.normal.copy(d),this.constant=-t.dot(this.normal),this}},{key:"copy",value:function(d){return this.normal.copy(d.normal),this.constant=d.constant,this}},{key:"normalize",value:function(){var d=1/this.normal.length();return this.normal.multiplyScalar(d),this.constant*=d,this}},{key:"negate",value:function(){return this.constant*=-1,this.normal.negate(),this}},{key:"distanceToPoint",value:function(d){return this.normal.dot(d)+this.constant}},{key:"distanceToSphere",value:function(d){return this.distanceToPoint(d.center)-d.radius}},{key:"projectPoint",value:function(d,t){return this.orthoPoint(d,t).sub(d).negate()}},{key:"orthoPoint",value:function(d,t){var o=this.distanceToPoint(d);return(t||new u.default).copy(this.normal).multiplyScalar(o)}},{key:"isIntersectionLine",value:function(d){var t=this.distanceToPoint(d.start),o=this.distanceToPoint(d.end);return t<0&&o>0||o<0&&t>0}},{key:"intersectPlane",value:function(d){var t=this.normal.clone().cross(d.normal),o={origin:new u.default,direction:t};if(this.normal.clone().cross(d.normal).length<1e-10)return o.direction=new u.default,o;var s=this.constant,l=d.constant,a=this.normal.clone().dot(d.normal),i=-(s-l*a)/(1-a*a),h=-(l-s*a)/(1-a*a);return o.origin=this.normal.clone().multiplyScalar(i).add(d.normal.clone().multiplyScalar(h)),o}},{key:"coplanarPoint",value:function(d){return(d||new u.default).copy(this.normal).multiplyScalar(-this.constant)}},{key:"translate",value:function(d){return this.constant=this.constant-d.dot(this.normal),this}},{key:"equals",value:function(d){return d.normal.equals(this.normal)&&d.constant===this.constant}},{key:"clone",value:function(){return new v().copy(this)}}]),v}();f.prototype.setFromCoplanarPoints=function(){var v=new u.default,d=new u.default;return function(t,o,s){var l=v.subVectors(s,o).cross(d.subVectors(t,o)).normalize();return this.setFromNormalAndCoplanarPoint(l,t),this}}(),f.prototype.intersectLine=function(){var v=new u.default;return function(d,t){var o=t||new u.default,s=d.delta(v),l=this.normal.dot(s);if(l===0)return this.distanceToPoint(d.start)===0?o.copy(d.start):void 0;var a=-(d.start.dot(this.normal)+this.constant)/l;return a<0||a>1?void 0:o.copy(s).multiplyScalar(a).add(d.start)}}(),n.default=f},function(H,n,e){function r(d,t){return{x:d.x-t.x,y:d.y-t.y}}function u(d,t){return Math.sqrt(f(d,t))}function f(d,t){var o=r(d,t);return o.x*o.x+o.y*o.y}Object.defineProperty(n,"__esModule",{value:!0});var v={subtract:r,copy:function(d){return{x:d.x,y:d.y}},pageToPoint:function(d){return{x:d.pageX,y:d.pageY}},distance:u,distanceSquared:f,insideRect:function(d,t){return!(d.x<t.left||d.x>t.left+t.width||d.y<t.top||d.y>t.top+t.height)},findClosestPoint:function(d,t){var o=[],s=void 0;return d.forEach(function(l,a){var i=u(l,t);o.push(i),s=a===0?i:Math.min(i,s)}),d[o.indexOf(s)]}};n.default=v},function(H,n,e){Object.defineProperty(n,"__esModule",{value:!0});var r=function(v){return v&&v.__esModule?v:{default:v}}(e(3));function u(v){return{topLeft:{x:v.left,y:v.top},bottomRight:{x:v.left+v.width,y:v.top+v.height}}}var f={distanceToPoint:function(v,d){var t=655535;return function(o){return[{start:{x:o.left,y:o.top},end:{x:o.left+o.width,y:o.top}},{start:{x:o.left+o.width,y:o.top},end:{x:o.left+o.width,y:o.top+o.height}},{start:{x:o.left+o.width,y:o.top+o.height},end:{x:o.left,y:o.top+o.height}},{start:{x:o.left,y:o.top+o.height},end:{x:o.left,y:o.top}}]}(v).forEach(function(o){var s=r.default.distanceToPoint(o,d);s<t&&(t=s)}),t},getIntersectionRect:function(v,d){var t={topLeft:{},bottomRight:{}};if(function(l,a){var i=void 0,h=void 0,g=u(l),c=u(a);return i=l.width>=0?a.width>=0?!(g.bottomRight.x<=c.topLeft.x||c.bottomRight.x<=g.topLeft.x):!(g.bottomRight.x<=c.bottomRight.x||c.topLeft.x<=g.topLeft.x):a.width>=0?!(g.topLeft.x<=c.topLeft.x||c.bottomRight.x<=g.bottomRight.x):!(g.topLeft.x<=c.bottomRight.x||c.topLeft.x<=g.bottomRight.x),h=l.height>=0?a.height>=0?!(g.bottomRight.y<=c.topLeft.y||c.bottomRight.y<=g.topLeft.y):!(g.bottomRight.y<=c.bottomRight.y||c.topLeft.y<=g.topLeft.y):a.height>=0?!(g.topLeft.y<=c.topLeft.y||c.bottomRight.y<=g.bottomRight.y):!(g.topLeft.y<=c.bottomRight.y||c.top<=g.bottomRight.y),i&&h}(v,d)){var o=u(v),s=u(d);return v.width>=0?d.width>=0?(t.topLeft.x=Math.max(o.topLeft.x,s.topLeft.x),t.bottomRight.x=Math.min(o.bottomRight.x,s.bottomRight.x)):(t.topLeft.x=Math.max(o.topLeft.x,s.bottomRight.x),t.bottomRight.x=Math.min(o.bottomRight.x,s.topLeft.x)):d.width>=0?(t.topLeft.x=Math.min(o.topLeft.x,s.bottomRight.x),t.bottomRight.x=Math.max(o.bottomRight.x,s.topLeft.x)):(t.topLeft.x=Math.min(o.topLeft.x,s.topLeft.x),t.bottomRight.x=Math.max(o.bottomRight.x,s.bottomRight.x)),v.height>=0?d.height>=0?(t.topLeft.y=Math.max(o.topLeft.y,s.topLeft.y),t.bottomRight.y=Math.min(o.bottomRight.y,s.bottomRight.y)):(t.topLeft.y=Math.max(o.topLeft.y,s.bottomRight.y),t.bottomRight.y=Math.min(o.bottomRight.y,s.topLeft.y)):d.height>=0?(t.topLeft.y=Math.min(o.topLeft.y,s.bottomRight.y),t.bottomRight.y=Math.max(o.bottomRight.y,s.topLeft.y)):(t.topLeft.y=Math.min(o.topLeft.y,s.topLeft.y),t.bottomRight.y=Math.max(o.bottomRight.y,s.bottomRight.y)),t}}};n.default=f}])})})(St);var Jt=St.exports;const Qt=Et(Jt),wt="_dicom_wrapper_1b3lr_1",kt="_dicomImage_1b3lr_1",qt="_controls_1b3lr_19",mt={dicom_wrapper:wt,dicomImage:kt,controls:qt};Mt.external.cornerstone=we;Mt.external.dicomParser=At;const nn=()=>{const Ne=Fe.useRef(null),ye=Fe.useRef(null),[H,n]=Fe.useState([]),[e,r]=Fe.useState(0),[u,f]=Fe.useState(!1),v=Fe.useRef(null);Fe.useEffect(()=>{ot.external.cornerstone=we,ot.external.Hammer=Zt,ot.external.cornerstoneMath=Qt,ot.init({})},[]),Fe.useEffect(()=>{if(u)return v.current=window.setInterval(()=>{r(s=>s<H.length?s+1:(v.current&&(clearInterval(v.current),f(!1)),s))},50),()=>{v.current&&(clearInterval(v.current),f(!1),r(0))}},[u]);const d=async s=>{const l=s.target.files;if(l&&l.length>0){const a=l[0],i=await a.arrayBuffer(),g=At.parseDicom(new Uint8Array(i)).intString("x00280008")||1,c=Mt.wadouri.fileManager.add(a),m=[];for(let E=0;E<g;E++)m.push(`${c}?frame=${E}`);n(m)}},t=s=>{const l=Number(s.target.value);r(l)},o=()=>{r(0),f(!0)};return Fe.useEffect(()=>{if(H.length>0&&ye.current){const s=ye.current;s&&(we.enable(s),H[e]&&we.loadImage(H[e]).then(a=>{we.displayImage(s,a)}))}},[e]),$e.jsxs("section",{className:mt.dicom_wrapper,children:[$e.jsx("input",{type:"file",ref:Ne,onChange:d}),$e.jsx("div",{ref:ye,id:mt.dicomImage}),$e.jsxs("div",{className:mt.controls,children:[$e.jsx("button",{disabled:!H.length||u,onClick:o,type:"button",children:"Play"}),$e.jsx("input",{type:"range",value:e,name:"scroll",min:0,onChange:t,disabled:!H.length||u,max:H.length,step:1,id:"scroll"})]})]})};export{nn as default};
